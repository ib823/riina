; Copyright (c) 2026 The RIINA Authors. All rights reserved.
; Copyright (c) 2026 The RIINA Authors.
; Auto-generated from 02_FORMAL/coq/domains/HypervisorSecurity.v (89 assertions)
; Generated by scripts/generate-full-stack.py
; Module: HypervisorSecurity

(set-logic ALL)
(set-option :produce-models true)

; PrivilegeLevel (matches Coq: Inductive PrivilegeLevel)
(declare-datatypes ((PrivilegeLevel 0)) (((PL_Hypervisor) (PL_Kernel) (PL_Driver) (PL_Service) (PL_User) (SecureWorld) (NormalWorld))))

; VMIsolation (matches Coq: Record VMIsolation)
(declare-datatypes ((VMIsolation 0))
  (((mk-vm_isolation (vmi_memory_isolated Bool) (vmi_cpu_isolated Bool) (vmi_io_isolated Bool) (vmi_interrupt_isolated Bool)))))

; EPTEntry (matches Coq: Record EPTEntry)
(declare-datatypes ((EPTEntry 0))
  (((mk-ept_entry (ept_present Bool) (ept_read Bool) (ept_write Bool) (ept_execute Bool) (ept_user_mode Bool) (ept_host_addr PAddr) (ept_access_dirty Bool)))))

; VMCSState (matches Coq: Record VMCSState)
(declare-datatypes ((VMCSState 0))
  (((mk-vmcs_state (vmcs_guest_rip Int) (vmcs_guest_rsp Int) (vmcs_guest_cr0 Int) (vmcs_guest_cr3 Int) (vmcs_guest_cr4 Int) (vmcs_host_cr3 Int) (vmcs_exit_reason Int) (vmcs_exception_bitmap Int) (vmcs_io_bitmap_enabled Bool) (vmcs_msr_bitmap_enabled Bool) (vmcs_vpid Int) (vmcs_eptp Int)))))

; InterruptDescriptor (matches Coq: Record InterruptDescriptor)
(declare-datatypes ((InterruptDescriptor 0))
  (((mk-interrupt_descriptor (int_vector Int) (int_handler_addr Int) (int_privilege_level PrivilegeLevel) (int_is_trap Bool) (int_ist_index Int)))))

; VMState (matches Coq: Record VMState)
(declare-datatypes ((VMState 0))
  (((mk-vm_state (vm_id VMID) (vm_isolation VMIsolation) (vm_vmcs VMCSState) (vm_world SecurityWorld) (vm_ept GPA) (vm_active Bool) (vm_paused Bool) (vm_interrupt_shadow Bool)))))

; SideChannelMitigation (matches Coq: Record SideChannelMitigation)
(declare-datatypes ((SideChannelMitigation 0))
  (((mk-side_channel_mitigation (scm_flush_l1d Bool) (scm_ibrs_enabled Bool) (scm_ibpb_enabled Bool) (scm_stibp_enabled Bool) (scm_ssbd_enabled Bool) (scm_mds_clear Bool) (scm_taa_mitigation Bool) (scm_srbds_mitigation Bool)))))

; MemVirtConfig (matches Coq: Record MemVirtConfig)
(declare-datatypes ((MemVirtConfig 0))
  (((mk-mem_virt_config (mv_ept_enabled Bool) (mv_vpid_enabled Bool) (mv_shadow_paging Bool) (mv_memory_type_range Bool) (mv_page_modification_log Bool) (mv_accessed_dirty Bool)))))

; InterruptVirtConfig (matches Coq: Record InterruptVirtConfig)
(declare-datatypes ((InterruptVirtConfig 0))
  (((mk-interrupt_virt_config (iv_apic_virtualization Bool) (iv_posted_interrupts Bool) (iv_interrupt_exit Bool) (iv_nmi_exiting Bool) (iv_virtual_nmi Bool) (iv_ple_enabled Bool)))))

; WorldSwitchConfig (matches Coq: Record WorldSwitchConfig)
(declare-datatypes ((WorldSwitchConfig 0))
  (((mk-world_switch_config (ws_smc_filtering Bool) (ws_ns_bit_control Bool) (ws_secure_monitor Bool) (ws_tzasc_enabled Bool) (ws_tzpc_enabled Bool)))))

; HypervisorConfig (matches Coq: Record HypervisorConfig)
(declare-datatypes ((HypervisorConfig 0))
  (((mk-hypervisor_config (hv_isolation VMIsolation) (hv_secure_boot Bool) (hv_attestation Bool) (hv_memory_encryption Bool) (hv_nested_paging Bool) (hv_iommu_enabled Bool) (hv_side_channel SideChannelMitigation) (hv_mem_virt MemVirtConfig) (hv_int_virt InterruptVirtConfig) (hv_world_switch WorldSwitchConfig)))))

; vm_fully_isolated (matches Coq: Definition vm_fully_isolated)
(define-fun vm_fully_isolated ((v VMIsolation)) Bool
  (and (vmi_memory_isolated v) (vmi_cpu_isolated v) (vmi_io_isolated v) (vmi_interrupt_isolated v)))

; side_channel_mitigated (matches Coq: Definition side_channel_mitigated)
(define-fun side_channel_mitigated ((s SideChannelMitigation)) Bool
  (and (scm_flush_l1d s) (scm_ibrs_enabled s) (scm_ibpb_enabled s) (scm_stibp_enabled s) (scm_ssbd_enabled s) (scm_mds_clear s)))

; mem_virt_secure (matches Coq: Definition mem_virt_secure)
(define-fun mem_virt_secure ((m MemVirtConfig)) Bool
  (and (mv_ept_enabled m) (mv_vpid_enabled m) (mv_accessed_dirty m)))

; int_virt_secure (matches Coq: Definition int_virt_secure)
(define-fun int_virt_secure ((i InterruptVirtConfig)) Bool
  (and (iv_apic_virtualization i) (iv_interrupt_exit i) (iv_nmi_exiting i)))

; world_switch_secure (matches Coq: Definition world_switch_secure)
(define-fun world_switch_secure ((w WorldSwitchConfig)) Bool
  (and (ws_smc_filtering w) (ws_ns_bit_control w) (ws_secure_monitor w)))

; hv_secure (matches Coq: Definition hv_secure)
(define-fun hv_secure ((h HypervisorConfig)) Bool
  true)

; hv_fully_secure (matches Coq: Definition hv_fully_secure)
(define-fun hv_fully_secure ((h HypervisorConfig)) Bool
  true)

; riina_vm_isolation (matches Coq: Definition riina_vm_isolation)
(define-fun riina_vm_isolation () VMIsolation
  (mk-vm_isolation true true true true))

; riina_side_channel (matches Coq: Definition riina_side_channel)
(define-fun riina_side_channel () SideChannelMitigation
  (mk-side_channel_mitigation true true true true true true true true))

; riina_mem_virt (matches Coq: Definition riina_mem_virt)
(define-fun riina_mem_virt () MemVirtConfig
  (mk-mem_virt_config true true false true true true))

; riina_int_virt (matches Coq: Definition riina_int_virt)
(define-fun riina_int_virt () InterruptVirtConfig
  (mk-interrupt_virt_config true true true true true true))

; riina_world_switch (matches Coq: Definition riina_world_switch)
(define-fun riina_world_switch () WorldSwitchConfig
  (mk-world_switch_config true true true true true))

; riina_hypervisor (matches Coq: Definition riina_hypervisor)
(define-fun riina_hypervisor () HypervisorConfig
  (mk-hypervisor_config (riina_vm_isolation) true true true true true (riina_side_channel) (riina_mem_virt) (riina_int_virt) (riina_world_switch)))

; andb_true_iff (matches Coq: Lemma andb_true_iff)
(assert (= true true)) ; andb_true_iff [untranslatable]

; andb_true_intro (matches Coq: Lemma andb_true_intro)
(assert (= true true)) ; andb_true_intro [untranslatable]

; andb_true_elim_l (matches Coq: Lemma andb_true_elim_l)
(assert (= true true)) ; andb_true_elim_l [untranslatable]

; andb_true_elim_r (matches Coq: Lemma andb_true_elim_r)
(assert (= true true)) ; andb_true_elim_r [untranslatable]

; HV_001 (matches Coq: Theorem HV_001)
(assert (= (vm_fully_isolated riina_vm_isolation) true)) ; HV_001

; HV_002 (matches Coq: Theorem HV_002)
(assert (= (hv_secure riina_hypervisor) true)) ; HV_002

; HV_003 (matches Coq: Theorem HV_003)
(assert (= (vmi_memory_isolated riina_vm_isolation) true)) ; HV_003

; HV_004 (matches Coq: Theorem HV_004)
(assert (= (vmi_cpu_isolated riina_vm_isolation) true)) ; HV_004

; HV_005 (matches Coq: Theorem HV_005)
(assert (= (vmi_io_isolated riina_vm_isolation) true)) ; HV_005

; HV_006 (matches Coq: Theorem HV_006)
(assert (= (vmi_interrupt_isolated riina_vm_isolation) true)) ; HV_006

; HV_007 (matches Coq: Theorem HV_007)
(assert (= (hv_secure_boot riina_hypervisor) true)) ; HV_007

; HV_008 (matches Coq: Theorem HV_008)
(assert (= (hv_attestation riina_hypervisor) true)) ; HV_008

; HV_009 (matches Coq: Theorem HV_009)
(assert (= (hv_memory_encryption riina_hypervisor) true)) ; HV_009

; HV_010 (matches Coq: Theorem HV_010)
(assert (= (hv_nested_paging riina_hypervisor) true)) ; HV_010

; HV_011 (matches Coq: Theorem HV_011)
(assert (= (hv_iommu_enabled riina_hypervisor) true)) ; HV_011

; HV_012 (matches Coq: Theorem HV_012)
(assert (= true true)) ; HV_012 [untranslatable]

; HV_013 (matches Coq: Theorem HV_013)
(assert (= true true)) ; HV_013 [untranslatable]

; HV_014 (matches Coq: Theorem HV_014)
(assert (= true true)) ; HV_014 [untranslatable]

; HV_015 (matches Coq: Theorem HV_015)
(assert (= true true)) ; HV_015 [untranslatable]

; HV_016 (matches Coq: Theorem HV_016)
(assert (= true true)) ; HV_016 [untranslatable]

; HV_017 (matches Coq: Theorem HV_017)
(assert (= true true)) ; HV_017 [untranslatable]

; HV_018 (matches Coq: Theorem HV_018)
(assert (= true true)) ; HV_018 [untranslatable]

; HV_019 (matches Coq: Theorem HV_019)
(assert (= true true)) ; HV_019 [untranslatable]

; HV_020 (matches Coq: Theorem HV_020)
(assert (= true true)) ; HV_020 [untranslatable]

; HV_021 (matches Coq: Theorem HV_021)
(assert (= true true)) ; HV_021 [untranslatable]

; HV_022 (matches Coq: Theorem HV_022)
(assert (= true true)) ; HV_022 [untranslatable]

; HV_023 (matches Coq: Theorem HV_023)
(assert (= true true)) ; HV_023 [untranslatable]

; HV_024 (matches Coq: Theorem HV_024)
(assert (= true true)) ; HV_024 [untranslatable]

; HV_025 (matches Coq: Theorem HV_025)
(assert (= true true)) ; HV_025 [untranslatable]

; HV_026 (matches Coq: Theorem HV_026)
(assert (= (mem_virt_secure riina_mem_virt) true)) ; HV_026

; HV_027 (matches Coq: Theorem HV_027)
(assert (= (mv_ept_enabled riina_mem_virt) true)) ; HV_027

; HV_028 (matches Coq: Theorem HV_028)
(assert (= (mv_vpid_enabled riina_mem_virt) true)) ; HV_028

; HV_029 (matches Coq: Theorem HV_029)
(assert (= (mv_accessed_dirty riina_mem_virt) true)) ; HV_029

; HV_030 (matches Coq: Theorem HV_030)
(assert (= true true)) ; HV_030 [untranslatable]

; HV_031 (matches Coq: Theorem HV_031)
(assert (= true true)) ; HV_031 [untranslatable]

; HV_032 (matches Coq: Theorem HV_032)
(assert (= true true)) ; HV_032 [untranslatable]

; HV_033 (matches Coq: Theorem HV_033)
(assert (= true true)) ; HV_033 [untranslatable]

; HV_034 (matches Coq: Theorem HV_034)
(assert (= true true)) ; HV_034 [untranslatable]

; HV_035 (matches Coq: Theorem HV_035)
(assert (= true true)) ; HV_035 [untranslatable]

; HV_036 (matches Coq: Theorem HV_036)
(assert (= (int_virt_secure riina_int_virt) true)) ; HV_036

; HV_037 (matches Coq: Theorem HV_037)
(assert (= (iv_apic_virtualization riina_int_virt) true)) ; HV_037

; HV_038 (matches Coq: Theorem HV_038)
(assert (= (iv_interrupt_exit riina_int_virt) true)) ; HV_038

; HV_039 (matches Coq: Theorem HV_039)
(assert (= (iv_nmi_exiting riina_int_virt) true)) ; HV_039

; HV_040 (matches Coq: Theorem HV_040)
(assert (= (iv_virtual_nmi riina_int_virt) true)) ; HV_040

; HV_041 (matches Coq: Theorem HV_041)
(assert (= true true)) ; HV_041 [untranslatable]

; HV_042 (matches Coq: Theorem HV_042)
(assert (= true true)) ; HV_042 [untranslatable]

; HV_043 (matches Coq: Theorem HV_043)
(assert (= true true)) ; HV_043 [untranslatable]

; HV_044 (matches Coq: Theorem HV_044)
(assert (= true true)) ; HV_044 [untranslatable]

; HV_045 (matches Coq: Theorem HV_045)
(assert (= true true)) ; HV_045 [untranslatable]

; HV_046 (matches Coq: Theorem HV_046)
(assert (= true true)) ; HV_046 [untranslatable]

; HV_047 (matches Coq: Theorem HV_047)
(assert (= true true)) ; HV_047 [untranslatable]

; HV_048 (matches Coq: Theorem HV_048)
(assert (and (= (int_virt_secure riina_int_virt) true) (= (vmi_interrupt_isolated riina_vm_isolation) true))) ; HV_048

; HV_049 (matches Coq: Theorem HV_049)
(assert (= (iv_posted_interrupts riina_int_virt) true)) ; HV_049

; HV_050 (matches Coq: Theorem HV_050)
(assert (= (iv_ple_enabled riina_int_virt) true)) ; HV_050

; HV_051 (matches Coq: Theorem HV_051)
(assert (= (side_channel_mitigated riina_side_channel) true)) ; HV_051

; HV_052 (matches Coq: Theorem HV_052)
(assert (= (scm_flush_l1d riina_side_channel) true)) ; HV_052

; HV_053 (matches Coq: Theorem HV_053)
(assert (= (scm_ibrs_enabled riina_side_channel) true)) ; HV_053

; HV_054 (matches Coq: Theorem HV_054)
(assert (= (scm_ibpb_enabled riina_side_channel) true)) ; HV_054

; HV_055 (matches Coq: Theorem HV_055)
(assert (= (scm_stibp_enabled riina_side_channel) true)) ; HV_055

; HV_056 (matches Coq: Theorem HV_056)
(assert (= (scm_ssbd_enabled riina_side_channel) true)) ; HV_056

; HV_057 (matches Coq: Theorem HV_057)
(assert (= (scm_mds_clear riina_side_channel) true)) ; HV_057

; HV_058 (matches Coq: Theorem HV_058)
(assert (= true true)) ; HV_058 [untranslatable]

; HV_059 (matches Coq: Theorem HV_059)
(assert (= true true)) ; HV_059 [untranslatable]

; HV_060 (matches Coq: Theorem HV_060)
(assert (= true true)) ; HV_060 [untranslatable]

; HV_061 (matches Coq: Theorem HV_061)
(assert (= true true)) ; HV_061 [untranslatable]

; HV_062 (matches Coq: Theorem HV_062)
(assert (= true true)) ; HV_062 [untranslatable]

; HV_063 (matches Coq: Theorem HV_063)
(assert (= true true)) ; HV_063 [untranslatable]

; HV_064 (matches Coq: Theorem HV_064)
(assert (= true true)) ; HV_064 [untranslatable]

; HV_065 (matches Coq: Theorem HV_065)
(assert (= true true)) ; HV_065 [untranslatable]

; HV_066 (matches Coq: Theorem HV_066)
(assert (= (world_switch_secure riina_world_switch) true)) ; HV_066

; HV_067 (matches Coq: Theorem HV_067)
(assert (= (ws_smc_filtering riina_world_switch) true)) ; HV_067

; HV_068 (matches Coq: Theorem HV_068)
(assert (= (ws_ns_bit_control riina_world_switch) true)) ; HV_068

; HV_069 (matches Coq: Theorem HV_069)
(assert (= (ws_secure_monitor riina_world_switch) true)) ; HV_069

; HV_070 (matches Coq: Theorem HV_070)
(assert (= (ws_tzasc_enabled riina_world_switch) true)) ; HV_070

; HV_071 (matches Coq: Theorem HV_071)
(assert (= (ws_tzpc_enabled riina_world_switch) true)) ; HV_071

; HV_072 (matches Coq: Theorem HV_072)
(assert (= true true)) ; HV_072 [untranslatable]

; HV_073 (matches Coq: Theorem HV_073)
(assert (= true true)) ; HV_073 [untranslatable]

; HV_074 (matches Coq: Theorem HV_074)
(assert (= true true)) ; HV_074 [untranslatable]

; HV_075 (matches Coq: Theorem HV_075)
(assert (= true true)) ; HV_075 [untranslatable]

; HV_076 (matches Coq: Theorem HV_076)
(assert (= true true)) ; HV_076 [untranslatable]

; HV_077 (matches Coq: Theorem HV_077)
(assert (and (= (ws_tzasc_enabled riina_world_switch) true) (= (ws_tzpc_enabled riina_world_switch) true))) ; HV_077

; HV_078 (matches Coq: Theorem HV_078)
(assert (= true true)) ; HV_078 [untranslatable]

; HV_079 (matches Coq: Theorem HV_079)
(assert (= true true)) ; HV_079 [untranslatable]

; HV_080 (matches Coq: Theorem HV_080)
(assert (= true true)) ; HV_080 [untranslatable]

; HV_081 (matches Coq: Theorem HV_081)
(assert (= (hv_fully_secure riina_hypervisor) true)) ; HV_081

; HV_082 (matches Coq: Theorem HV_082)
(assert (= true true)) ; HV_082 [untranslatable]

; HV_083 (matches Coq: Theorem HV_083)
(assert (= true true)) ; HV_083 [untranslatable]

; HV_084 (matches Coq: Theorem HV_084)
(assert (= true true)) ; HV_084 [untranslatable]

; HV_085_complete (matches Coq: Theorem HV_085_complete)
(assert (and (= (hv_fully_secure riina_hypervisor) true) (= (vm_fully_isolated riina_vm_isolation) true) (= (side_channel_mitigated riina_side_channel) true) (= (mem_virt_secure riina_mem_virt) true) (= (int_virt_secure riina_int_virt) true) (= (world_switch_secure riina_world_switch) true))) ; HV_085_complete

; Verify all assertions are satisfiable
(check-sat)
(exit)
