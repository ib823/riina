; Copyright (c) 2026 The RIINA Authors. All rights reserved.
; Copyright (c) 2026 The RIINA Authors.
; Auto-generated from 02_FORMAL/coq/domains/BufferOverflowPrevention.v (22 assertions)
; Generated by scripts/generate-full-stack.py
; Module: BufferOverflowPrevention

(set-logic ALL)
(set-option :produce-models true)

; Buffer (matches Coq: Record Buffer)
(declare-datatypes ((Buffer 0))
  (((mk-buffer (buf_size Int) (buf_used Int)))))

; OverflowPrevention (matches Coq: Record OverflowPrevention)
(declare-datatypes ((OverflowPrevention 0))
  (((mk-overflow_prevention (op_bounds_check_write Bool) (op_bounds_check_read Bool) (op_null_terminator_check Bool) (op_integer_overflow_check Bool) (op_stack_canaries Bool)))))

; buffer_valid (matches Coq: Definition buffer_valid)
(define-fun buffer_valid ((b Buffer)) Bool
  Nat)

; buffer_can_write (matches Coq: Definition buffer_can_write)
(define-fun buffer_can_write ((b Buffer) (n Int)) Bool
  Nat)

; buffer_can_read (matches Coq: Definition buffer_can_read)
(define-fun buffer_can_read ((b Buffer)) Bool
  Nat)

; overflow_protected (matches Coq: Definition overflow_protected)
(define-fun overflow_protected ((p OverflowPrevention)) Bool
  (and (op_bounds_check_write p) (op_bounds_check_read p) (op_null_terminator_check p) (op_integer_overflow_check p) (op_stack_canaries p)))

; riina_overflow_config (matches Coq: Definition riina_overflow_config)
(define-fun riina_overflow_config () OverflowPrevention
  (mk-overflow_prevention true true true true true))

; test_buffer (matches Coq: Definition test_buffer)
(define-fun test_buffer () Buffer
  (mk-buffer 100 50))

; andb_true_iff (matches Coq: Lemma andb_true_iff)
(assert (= true true)) ; andb_true_iff [untranslatable]

; BOF_001_test_buffer_valid (matches Coq: Theorem BOF_001_test_buffer_valid)
(assert (= (buffer_valid test_buffer) true)) ; BOF_001_test_buffer_valid

; BOF_002_can_write_bounds (matches Coq: Theorem BOF_002_can_write_bounds)
(assert (= (buffer_can_write test_buffer 50) true)) ; BOF_002_can_write_bounds

; BOF_003_cannot_write_beyond (matches Coq: Theorem BOF_003_cannot_write_beyond)
(assert (= (buffer_can_write test_buffer 51) false)) ; BOF_003_cannot_write_beyond

; BOF_004_can_read_used (matches Coq: Theorem BOF_004_can_read_used)
(assert (= (buffer_can_read test_buffer 0 50) true)) ; BOF_004_can_read_used

; BOF_005_cannot_read_beyond (matches Coq: Theorem BOF_005_cannot_read_beyond)
(assert (= (buffer_can_read test_buffer 0 51) false)) ; BOF_005_cannot_read_beyond

; BOF_006_riina_protected (matches Coq: Theorem BOF_006_riina_protected)
(assert (= (overflow_protected riina_overflow_config) true)) ; BOF_006_riina_protected

; BOF_007_bounds_check_write (matches Coq: Theorem BOF_007_bounds_check_write)
(assert (forall ((p OverflowPrevention)) (=> (= (overflow_protected p) true) (= (op_bounds_check_write p) true)))) ; BOF_007_bounds_check_write

; BOF_008_bounds_check_read (matches Coq: Theorem BOF_008_bounds_check_read)
(assert (forall ((p OverflowPrevention)) (=> (= (overflow_protected p) true) (= (op_bounds_check_read p) true)))) ; BOF_008_bounds_check_read

; BOF_009_integer_overflow (matches Coq: Theorem BOF_009_integer_overflow)
(assert (forall ((p OverflowPrevention)) (=> (= (overflow_protected p) true) (= (op_integer_overflow_check p) true)))) ; BOF_009_integer_overflow

; BOF_010_stack_canaries (matches Coq: Theorem BOF_010_stack_canaries)
(assert (forall ((p OverflowPrevention)) (=> (= (overflow_protected p) true) (= (op_stack_canaries p) true)))) ; BOF_010_stack_canaries

; BOF_011_valid_implies_bounds (matches Coq: Theorem BOF_011_valid_implies_bounds)
(assert (= true true)) ; BOF_011_valid_implies_bounds [untranslatable]

; BOF_012_riina_bounds_write (matches Coq: Theorem BOF_012_riina_bounds_write)
(assert (= (op_bounds_check_write riina_overflow_config) true)) ; BOF_012_riina_bounds_write

; BOF_013_riina_canaries (matches Coq: Theorem BOF_013_riina_canaries)
(assert (= (op_stack_canaries riina_overflow_config) true)) ; BOF_013_riina_canaries

; BOF_014_zero_write_safe (matches Coq: Theorem BOF_014_zero_write_safe)
(assert (forall ((b Buffer)) (=> (= (buffer_valid b) true) (= (buffer_can_write b 0) true)))) ; BOF_014_zero_write_safe

; BOF_015_complete_prevention (matches Coq: Theorem BOF_015_complete_prevention)
(assert (forall ((p OverflowPrevention)) (=> (= (overflow_protected p) true) (and (= (op_bounds_check_write p) true) (= (op_bounds_check_read p) true) (= (op_integer_overflow_check p) true) (= (op_stack_canaries p) true))))) ; BOF_015_complete_prevention

; BOF_016_write_bounded (matches Coq: Theorem BOF_016_write_bounded)
(assert (= true true)) ; BOF_016_write_bounded [untranslatable]

; BOF_017_read_start_within (matches Coq: Theorem BOF_017_read_start_within)
(assert (= true true)) ; BOF_017_read_start_within [untranslatable]

; BOF_018_zero_read_safe (matches Coq: Theorem BOF_018_zero_read_safe)
(assert (forall ((b Buffer)) (= (buffer_can_read b 0 0) true))) ; BOF_018_zero_read_safe

; BOF_019_full_buffer_no_write (matches Coq: Theorem BOF_019_full_buffer_no_write)
(assert (= true true)) ; BOF_019_full_buffer_no_write [untranslatable]

; BOF_020_null_terminator_check (matches Coq: Theorem BOF_020_null_terminator_check)
(assert (forall ((p OverflowPrevention)) (=> (= (overflow_protected p) true) (= (op_null_terminator_check p) true)))) ; BOF_020_null_terminator_check

; BOF_021_valid_after_write (matches Coq: Theorem BOF_021_valid_after_write)
(assert (= true true)) ; BOF_021_valid_after_write [untranslatable]

; Verify all assertions are satisfiable
(check-sat)
(exit)
