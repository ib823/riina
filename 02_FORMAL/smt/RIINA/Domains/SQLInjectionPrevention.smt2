; Copyright (c) 2026 The RIINA Authors. All rights reserved.
; Copyright (c) 2026 The RIINA Authors.
; Auto-generated from 02_FORMAL/coq/domains/SQLInjectionPrevention.v (22 assertions)
; Generated by scripts/generate-full-stack.py
; Module: SQLInjectionPrevention

(set-logic ALL)
(set-option :produce-models true)

; TaintLevel (matches Coq: Inductive TaintLevel)
(declare-datatypes ((TaintLevel 0)) (((Untainted) (UserInput) (StringConcat) (Parameterized) (SQL_Select) (SQL_Insert) (SQL_Update) (SQL_Delete) (SQL_Execute))))

; SQLSecurityConfig (matches Coq: Record SQLSecurityConfig)
(declare-datatypes ((SQLSecurityConfig 0))
  (((mk-sql_security_config (sql_parameterized_only Bool) (sql_no_string_concat Bool) (sql_input_sanitized Bool) (sql_whitelist_validation Bool) (sql_escape_special_chars Bool)))))

; taint_safe (matches Coq: Definition taint_safe)
(define-fun taint_safe ((t TaintLevel)) Bool
  true)

; method_safe (matches Coq: Definition method_safe)
(define-fun method_safe ((m QueryMethod)) Bool
  true)

; sql_injection_protected (matches Coq: Definition sql_injection_protected)
(define-fun sql_injection_protected ((c SQLSecurityConfig)) Bool
  (and (sql_parameterized_only c) (sql_no_string_concat c) (sql_input_sanitized c) (sql_whitelist_validation c) (sql_escape_special_chars c)))

; riina_sql_config (matches Coq: Definition riina_sql_config)
(define-fun riina_sql_config () SQLSecurityConfig
  (mk-sql_security_config true true true true true))

; andb_true_iff (matches Coq: Lemma andb_true_iff)
(assert (= true true)) ; andb_true_iff [untranslatable]

; SQLI_001_untainted_safe (matches Coq: Theorem SQLI_001_untainted_safe)
(assert (= (taint_safe Untainted) true)) ; SQLI_001_untainted_safe

; SQLI_002_sanitized_safe (matches Coq: Theorem SQLI_002_sanitized_safe)
(assert (= (taint_safe Sanitized) true)) ; SQLI_002_sanitized_safe

; SQLI_003_userinput_unsafe (matches Coq: Theorem SQLI_003_userinput_unsafe)
(assert (= (taint_safe UserInput) false)) ; SQLI_003_userinput_unsafe

; SQLI_004_parameterized_safe (matches Coq: Theorem SQLI_004_parameterized_safe)
(assert (= (method_safe Parameterized) true)) ; SQLI_004_parameterized_safe

; SQLI_005_orm_safe (matches Coq: Theorem SQLI_005_orm_safe)
(assert (= (method_safe ORM) true)) ; SQLI_005_orm_safe

; SQLI_006_concat_unsafe (matches Coq: Theorem SQLI_006_concat_unsafe)
(assert (= (method_safe StringConcat) false)) ; SQLI_006_concat_unsafe

; SQLI_007_riina_protected (matches Coq: Theorem SQLI_007_riina_protected)
(assert (= (sql_injection_protected riina_sql_config) true)) ; SQLI_007_riina_protected

; SQLI_008_parameterized_required (matches Coq: Theorem SQLI_008_parameterized_required)
(assert (forall ((c SQLSecurityConfig)) (=> (= (sql_injection_protected c) true) (= (sql_parameterized_only c) true)))) ; SQLI_008_parameterized_required

; SQLI_009_no_concat_required (matches Coq: Theorem SQLI_009_no_concat_required)
(assert (forall ((c SQLSecurityConfig)) (=> (= (sql_injection_protected c) true) (= (sql_no_string_concat c) true)))) ; SQLI_009_no_concat_required

; SQLI_010_sanitization_required (matches Coq: Theorem SQLI_010_sanitization_required)
(assert (forall ((c SQLSecurityConfig)) (=> (= (sql_injection_protected c) true) (= (sql_input_sanitized c) true)))) ; SQLI_010_sanitization_required

; SQLI_011_whitelist_required (matches Coq: Theorem SQLI_011_whitelist_required)
(assert (forall ((c SQLSecurityConfig)) (=> (= (sql_injection_protected c) true) (= (sql_whitelist_validation c) true)))) ; SQLI_011_whitelist_required

; SQLI_012_escape_required (matches Coq: Theorem SQLI_012_escape_required)
(assert (forall ((c SQLSecurityConfig)) (=> (= (sql_injection_protected c) true) (= (sql_escape_special_chars c) true)))) ; SQLI_012_escape_required

; SQLI_013_riina_parameterized (matches Coq: Theorem SQLI_013_riina_parameterized)
(assert (= (sql_parameterized_only riina_sql_config) true)) ; SQLI_013_riina_parameterized

; SQLI_014_sanitization_makes_safe (matches Coq: Theorem SQLI_014_sanitization_makes_safe)
(assert (= true true)) ; SQLI_014_sanitization_makes_safe [untranslatable]

; SQLI_015_complete_prevention (matches Coq: Theorem SQLI_015_complete_prevention)
(assert (forall ((c SQLSecurityConfig)) (=> (= (sql_injection_protected c) true) (and (= (sql_parameterized_only c) true) (= (sql_no_string_concat c) true) (= (sql_input_sanitized c) true) (= (sql_escape_special_chars c) true))))) ; SQLI_015_complete_prevention

; untainted_safe (matches Coq: Theorem untainted_safe)
(assert (= (taint_safe Untainted) true)) ; untainted_safe

; sanitized_safe (matches Coq: Theorem sanitized_safe)
(assert (= (taint_safe Sanitized) true)) ; sanitized_safe

; user_input_unsafe (matches Coq: Theorem user_input_unsafe)
(assert (= (taint_safe UserInput) false)) ; user_input_unsafe

; string_concat_unsafe (matches Coq: Theorem string_concat_unsafe)
(assert (= (method_safe StringConcat) false)) ; string_concat_unsafe

; parameterized_safe (matches Coq: Theorem parameterized_safe)
(assert (= (method_safe Parameterized) true)) ; parameterized_safe

; riina_config_protected (matches Coq: Theorem riina_config_protected)
(assert (= (sql_injection_protected riina_sql_config) true)) ; riina_config_protected

; Verify all assertions are satisfiable
(check-sat)
(exit)
