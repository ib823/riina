-- SPDX-License-Identifier: MPL-2.0
-- Copyright (c) 2026 The RIINA Authors. See AUTHORS file.

/-!
# RIINA MeltdownDefense - Lean 4 Port

Auto-generated port of 02_FORMAL/coq/domains/MeltdownDefense.v (30 theorems).

Generated by scripts/generate-multiprover.py

## Correspondence Table

| Coq Definition | Lean Definition | Status |
|----------------|-----------------|--------|
| MeltdownVariant | MeltdownVariant | OK |
| MeltdownDefenseConfig | MeltdownDefenseConfig | OK |
| all_meltdown_protected | all_meltdown_protected | OK |
| meltdown_mitigations_enabled | meltdown_mitigations_enabled | OK |
| meltdown_fully_protected | meltdown_fully_protected | OK |
| riina_meltdown_config | riina_meltdown_config | OK |
| andb_true_iff | andb_true_iff | OK |
| MELTDOWN_001_all_variants | MELTDOWN_001_all_variants | OK |
| MELTDOWN_002_mitigations | MELTDOWN_002_mitigations | OK |
| MELTDOWN_003_fully_protected | MELTDOWN_003_fully_protected | OK |
| MELTDOWN_004_us_required | MELTDOWN_004_us_required | OK |
| MELTDOWN_005_p_required | MELTDOWN_005_p_required | OK |
| MELTDOWN_006_kpti_required | MELTDOWN_006_kpti_required | OK |
| MELTDOWN_007_l1tf_required | MELTDOWN_007_l1tf_required | OK |
| MELTDOWN_008_full_implies_variants | MELTDOWN_008_full_implies_variants | OK |
| MELTDOWN_009_full_implies_mitigations | MELTDOWN_009_full_implies_mitigations | OK |
| MELTDOWN_010_riina_kpti | MELTDOWN_010_riina_kpti | OK |
| MELTDOWN_011_riina_l1tf | MELTDOWN_011_riina_l1tf | OK |
| MELTDOWN_012_full_implies_kpti | MELTDOWN_012_full_implies_kpti | OK |
| MELTDOWN_013_full_implies_us | MELTDOWN_013_full_implies_us | OK |
| MELTDOWN_014_riina_us | MELTDOWN_014_riina_us | OK |
| MELTDOWN_015_complete_defense | MELTDOWN_015_complete_defense | OK |
| MELTDOWN_016_rw_required | MELTDOWN_016_rw_required | OK |
| MELTDOWN_017_pk_required | MELTDOWN_017_pk_required | OK |
| MELTDOWN_018_br_required | MELTDOWN_018_br_required | OK |
| MELTDOWN_019_full_implies_l1tf | MELTDOWN_019_full_implies_l1tf | OK |
| MELTDOWN_020_full_implies_p | MELTDOWN_020_full_implies_p | OK |
| MELTDOWN_021_full_implies_rw | MELTDOWN_021_full_implies_rw | OK |
| MELTDOWN_022_full_implies_pk | MELTDOWN_022_full_implies_pk | OK |
| MELTDOWN_023_full_implies_br | MELTDOWN_023_full_implies_br | OK |
| MELTDOWN_024_riina_p | MELTDOWN_024_riina_p | OK |
| MELTDOWN_025_riina_rw | MELTDOWN_025_riina_rw | OK |
| MELTDOWN_026_riina_pk | MELTDOWN_026_riina_pk | OK |
| MELTDOWN_027_riina_br | MELTDOWN_027_riina_br | OK |
| MELTDOWN_028_variant_mitigation_composition | MELTDOWN_028_variant_mitigation_composition | OK |
| MELTDOWN_029_complete_decomposition | MELTDOWN_029_complete_decomposition | OK |
-/

namespace RIINA

/-- Boolean conjunction iff (matches Coq: andb_true_iff) -/
private theorem andb_true_iff (a b : Bool) :
    (a && b) = true ↔ a = true ∧ b = true := by
  constructor
  · intro h; cases a <;> cases b <;> simp_all
  · intro ⟨ha, hb⟩; simp [ha, hb]

/-- MeltdownVariant (matches Coq: Inductive MeltdownVariant) -/
inductive MeltdownVariant where
  | meltdown_US : MeltdownVariant  -- User-Supervisor - original Meltdown
  | meltdown_P : MeltdownVariant  -- Present bit - Foreshadow
  | meltdown_RW : MeltdownVariant  -- Read-Write - variant
  | meltdown_PK : MeltdownVariant  -- Protection Keys
  | kPTI : MeltdownVariant  -- Kernel Page Table Isolation
  | l1TF_Flush : MeltdownVariant  -- L1 Terminal Fault mitigation
  | tSX_Disable : MeltdownVariant  -- Disable Transactional Memory
  deriving DecidableEq, Repr

/-- MeltdownDefenseConfig (matches Coq: Record MeltdownDefenseConfig) -/
structure MeltdownDefenseConfig where
  mdc_us_protected : Bool
  mdc_p_protected : Bool
  mdc_rw_protected : Bool
  mdc_pk_protected : Bool
  mdc_br_protected : Bool
  mdc_kpti_enabled : Bool
  mdc_l1tf_mitigated : Bool
  deriving DecidableEq, Repr

/-- all_meltdown_protected (matches Coq: Definition all_meltdown_protected) -/
def all_meltdown_protected (c : MeltdownDefenseConfig) : Bool :=
  mdc_us_protected c &&
  mdc_p_protected c &&
  mdc_rw_protected c &&
  mdc_pk_protected c &&
  mdc_br_protected c

/-- meltdown_mitigations_enabled (matches Coq: Definition meltdown_mitigations_enabled) -/
def meltdown_mitigations_enabled (c : MeltdownDefenseConfig) : Bool :=
  mdc_kpti_enabled c && mdc_l1tf_mitigated c

/-- meltdown_fully_protected (matches Coq: Definition meltdown_fully_protected) -/
def meltdown_fully_protected (c : MeltdownDefenseConfig) : Bool :=
  all_meltdown_protected c && meltdown_mitigations_enabled c

/-- riina_meltdown_config (matches Coq: Definition riina_meltdown_config) -/
def riina_meltdown_config : MeltdownDefenseConfig := mkMeltdownConfig
  true true true true true true true

/-- andb_true_iff (matches Coq) -/
theorem andb_true_iff : ∀ a b : bool, a && b = true <-> a = true ∧ b = true := by
  cases ‹_› <;> simp

/-- MELTDOWN_001: All Variants Protected -/
/-- MELTDOWN_001_all_variants (matches Coq) -/
theorem MELTDOWN_001_all_variants : all_meltdown_protected riina_meltdown_config = true := by
  rfl

/-- MELTDOWN_002: Mitigations Enabled -/
/-- MELTDOWN_002_mitigations (matches Coq) -/
theorem MELTDOWN_002_mitigations : meltdown_mitigations_enabled riina_meltdown_config = true := by
  rfl

/-- MELTDOWN_003: Fully Protected -/
/-- MELTDOWN_003_fully_protected (matches Coq) -/
theorem MELTDOWN_003_fully_protected : meltdown_fully_protected riina_meltdown_config = true := by
  rfl

/-- MELTDOWN_004: US Protection Required -/
/-- MELTDOWN_004_us_required (matches Coq) -/
theorem MELTDOWN_004_us_required : ∀ c : MeltdownDefenseConfig, all_meltdown_protected c = true → mdc_us_protected c = true := by
  simp_all [Bool.and_eq_true]

/-- MELTDOWN_005: Foreshadow Protection Required -/
/-- MELTDOWN_005_p_required (matches Coq) -/
theorem MELTDOWN_005_p_required : ∀ c : MeltdownDefenseConfig, all_meltdown_protected c = true → mdc_p_protected c = true := by
  simp_all [Bool.and_eq_true]

/-- MELTDOWN_006: KPTI Required -/
/-- MELTDOWN_006_kpti_required (matches Coq) -/
theorem MELTDOWN_006_kpti_required : ∀ c : MeltdownDefenseConfig, meltdown_mitigations_enabled c = true → mdc_kpti_enabled c = true := by
  simp_all [Bool.and_eq_true]

/-- MELTDOWN_007: L1TF Mitigation Required -/
/-- MELTDOWN_007_l1tf_required (matches Coq) -/
theorem MELTDOWN_007_l1tf_required : ∀ c : MeltdownDefenseConfig, meltdown_mitigations_enabled c = true → mdc_l1tf_mitigated c = true := by
  simp_all [Bool.and_eq_true]

/-- MELTDOWN_008: Full Implies Variants -/
/-- MELTDOWN_008_full_implies_variants (matches Coq) -/
theorem MELTDOWN_008_full_implies_variants : ∀ c : MeltdownDefenseConfig, meltdown_fully_protected c = true → all_meltdown_protected c = true := by
  simp_all [Bool.and_eq_true]

/-- MELTDOWN_009: Full Implies Mitigations -/
/-- MELTDOWN_009_full_implies_mitigations (matches Coq) -/
theorem MELTDOWN_009_full_implies_mitigations : ∀ c : MeltdownDefenseConfig, meltdown_fully_protected c = true → meltdown_mitigations_enabled c = true := by
  simp_all [Bool.and_eq_true]

/-- MELTDOWN_010: RIINA KPTI Enabled -/
/-- MELTDOWN_010_riina_kpti (matches Coq) -/
theorem MELTDOWN_010_riina_kpti : mdc_kpti_enabled riina_meltdown_config = true := by
  rfl

/-- MELTDOWN_011: RIINA L1TF Mitigated -/
/-- MELTDOWN_011_riina_l1tf (matches Coq) -/
theorem MELTDOWN_011_riina_l1tf : mdc_l1tf_mitigated riina_meltdown_config = true := by
  rfl

/-- MELTDOWN_012: Full Implies KPTI -/
/-- MELTDOWN_012_full_implies_kpti (matches Coq) -/
theorem MELTDOWN_012_full_implies_kpti : ∀ c : MeltdownDefenseConfig, meltdown_fully_protected c = true → mdc_kpti_enabled c = true := by
  simp_all [Bool.and_eq_true]

/-- MELTDOWN_013: Full Implies US Protected -/
/-- MELTDOWN_013_full_implies_us (matches Coq) -/
theorem MELTDOWN_013_full_implies_us : ∀ c : MeltdownDefenseConfig, meltdown_fully_protected c = true → mdc_us_protected c = true := by
  simp_all [Bool.and_eq_true]

/-- MELTDOWN_014: RIINA US Protected -/
/-- MELTDOWN_014_riina_us (matches Coq) -/
theorem MELTDOWN_014_riina_us : mdc_us_protected riina_meltdown_config = true := by
  rfl

/-- MELTDOWN_015: Complete Meltdown Defense -/
/-- MELTDOWN_015_complete_defense (matches Coq) -/
theorem MELTDOWN_015_complete_defense : ∀ c : MeltdownDefenseConfig, meltdown_fully_protected c = true → mdc_us_protected c = true ∧ mdc_kpti_enabled c = true ∧ mdc_l1tf_mitigated c = true := by
  simp_all [Bool.and_eq_true]

/-- MELTDOWN_016: RW Protection Required -/
/-- MELTDOWN_016_rw_required (matches Coq) -/
theorem MELTDOWN_016_rw_required : ∀ c : MeltdownDefenseConfig, all_meltdown_protected c = true → mdc_rw_protected c = true := by
  simp_all [Bool.and_eq_true]

/-- MELTDOWN_017: PK Protection Required -/
/-- MELTDOWN_017_pk_required (matches Coq) -/
theorem MELTDOWN_017_pk_required : ∀ c : MeltdownDefenseConfig, all_meltdown_protected c = true → mdc_pk_protected c = true := by
  simp_all [Bool.and_eq_true]

/-- MELTDOWN_018: BR Protection Required -/
/-- MELTDOWN_018_br_required (matches Coq) -/
theorem MELTDOWN_018_br_required : ∀ c : MeltdownDefenseConfig, all_meltdown_protected c = true → mdc_br_protected c = true := by
  simp_all [Bool.and_eq_true]

/-- MELTDOWN_019: Full Implies L1TF Mitigated -/
/-- MELTDOWN_019_full_implies_l1tf (matches Coq) -/
theorem MELTDOWN_019_full_implies_l1tf : ∀ c : MeltdownDefenseConfig, meltdown_fully_protected c = true → mdc_l1tf_mitigated c = true := by
  simp_all [Bool.and_eq_true]

/-- MELTDOWN_020: Full Implies Foreshadow Protected -/
/-- MELTDOWN_020_full_implies_p (matches Coq) -/
theorem MELTDOWN_020_full_implies_p : ∀ c : MeltdownDefenseConfig, meltdown_fully_protected c = true → mdc_p_protected c = true := by
  simp_all [Bool.and_eq_true]

/-- MELTDOWN_021: Full Implies RW Protected -/
/-- MELTDOWN_021_full_implies_rw (matches Coq) -/
theorem MELTDOWN_021_full_implies_rw : ∀ c : MeltdownDefenseConfig, meltdown_fully_protected c = true → mdc_rw_protected c = true := by
  simp_all [Bool.and_eq_true]

/-- MELTDOWN_022: Full Implies PK Protected -/
/-- MELTDOWN_022_full_implies_pk (matches Coq) -/
theorem MELTDOWN_022_full_implies_pk : ∀ c : MeltdownDefenseConfig, meltdown_fully_protected c = true → mdc_pk_protected c = true := by
  simp_all [Bool.and_eq_true]

/-- MELTDOWN_023: Full Implies BR Protected -/
/-- MELTDOWN_023_full_implies_br (matches Coq) -/
theorem MELTDOWN_023_full_implies_br : ∀ c : MeltdownDefenseConfig, meltdown_fully_protected c = true → mdc_br_protected c = true := by
  simp_all [Bool.and_eq_true]

/-- MELTDOWN_024: RIINA P Protected -/
/-- MELTDOWN_024_riina_p (matches Coq) -/
theorem MELTDOWN_024_riina_p : mdc_p_protected riina_meltdown_config = true := by
  rfl

/-- MELTDOWN_025: RIINA RW Protected -/
/-- MELTDOWN_025_riina_rw (matches Coq) -/
theorem MELTDOWN_025_riina_rw : mdc_rw_protected riina_meltdown_config = true := by
  rfl

/-- MELTDOWN_026: RIINA PK Protected -/
/-- MELTDOWN_026_riina_pk (matches Coq) -/
theorem MELTDOWN_026_riina_pk : mdc_pk_protected riina_meltdown_config = true := by
  rfl

/-- MELTDOWN_027: RIINA BR Protected -/
/-- MELTDOWN_027_riina_br (matches Coq) -/
theorem MELTDOWN_027_riina_br : mdc_br_protected riina_meltdown_config = true := by
  rfl

/-- MELTDOWN_028: Variant and Mitigation Composition -/
/-- MELTDOWN_028_variant_mitigation_composition (matches Coq) -/
theorem MELTDOWN_028_variant_mitigation_composition : ∀ c : MeltdownDefenseConfig, all_meltdown_protected c = true → meltdown_mitigations_enabled c = true → meltdown_fully_protected c = true := by
  rfl

/-- MELTDOWN_029: Complete Decomposition -/
/-- MELTDOWN_029_complete_decomposition (matches Coq) -/
theorem MELTDOWN_029_complete_decomposition : ∀ c : MeltdownDefenseConfig, meltdown_fully_protected c = true → mdc_us_protected c = true ∧ mdc_p_protected c = true ∧ mdc_rw_protected c = true ∧ mdc_pk_protected c = true ∧ mdc_br_protected c = true ∧ mdc_kpti_enabled c = true ∧ mdc_l1tf_mitigated c = true := by
  simp_all [Bool.and_eq_true]

end RIINA
