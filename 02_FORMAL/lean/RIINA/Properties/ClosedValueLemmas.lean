-- SPDX-License-Identifier: MPL-2.0
-- Copyright (c) 2026 The RIINA Authors. See AUTHORS file.

/-!
# RIINA ClosedValueLemmas - Lean 4 Port

Auto-generated port of 02_FORMAL/coq/properties/ClosedValueLemmas.v (11 theorems).

Generated by scripts/generate-multiprover.py

## Correspondence Table

| Coq Definition | Lean Definition | Status |
|----------------|-----------------|--------|
| closed_expr_cv | closed_expr_cv | OK |
| value_typed_closed | value_typed_closed | OK |
| closed_pair_cv | closed_pair_cv | OK |
| closed_inl_cv | closed_inl_cv | OK |
| closed_inr_cv | closed_inr_cv | OK |
| closed_app_cv | closed_app_cv | OK |
| closed_unit_cv | closed_unit_cv | OK |
| closed_bool_cv | closed_bool_cv | OK |
| closed_int_cv | closed_int_cv | OK |
| closed_string_cv | closed_string_cv | OK |
| closed_loc_cv | closed_loc_cv | OK |
| closed_lam_body_cv | closed_lam_body_cv | OK |
-/

namespace RIINA

/-- closed_expr_cv (matches Coq: Definition closed_expr_cv) -/
def closed_expr_cv (e : expr) : Prop :=
  forall x, ~ free_in x e

/-- Values are closed under empty context typing -/
/-- value_typed_closed (matches Coq) -/
theorem value_typed_closed : ∀ Σ Δ v T ε, value v → has_type nil Σ Δ v T ε → closed_expr_cv v := by
  simp_all [Bool.and_eq_true]

/-- Closed expressions for compound types - decomposition -/
/-- closed_pair_cv (matches Coq) -/
theorem closed_pair_cv : ∀ e1 e2, closed_expr_cv (EPair e1 e2) <-> closed_expr_cv e1 ∧ closed_expr_cv e2 := by
  simp_all

/-- closed_inl_cv (matches Coq) -/
theorem closed_inl_cv : ∀ e T, closed_expr_cv (EInl e T) <-> closed_expr_cv e := by
  simp_all

/-- closed_inr_cv (matches Coq) -/
theorem closed_inr_cv : ∀ e T, closed_expr_cv (EInr e T) <-> closed_expr_cv e := by
  simp_all

/-- closed_app_cv (matches Coq) -/
theorem closed_app_cv : ∀ e1 e2, closed_expr_cv (EApp e1 e2) <-> closed_expr_cv e1 ∧ closed_expr_cv e2 := by
  simp_all

/-- Values: specific closed lemmas -/
/-- closed_unit_cv (matches Coq) -/
theorem closed_unit_cv : closed_expr_cv EUnit := by
  intro h; exact h

/-- closed_bool_cv (matches Coq) -/
theorem closed_bool_cv : ∀ b, closed_expr_cv (EBool b) := by
  intro h; exact h

/-- closed_int_cv (matches Coq) -/
theorem closed_int_cv : ∀ n, closed_expr_cv (EInt n) := by
  intro h; exact h

/-- closed_string_cv (matches Coq) -/
theorem closed_string_cv : ∀ s, closed_expr_cv (EString s) := by
  intro h; exact h

/-- closed_loc_cv (matches Coq) -/
theorem closed_loc_cv : ∀ l, closed_expr_cv (ELoc l) := by
  intro h; exact h

/-- Lambda: bound variable can be free in body but not in lambda -/
/-- closed_lam_body_cv (matches Coq) -/
theorem closed_lam_body_cv : ∀ x T body y, closed_expr_cv (ELam x T body) → free_in y body → y = x := by
  simp_all

end RIINA
