-- SPDX-License-Identifier: MPL-2.0
-- Copyright (c) 2026 The RIINA Authors. See AUTHORS file.

/-!
# RIINA Composition - Lean 4 Port

Auto-generated port of 02_FORMAL/coq/properties/Composition.v (6 theorems).

Generated by scripts/generate-multiprover.py

## Correspondence Table

| Coq Definition | Lean Definition | Status |
|----------------|-----------------|--------|
| val_rel_pair | val_rel_pair | OK |
| val_rel_inl | val_rel_inl | OK |
| val_rel_inr | val_rel_inr | OK |
| exp_rel_pair_values | exp_rel_pair_values | OK |
| exp_rel_inl_values | exp_rel_inl_values | OK |
| exp_rel_inr_values | exp_rel_inr_values | OK |
-/

namespace RIINA

/-- val_rel_pair (matches Coq) -/
theorem val_rel_pair : ∀ Σ T1 T2 v1 v1' v2 v2', val_rel Σ T1 v1 v1' → val_rel Σ T2 v2 v2' → has_type nil Σ Public v1 T1 EffectPure → has_type nil Σ Public v1' T1 EffectPure → has_type nil Σ Public v2 T2 EffectPure → has_type nil Σ Public v2' T2 EffectPure → val_rel Σ (TProd T1 T2) (EPair v1 v2) (EPair v1' v2') := by
  simp_all [Bool.and_eq_true]

/-- val_rel_inl (matches Coq) -/
theorem val_rel_inl : ∀ Σ T1 T2 v1 v2, val_rel Σ T1 v1 v2 → has_type nil Σ Public v1 T1 EffectPure → has_type nil Σ Public v2 T1 EffectPure → val_rel Σ (TSum T1 T2) (EInl v1 T2) (EInl v2 T2) := by
  simp_all [Bool.and_eq_true]

/-- val_rel_inr (matches Coq) -/
theorem val_rel_inr : ∀ Σ T1 T2 v1 v2, val_rel Σ T2 v1 v2 → has_type nil Σ Public v1 T2 EffectPure → has_type nil Σ Public v2 T2 EffectPure → val_rel Σ (TSum T1 T2) (EInr v1 T1) (EInr v2 T1) := by
  simp_all [Bool.and_eq_true]

/-- These follow directly from val_rel lemmas + exp_rel_of_val_rel -/
/-- exp_rel_pair_values (matches Coq) -/
theorem exp_rel_pair_values : ∀ Σ T1 T2 v1 v1' v2 v2', val_rel Σ T1 v1 v1' → val_rel Σ T2 v2 v2' → has_type nil Σ Public v1 T1 EffectPure → has_type nil Σ Public v1' T1 EffectPure → has_type nil Σ Public v2 T2 EffectPure → has_type nil Σ Public v2' T2 EffectPure → exp_rel Σ (TProd T1 T2) (EPair v1 v2) (EPair v1' v2') := by
  simp_all [Bool.and_eq_true]

/-- exp_rel_inl_values (matches Coq) -/
theorem exp_rel_inl_values : ∀ Σ T1 T2 v1 v2, val_rel Σ T1 v1 v2 → has_type nil Σ Public v1 T1 EffectPure → has_type nil Σ Public v2 T1 EffectPure → exp_rel Σ (TSum T1 T2) (EInl v1 T2) (EInl v2 T2) := by
  simp_all [Bool.and_eq_true]

/-- exp_rel_inr_values (matches Coq) -/
theorem exp_rel_inr_values : ∀ Σ T1 T2 v1 v2, val_rel Σ T2 v1 v2 → has_type nil Σ Public v1 T2 EffectPure → has_type nil Σ Public v2 T2 EffectPure → exp_rel Σ (TSum T1 T2) (EInr v1 T1) (EInr v2 T1) := by
  simp_all [Bool.and_eq_true]

end RIINA
