---- MODULE PSI001_OperationalSecurity ----
\* Copyright (c) 2026 The RIINA Authors. All rights reserved.
\* Auto-generated from 02_FORMAL/coq/domains/PSI001_OperationalSecurity.v (39 invariants)
\* Generated by scripts/generate-full-stack.py

EXTENDS Naturals, FiniteSets, Sequences

\* AuthMode (matches Coq: Inductive AuthMode)
CONSTANTS NormalAuth, DuressAuth, EmergencyAuth

\* Share (matches Coq: Record Share)
VARIABLES share_x, share_y

\* ThresholdPolicy (matches Coq: Record ThresholdPolicy)
VARIABLES tp_n, tp_m, tp_approvals

\* DuressResponse (matches Coq: Record DuressResponse)
VARIABLES dr_silent_alert, dr_fake_access, dr_real_lockdown, dr_audit_logged

\* DeadManSwitch (matches Coq: Record DeadManSwitch)
VARIABLES dms_last_checkin, dms_timeout, dms_triggered, dms_recovery_action

\* InsiderBudget (matches Coq: Record InsiderBudget)
VARIABLES ib_max_bytes, ib_max_queries, ib_bytes_used, ib_queries_used, ib_window_start

\* AuditEntry (matches Coq: Record AuditEntry)
VARIABLES ae_timestamp, ae_actor, ae_action, ae_data_hash, ae_prev_hash

\* Platform (matches Coq: Record Platform)
VARIABLES plat_vendor, plat_arch, plat_firmware_hash

\* TimeLock (matches Coq: Record TimeLock)
VARIABLES tl_operation, tl_submit_time, tl_execute_time, tl_cancelled

\* Type invariant
TypeOK ==
  /\ share_x \in BOOLEAN
  /\ share_y \in BOOLEAN
  /\ tp_n \in BOOLEAN
  /\ tp_m \in BOOLEAN
  /\ tp_approvals \in BOOLEAN
  /\ dr_silent_alert \in BOOLEAN
  /\ dr_fake_access \in BOOLEAN
  /\ dr_real_lockdown \in BOOLEAN
  /\ dr_audit_logged \in BOOLEAN
  /\ dms_last_checkin \in BOOLEAN
  /\ dms_timeout \in BOOLEAN
  /\ dms_triggered \in BOOLEAN
  /\ dms_recovery_action \in BOOLEAN
  /\ ib_max_bytes \in BOOLEAN
  /\ ib_max_queries \in BOOLEAN
  /\ ib_bytes_used \in BOOLEAN
  /\ ib_queries_used \in BOOLEAN
  /\ ib_window_start \in BOOLEAN
  /\ ae_timestamp \in BOOLEAN
  /\ ae_actor \in BOOLEAN
  /\ ae_action \in BOOLEAN
  /\ ae_data_hash \in BOOLEAN
  /\ ae_prev_hash \in BOOLEAN
  /\ plat_vendor \in BOOLEAN
  /\ plat_arch \in BOOLEAN
  /\ plat_firmware_hash \in BOOLEAN
  /\ tl_operation \in BOOLEAN
  /\ tl_submit_time \in BOOLEAN
  /\ tl_execute_time \in BOOLEAN
  /\ tl_cancelled \in BOOLEAN

\* Initial state
Init ==
  /\ share_x = TRUE
  /\ share_y = TRUE
  /\ tp_n = TRUE
  /\ tp_m = TRUE
  /\ tp_approvals = TRUE
  /\ dr_silent_alert = TRUE
  /\ dr_fake_access = TRUE
  /\ dr_real_lockdown = TRUE
  /\ dr_audit_logged = TRUE
  /\ dms_last_checkin = TRUE
  /\ dms_timeout = TRUE
  /\ dms_triggered = TRUE
  /\ dms_recovery_action = TRUE
  /\ ib_max_bytes = TRUE
  /\ ib_max_queries = TRUE
  /\ ib_bytes_used = TRUE
  /\ ib_queries_used = TRUE
  /\ ib_window_start = TRUE
  /\ ae_timestamp = TRUE
  /\ ae_actor = TRUE
  /\ ae_action = TRUE
  /\ ae_data_hash = TRUE
  /\ ae_prev_hash = TRUE
  /\ plat_vendor = TRUE
  /\ plat_arch = TRUE
  /\ plat_firmware_hash = TRUE
  /\ tl_operation = TRUE
  /\ tl_submit_time = TRUE
  /\ tl_execute_time = TRUE
  /\ tl_cancelled = TRUE

\* field_add (matches Coq: Definition field_add)
field_add == TRUE

\* field_mul (matches Coq: Definition field_mul)
field_mul == TRUE

\* field_sub (matches Coq: Definition field_sub)
field_sub == TRUE

\* secret_from_poly (matches Coq: Definition secret_from_poly)
secret_from_poly == TRUE

\* threshold_met (matches Coq: Definition threshold_met)
threshold_met(k) == TRUE

\* tp_approved (matches Coq: Definition tp_approved)
tp_approved(pol) == TRUE

\* tp_add_approval (matches Coq: Definition tp_add_approval)
tp_add_approval(pol, party) == TRUE

\* tp_valid (matches Coq: Definition tp_valid)
tp_valid(pol) == TRUE

\* handle_auth (matches Coq: Definition handle_auth)
handle_auth(mode) == TRUE

\* dms_check (matches Coq: Definition dms_check)
dms_check(dms, now) == TRUE

\* dms_checkin (matches Coq: Definition dms_checkin)
dms_checkin(dms, now) == TRUE

\* ib_can_query (matches Coq: Definition ib_can_query)
ib_can_query(budget, bytes) == TRUE

\* ib_record_query (matches Coq: Definition ib_record_query)
ib_record_query(budget, bytes) == TRUE

\* audit_log_append (matches Coq: Definition audit_log_append)
audit_log_append(log, entry) == TRUE

\* audit_chain_valid (matches Coq: Definition audit_chain_valid)
audit_chain_valid(log) == TRUE

\* platforms_independent (matches Coq: Definition platforms_independent)
platforms_independent == TRUE

\* nversion_agree (matches Coq: Definition nversion_agree)
nversion_agree == TRUE

\* tl_can_execute (matches Coq: Definition tl_can_execute)
tl_can_execute(tl, now) == TRUE

\* tl_can_cancel (matches Coq: Definition tl_can_cancel)
tl_can_cancel(tl, now) == TRUE

\* tl_cancel (matches Coq: Definition tl_cancel)
tl_cancel(tl) == TRUE

\* nth_map_seq (matches Coq: Lemma nth_map_seq)
THEOREM nth_map_seq == Init => TypeOK

\* PSI_001_01_poly_eval_zero (matches Coq: Theorem PSI_001_01_poly_eval_zero)
THEOREM PSI_001_01_poly_eval_zero == Init => TypeOK

\* PSI_001_02_generate_shares_length (matches Coq: Theorem PSI_001_02_generate_shares_length)
THEOREM PSI_001_02_generate_shares_length == Init => TypeOK

\* PSI_001_03_threshold_monotone (matches Coq: Theorem PSI_001_03_threshold_monotone)
THEOREM PSI_001_03_threshold_monotone == Init => TypeOK

\* PSI_001_04_insufficient_shares (matches Coq: Theorem PSI_001_04_insufficient_shares)
THEOREM PSI_001_04_insufficient_shares == Init => TypeOK

\* PSI_001_05_share_x_positive (matches Coq: Theorem PSI_001_05_share_x_positive)
THEOREM PSI_001_05_share_x_positive == Init => TypeOK

\* PSI_001_06_shares_distinct_x (matches Coq: Theorem PSI_001_06_shares_distinct_x)
THEOREM PSI_001_06_shares_distinct_x == Init => TypeOK

\* PSI_001_07_secret_is_constant_term (matches Coq: Theorem PSI_001_07_secret_is_constant_term)
THEOREM PSI_001_07_secret_is_constant_term == Init => TypeOK

\* PSI_001_08_empty_poly_zero_secret (matches Coq: Theorem PSI_001_08_empty_poly_zero_secret)
THEOREM PSI_001_08_empty_poly_zero_secret == Init => TypeOK

\* PSI_002_01_single_approval_insufficient (matches Coq: Theorem PSI_002_01_single_approval_insufficient)
THEOREM PSI_002_01_single_approval_insufficient == Init => TypeOK

\* PSI_002_02_approval_monotone (matches Coq: Theorem PSI_002_02_approval_monotone)
THEOREM PSI_002_02_approval_monotone == Init => TypeOK

\* PSI_002_03_duplicate_approval_noop (matches Coq: Theorem PSI_002_03_duplicate_approval_noop)
THEOREM PSI_002_03_duplicate_approval_noop == Init => TypeOK

\* PSI_002_04_valid_policy_n_le_m (matches Coq: Theorem PSI_002_04_valid_policy_n_le_m)
THEOREM PSI_002_04_valid_policy_n_le_m == Init => TypeOK

\* PSI_002_05_valid_policy_n_positive (matches Coq: Theorem PSI_002_05_valid_policy_n_positive)
THEOREM PSI_002_05_valid_policy_n_positive == Init => TypeOK

\* PSI_002_06_approval_count_increases (matches Coq: Theorem PSI_002_06_approval_count_increases)
THEOREM PSI_002_06_approval_count_increases == Init => TypeOK

\* PSI_003_01_duress_triggers_alert (matches Coq: Theorem PSI_003_01_duress_triggers_alert)
THEOREM PSI_003_01_duress_triggers_alert == Init => TypeOK

\* PSI_003_02_duress_provides_fake (matches Coq: Theorem PSI_003_02_duress_provides_fake)
THEOREM PSI_003_02_duress_provides_fake == Init => TypeOK

\* PSI_003_03_duress_locks_down (matches Coq: Theorem PSI_003_03_duress_locks_down)
THEOREM PSI_003_03_duress_locks_down == Init => TypeOK

\* PSI_003_04_all_auth_audited (matches Coq: Theorem PSI_003_04_all_auth_audited)
THEOREM PSI_003_04_all_auth_audited == Init => TypeOK

\* PSI_003_05_normal_no_fake (matches Coq: Theorem PSI_003_05_normal_no_fake)
THEOREM PSI_003_05_normal_no_fake == Init => TypeOK

\* PSI_003_06_normal_no_alert (matches Coq: Theorem PSI_003_06_normal_no_alert)
THEOREM PSI_003_06_normal_no_alert == Init => TypeOK

\* PSI_004_01_checkin_resets (matches Coq: Theorem PSI_004_01_checkin_resets)
THEOREM PSI_004_01_checkin_resets == Init => TypeOK

\* PSI_004_02_checkin_updates_time (matches Coq: Theorem PSI_004_02_checkin_updates_time)
THEOREM PSI_004_02_checkin_updates_time == Init => TypeOK

\* PSI_004_03_timeout_triggers (matches Coq: Theorem PSI_004_03_timeout_triggers)
THEOREM PSI_004_03_timeout_triggers == Init => TypeOK

\* PSI_004_04_no_timeout_no_trigger (matches Coq: Theorem PSI_004_04_no_timeout_no_trigger)
THEOREM PSI_004_04_no_timeout_no_trigger == Init => TypeOK

\* PSI_004_05_recovery_action_preserved (matches Coq: Theorem PSI_004_05_recovery_action_preserved)
THEOREM PSI_004_05_recovery_action_preserved == Init => TypeOK

\* PSI_005_01_budget_enforced (matches Coq: Theorem PSI_005_01_budget_enforced)
THEOREM PSI_005_01_budget_enforced == Init => TypeOK

\* PSI_005_02_budget_query_count (matches Coq: Theorem PSI_005_02_budget_query_count)
THEOREM PSI_005_02_budget_query_count == Init => TypeOK

\* PSI_005_03_record_increases_bytes (matches Coq: Theorem PSI_005_03_record_increases_bytes)
THEOREM PSI_005_03_record_increases_bytes == Init => TypeOK

\* PSI_005_04_record_increases_queries (matches Coq: Theorem PSI_005_04_record_increases_queries)
THEOREM PSI_005_04_record_increases_queries == Init => TypeOK

\* PSI_005_05_audit_append_preserves (matches Coq: Theorem PSI_005_05_audit_append_preserves)
THEOREM PSI_005_05_audit_append_preserves == Init => TypeOK

\* PSI_006_01_timelock_cancellation_window (matches Coq: Theorem PSI_006_01_timelock_cancellation_window)
THEOREM PSI_006_01_timelock_cancellation_window == Init => TypeOK

\* PSI_006_02_cancelled_cannot_execute (matches Coq: Theorem PSI_006_02_cancelled_cannot_execute)
THEOREM PSI_006_02_cancelled_cannot_execute == Init => TypeOK

\* PSI_006_03_cancel_sets_flag (matches Coq: Theorem PSI_006_03_cancel_sets_flag)
THEOREM PSI_006_03_cancel_sets_flag == Init => TypeOK

\* PSI_006_04_early_execute_blocked (matches Coq: Theorem PSI_006_04_early_execute_blocked)
THEOREM PSI_006_04_early_execute_blocked == Init => TypeOK

\* PSI_006_05_cancel_preserves_operation (matches Coq: Theorem PSI_006_05_cancel_preserves_operation)
THEOREM PSI_006_05_cancel_preserves_operation == Init => TypeOK

\* PSI_007_01_different_vendor_independent (matches Coq: Theorem PSI_007_01_different_vendor_independent)
THEOREM PSI_007_01_different_vendor_independent == Init => TypeOK

\* PSI_007_02_nversion_single_agrees (matches Coq: Theorem PSI_007_02_nversion_single_agrees)
THEOREM PSI_007_02_nversion_single_agrees == Init => TypeOK

\* PSI_007_03_nversion_empty_agrees (matches Coq: Theorem PSI_007_03_nversion_empty_agrees)
THEOREM PSI_007_03_nversion_empty_agrees == Init => TypeOK

\* Next-state relation
Next == UNCHANGED <<share_x, share_y, tp_n, tp_m, tp_approvals, dr_silent_alert, dr_fake_access, dr_real_lockdown, dr_audit_logged, dms_last_checkin, dms_timeout, dms_triggered, dms_recovery_action, ib_max_bytes, ib_max_queries, ib_bytes_used, ib_queries_used, ib_window_start, ae_timestamp, ae_actor, ae_action, ae_data_hash, ae_prev_hash, plat_vendor, plat_arch, plat_firmware_hash, tl_operation, tl_submit_time, tl_execute_time, tl_cancelled>>

\* Specification
Spec == Init /\ [][Next]_<<share_x, share_y, tp_n, tp_m, tp_approvals, dr_silent_alert, dr_fake_access, dr_real_lockdown, dr_audit_logged, dms_last_checkin, dms_timeout, dms_triggered, dms_recovery_action, ib_max_bytes, ib_max_queries, ib_bytes_used, ib_queries_used, ib_window_start, ae_timestamp, ae_actor, ae_action, ae_data_hash, ae_prev_hash, plat_vendor, plat_arch, plat_firmware_hash, tl_operation, tl_submit_time, tl_execute_time, tl_cancelled>>

====
