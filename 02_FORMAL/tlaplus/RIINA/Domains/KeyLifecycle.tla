---- MODULE KeyLifecycle ----
\* SPDX-License-Identifier: MPL-2.0
\* Copyright (c) 2026 The RIINA Authors.
\* Auto-generated from 02_FORMAL/coq/domains/KeyLifecycle.v (25 invariants)
\* Generated by scripts/generate-full-stack.py

EXTENDS Naturals, FiniteSets, Sequences

\* KeyState (matches Coq: Inductive KeyState)
CONSTANTS PreGeneration, Active, Suspended, Deactivated, Compromised, Destroyed

\* KeyType (matches Coq: Inductive KeyType)
CONSTANTS SymmetricKey, AsymmetricPrivate, AsymmetricPublic, SigningKey, EncryptionKey

VARIABLES state

\* Type invariant
TypeOK ==
  /\ state \in BOOLEAN

\* Initial state
Init ==
  /\ state = TRUE

\* entropy_sufficient (matches Coq: Definition entropy_sufficient)
entropy_sufficient(key, min_entropy) == TRUE

\* is_usable_state (matches Coq: Definition is_usable_state)
is_usable_state(state) == TRUE

\* valid_transition (matches Coq: Definition valid_transition)
valid_transition == TRUE

\* key_not_expired (matches Coq: Definition key_not_expired)
key_not_expired(key, current_time) == TRUE

\* rotation_valid (matches Coq: Definition rotation_valid)
rotation_valid(rot) == TRUE

\* rotation_after_creation (matches Coq: Definition rotation_after_creation)
rotation_after_creation(key, rot) == TRUE

\* destruction_verified (matches Coq: Definition destruction_verified)
destruction_verified(dest) == TRUE

\* escrow_threshold_valid (matches Coq: Definition escrow_threshold_valid)
escrow_threshold_valid(share) == TRUE

\* escrow_share_index_valid (matches Coq: Definition escrow_share_index_valid)
escrow_share_index_valid(share) == TRUE

\* destruction_method_valid (matches Coq: Definition destruction_method_valid)
destruction_method_valid(dest) == TRUE

\* symmetric_key_size_ok (matches Coq: Definition symmetric_key_size_ok)
symmetric_key_size_ok == TRUE

\* asymmetric_key_size_ok (matches Coq: Definition asymmetric_key_size_ok)
asymmetric_key_size_ok == TRUE

\* purpose_matches (matches Coq: Definition purpose_matches)
purpose_matches == TRUE

\* lifetime_ok (matches Coq: Definition lifetime_ok)
lifetime_ok == TRUE

\* rotation_due (matches Coq: Definition rotation_due)
rotation_due == TRUE

\* derivation_depth_ok (matches Coq: Definition derivation_depth_ok)
derivation_depth_ok == TRUE

\* access_allowed (matches Coq: Definition access_allowed)
access_allowed == TRUE

\* hsm_stored (matches Coq: Definition hsm_stored)
hsm_stored(hsm_flag) == TRUE

\* audit_complete (matches Coq: Definition audit_complete)
audit_complete == TRUE

\* backup_encrypted (matches Coq: Definition backup_encrypted)
backup_encrypted(encryption_key) == TRUE

\* custodians_diverse (matches Coq: Definition custodians_diverse)
custodians_diverse(min_custodians) == TRUE

\* recovery_tested (matches Coq: Definition recovery_tested)
recovery_tested == TRUE

\* key_layers (matches Coq: Definition key_layers)
key_layers == TRUE

\* key_001_entropy_sufficient (matches Coq: Theorem key_001_entropy_sufficient)
THEOREM key_001_entropy_sufficient == Init => TypeOK

\* key_002_active_usable (matches Coq: Theorem key_002_active_usable)
THEOREM key_002_active_usable == Init => TypeOK

\* key_003_valid_transition (matches Coq: Theorem key_003_valid_transition)
THEOREM key_003_valid_transition == Init => TypeOK

\* key_004_destroyed_unusable (matches Coq: Theorem key_004_destroyed_unusable)
THEOREM key_004_destroyed_unusable == Init => TypeOK

\* key_005_compromised_unusable (matches Coq: Theorem key_005_compromised_unusable)
THEOREM key_005_compromised_unusable == Init => TypeOK

\* key_006_not_expired (matches Coq: Theorem key_006_not_expired)
THEOREM key_006_not_expired == Init => TypeOK

\* key_007_rotation_new (matches Coq: Theorem key_007_rotation_new)
THEOREM key_007_rotation_new == Init => TypeOK

\* key_008_rotation_timing (matches Coq: Theorem key_008_rotation_timing)
THEOREM key_008_rotation_timing == Init => TypeOK

\* key_009_destruction_verified (matches Coq: Theorem key_009_destruction_verified)
THEOREM key_009_destruction_verified == Init => TypeOK

\* key_010_escrow_threshold (matches Coq: Theorem key_010_escrow_threshold)
THEOREM key_010_escrow_threshold == Init => TypeOK

\* key_011_escrow_share_index (matches Coq: Theorem key_011_escrow_share_index)
THEOREM key_011_escrow_share_index == Init => TypeOK

\* key_012_destruction_method (matches Coq: Theorem key_012_destruction_method)
THEOREM key_012_destruction_method == Init => TypeOK

\* key_013_symmetric_size (matches Coq: Theorem key_013_symmetric_size)
THEOREM key_013_symmetric_size == Init => TypeOK

\* key_014_asymmetric_size (matches Coq: Theorem key_014_asymmetric_size)
THEOREM key_014_asymmetric_size == Init => TypeOK

\* key_015_purpose_bound (matches Coq: Theorem key_015_purpose_bound)
THEOREM key_015_purpose_bound == Init => TypeOK

\* key_016_lifetime (matches Coq: Theorem key_016_lifetime)
THEOREM key_016_lifetime == Init => TypeOK

\* key_017_rotation_due (matches Coq: Theorem key_017_rotation_due)
THEOREM key_017_rotation_due == Init => TypeOK

\* key_018_derivation_depth (matches Coq: Theorem key_018_derivation_depth)
THEOREM key_018_derivation_depth == Init => TypeOK

\* key_019_access_control (matches Coq: Theorem key_019_access_control)
THEOREM key_019_access_control == Init => TypeOK

\* key_020_hsm_storage (matches Coq: Theorem key_020_hsm_storage)
THEOREM key_020_hsm_storage == Init => TypeOK

\* key_021_audit_complete (matches Coq: Theorem key_021_audit_complete)
THEOREM key_021_audit_complete == Init => TypeOK

\* key_022_backup_encrypted (matches Coq: Theorem key_022_backup_encrypted)
THEOREM key_022_backup_encrypted == Init => TypeOK

\* key_023_custodian_diversity (matches Coq: Theorem key_023_custodian_diversity)
THEOREM key_023_custodian_diversity == Init => TypeOK

\* key_024_recovery_tested (matches Coq: Theorem key_024_recovery_tested)
THEOREM key_024_recovery_tested == Init => TypeOK

\* key_025_defense_in_depth (matches Coq: Theorem key_025_defense_in_depth)
THEOREM key_025_defense_in_depth == Init => TypeOK

\* Next-state relation
Next == UNCHANGED <<state>>

\* Specification
Spec == Init /\ [][Next]_<<state>>

====
