---- MODULE MalaysiaDigitalSignature ----
\* Copyright (c) 2026 The RIINA Authors. All rights reserved.
\* Auto-generated from 02_FORMAL/coq/domains/MalaysiaDigitalSignature.v (26 invariants)
\* Generated by scripts/generate-full-stack.py

EXTENDS Naturals, FiniteSets, Sequences

\* CertStatus (matches Coq: Inductive CertStatus)
CONSTANTS CertActive, CertSuspended, CertRevoked, CertExpired

\* CALicenseStatus (matches Coq: Inductive CALicenseStatus)
CONSTANTS CALicensed, CAUnlicensed

VARIABLES state

\* Type invariant
TypeOK ==
  /\ state \in BOOLEAN

\* Initial state
Init ==
  /\ state = TRUE

\* cert_valid (matches Coq: Definition cert_valid)
cert_valid(c, current_time) == TRUE

\* presumed_secure (matches Coq: Definition presumed_secure)
presumed_secure(c) == TRUE

\* signature_legally_valid (matches Coq: Definition signature_legally_valid)
signature_legally_valid(s, c, t) == TRUE

\* key_strength_adequate (matches Coq: Definition key_strength_adequate)
key_strength_adequate(c, min_bits) == TRUE

\* private_key_protected (matches Coq: Definition private_key_protected)
private_key_protected(key_encrypted, key_on_hsm) == TRUE

\* cert_status_active (matches Coq: Definition cert_status_active)
cert_status_active(c) == TRUE

\* cert_status_terminated (matches Coq: Definition cert_status_terminated)
cert_status_terminated(c) == TRUE

\* relying_party_diligent (matches Coq: Definition relying_party_diligent)
relying_party_diligent(rpc) == TRUE

\* cert_on_crl (matches Coq: Definition cert_on_crl)
cert_on_crl(cert_id) == TRUE

\* dsa_fully_compliant (matches Coq: Definition dsa_fully_compliant)
dsa_fully_compliant(c, s, t, key_enc, key_hsm) == TRUE

\* cert_validity (matches Coq: Theorem cert_validity)
THEOREM cert_validity == Init => TypeOK

\* suspended_invalid (matches Coq: Theorem suspended_invalid)
THEOREM suspended_invalid == Init => TypeOK

\* revoked_invalid (matches Coq: Theorem revoked_invalid)
THEOREM revoked_invalid == Init => TypeOK

\* expired_invalid (matches Coq: Theorem expired_invalid)
THEOREM expired_invalid == Init => TypeOK

\* licensed_ca_presumption (matches Coq: Theorem licensed_ca_presumption)
THEOREM licensed_ca_presumption == Init => TypeOK

\* unlicensed_no_presumption (matches Coq: Theorem unlicensed_no_presumption)
THEOREM unlicensed_no_presumption == Init => TypeOK

\* signature_verification (matches Coq: Theorem signature_verification)
THEOREM signature_verification == Init => TypeOK

\* key_strength_2048 (matches Coq: Theorem key_strength_2048)
THEOREM key_strength_2048 == Init => TypeOK

\* subscriber_duty_encrypted (matches Coq: Theorem subscriber_duty_encrypted)
THEOREM subscriber_duty_encrypted == Init => TypeOK

\* subscriber_duty_hsm (matches Coq: Theorem subscriber_duty_hsm)
THEOREM subscriber_duty_hsm == Init => TypeOK

\* active_not_terminated (matches Coq: Theorem active_not_terminated)
THEOREM active_not_terminated == Init => TypeOK

\* suspended_not_active (matches Coq: Theorem suspended_not_active)
THEOREM suspended_not_active == Init => TypeOK

\* cert_validity_window (matches Coq: Theorem cert_validity_window)
THEOREM cert_validity_window == Init => TypeOK

\* cert_valid_implies_not_expired (matches Coq: Theorem cert_valid_implies_not_expired)
THEOREM cert_valid_implies_not_expired == Init => TypeOK

\* cert_valid_implies_active (matches Coq: Theorem cert_valid_implies_active)
THEOREM cert_valid_implies_active == Init => TypeOK

\* cert_valid_implies_licensed (matches Coq: Theorem cert_valid_implies_licensed)
THEOREM cert_valid_implies_licensed == Init => TypeOK

\* key_strength_downward (matches Coq: Theorem key_strength_downward)
THEOREM key_strength_downward == Init => TypeOK

\* key_strength_4096_implies_2048 (matches Coq: Theorem key_strength_4096_implies_2048)
THEOREM key_strength_4096_implies_2048 == Init => TypeOK

\* relying_party_duty (matches Coq: Theorem relying_party_duty)
THEOREM relying_party_duty == Init => TypeOK

\* partial_check_not_diligent (matches Coq: Theorem partial_check_not_diligent)
THEOREM partial_check_not_diligent == Init => TypeOK

\* revoked_cert_on_crl (matches Coq: Theorem revoked_cert_on_crl)
THEOREM revoked_cert_on_crl == Init => TypeOK

\* crl_addition_preserves (matches Coq: Theorem crl_addition_preserves)
THEOREM crl_addition_preserves == Init => TypeOK

\* signature_timestamp_in_cert_validity (matches Coq: Theorem signature_timestamp_in_cert_validity)
THEOREM signature_timestamp_in_cert_validity == Init => TypeOK

\* dsa_composition (matches Coq: Theorem dsa_composition)
THEOREM dsa_composition == Init => TypeOK

\* cert_status_coverage (matches Coq: Theorem cert_status_coverage)
THEOREM cert_status_coverage == Init => TypeOK

\* ca_license_coverage (matches Coq: Theorem ca_license_coverage)
THEOREM ca_license_coverage == Init => TypeOK

\* Next-state relation
Next == UNCHANGED <<state>>

\* Specification
Spec == Init /\ [][Next]_<<state>>

====
