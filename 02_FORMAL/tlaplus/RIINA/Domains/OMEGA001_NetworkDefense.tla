---- MODULE OMEGA001_NetworkDefense ----
\* Copyright (c) 2026 The RIINA Authors. All rights reserved.
\* Auto-generated from 02_FORMAL/coq/domains/OMEGA001_NetworkDefense.v (30 invariants)
\* Generated by scripts/generate-full-stack.py

EXTENDS Naturals, FiniteSets, Sequences

\* ConnState (matches Coq: Inductive ConnState)
CONSTANTS ConnNew, ConnEstablished, ConnClosing, ConnClosed

\* TokenBucket (matches Coq: Record TokenBucket)
VARIABLES tb_tokens, tb_capacity, tb_refill_rate, tb_last_refill

\* NetCapability (matches Coq: Record NetCapability)
VARIABLES cap_id, cap_permissions, cap_expiry, cap_delegatable, cap_signature

\* SynCookie (matches Coq: Record SynCookie)
VARIABLES sc_client_ip, sc_client_port, sc_server_port, sc_timestamp, sc_mss_index

\* Connection (matches Coq: Record Connection)
VARIABLES conn_src, conn_dst, conn_state, conn_bytes_in, conn_bytes_out, conn_start_time

\* Type invariant
TypeOK ==
  /\ tb_tokens \in BOOLEAN
  /\ tb_capacity \in BOOLEAN
  /\ tb_refill_rate \in BOOLEAN
  /\ tb_last_refill \in BOOLEAN
  /\ cap_id \in BOOLEAN
  /\ cap_permissions \in BOOLEAN
  /\ cap_expiry \in BOOLEAN
  /\ cap_delegatable \in BOOLEAN
  /\ cap_signature \in BOOLEAN
  /\ sc_client_ip \in BOOLEAN
  /\ sc_client_port \in BOOLEAN
  /\ sc_server_port \in BOOLEAN
  /\ sc_timestamp \in BOOLEAN
  /\ sc_mss_index \in BOOLEAN
  /\ conn_src \in BOOLEAN
  /\ conn_dst \in BOOLEAN
  /\ conn_state \in BOOLEAN
  /\ conn_bytes_in \in BOOLEAN
  /\ conn_bytes_out \in BOOLEAN
  /\ conn_start_time \in BOOLEAN

\* Initial state
Init ==
  /\ tb_tokens = TRUE
  /\ tb_capacity = TRUE
  /\ tb_refill_rate = TRUE
  /\ tb_last_refill = TRUE
  /\ cap_id = TRUE
  /\ cap_permissions = TRUE
  /\ cap_expiry = TRUE
  /\ cap_delegatable = TRUE
  /\ cap_signature = TRUE
  /\ sc_client_ip = TRUE
  /\ sc_client_port = TRUE
  /\ sc_server_port = TRUE
  /\ sc_timestamp = TRUE
  /\ sc_mss_index = TRUE
  /\ conn_src = TRUE
  /\ conn_dst = TRUE
  /\ conn_state = TRUE
  /\ conn_bytes_in = TRUE
  /\ conn_bytes_out = TRUE
  /\ conn_start_time = TRUE

\* tb_refill (matches Coq: Definition tb_refill)
tb_refill(tb, now) == TRUE

\* tb_available (matches Coq: Definition tb_available)
tb_available(tb) == TRUE

\* cap_valid (matches Coq: Definition cap_valid)
cap_valid(cap, now) == TRUE

\* cap_permits (matches Coq: Definition cap_permits)
cap_permits(cap, port) == TRUE

\* cap_is_subset (matches Coq: Definition cap_is_subset)
cap_is_subset == TRUE

\* hmac_compute (matches Coq: Definition hmac_compute)
hmac_compute(key, data) == TRUE

\* syn_cookie_generate (matches Coq: Definition syn_cookie_generate)
syn_cookie_generate(secret, cookie) == TRUE

\* syn_cookie_verify (matches Coq: Definition syn_cookie_verify)
syn_cookie_verify(secret, cookie, mac) == TRUE

\* pow_hash (matches Coq: Definition pow_hash)
pow_hash == TRUE

\* pow_valid (matches Coq: Definition pow_valid)
pow_valid == TRUE

\* pow_verify (matches Coq: Definition pow_verify)
pow_verify == TRUE

\* conn_count_by_src (matches Coq: Definition conn_count_by_src)
conn_count_by_src(table, src) == TRUE

\* conn_limit_per_src (matches Coq: Definition conn_limit_per_src)
conn_limit_per_src == TRUE

\* conn_allowed (matches Coq: Definition conn_allowed)
conn_allowed(table, src) == TRUE

\* OMEGA_001_01_tb_capacity_bound (matches Coq: Theorem OMEGA_001_01_tb_capacity_bound)
THEOREM OMEGA_001_01_tb_capacity_bound == Init => TypeOK

\* OMEGA_001_02_tb_consume_decreases (matches Coq: Theorem OMEGA_001_02_tb_consume_decreases)
THEOREM OMEGA_001_02_tb_consume_decreases == Init => TypeOK

\* OMEGA_001_03_tb_consume_fails_insufficient (matches Coq: Theorem OMEGA_001_03_tb_consume_fails_insufficient)
THEOREM OMEGA_001_03_tb_consume_fails_insufficient == Init => TypeOK

\* OMEGA_001_04_tb_refill_monotone (matches Coq: Theorem OMEGA_001_04_tb_refill_monotone)
THEOREM OMEGA_001_04_tb_refill_monotone == Init => TypeOK

\* OMEGA_001_05_tb_consume_preserves_capacity (matches Coq: Theorem OMEGA_001_05_tb_consume_preserves_capacity)
THEOREM OMEGA_001_05_tb_consume_preserves_capacity == Init => TypeOK

\* OMEGA_001_06_tb_zero_cost_always_succeeds (matches Coq: Theorem OMEGA_001_06_tb_zero_cost_always_succeeds)
THEOREM OMEGA_001_06_tb_zero_cost_always_succeeds == Init => TypeOK

\* OMEGA_001_07_tb_refill_preserves_capacity (matches Coq: Theorem OMEGA_001_07_tb_refill_preserves_capacity)
THEOREM OMEGA_001_07_tb_refill_preserves_capacity == Init => TypeOK

\* OMEGA_001_08_tb_available_bound (matches Coq: Theorem OMEGA_001_08_tb_available_bound)
THEOREM OMEGA_001_08_tb_available_bound == Init => TypeOK

\* OMEGA_002_01_expired_cap_invalid (matches Coq: Theorem OMEGA_002_01_expired_cap_invalid)
THEOREM OMEGA_002_01_expired_cap_invalid == Init => TypeOK

\* OMEGA_002_02_cap_subset_reflexive (matches Coq: Theorem OMEGA_002_02_cap_subset_reflexive)
THEOREM OMEGA_002_02_cap_subset_reflexive == Init => TypeOK

\* OMEGA_002_03_delegation_attenuation (matches Coq: Theorem OMEGA_002_03_delegation_attenuation)
THEOREM OMEGA_002_03_delegation_attenuation == Init => TypeOK

\* OMEGA_002_04_delegation_permission_subset (matches Coq: Theorem OMEGA_002_04_delegation_permission_subset)
THEOREM OMEGA_002_04_delegation_permission_subset == Init => TypeOK

\* OMEGA_002_05_nondelegatable_blocks (matches Coq: Theorem OMEGA_002_05_nondelegatable_blocks)
THEOREM OMEGA_002_05_nondelegatable_blocks == Init => TypeOK

\* OMEGA_002_06_empty_cap_permits_nothing (matches Coq: Theorem OMEGA_002_06_empty_cap_permits_nothing)
THEOREM OMEGA_002_06_empty_cap_permits_nothing == Init => TypeOK

\* OMEGA_002_07_cap_permits_sound (matches Coq: Theorem OMEGA_002_07_cap_permits_sound)
THEOREM OMEGA_002_07_cap_permits_sound == Init => TypeOK

\* OMEGA_003_01_syn_cookie_verify_sound (matches Coq: Theorem OMEGA_003_01_syn_cookie_verify_sound)
THEOREM OMEGA_003_01_syn_cookie_verify_sound == Init => TypeOK

\* OMEGA_003_02_syn_cookie_wrong_secret (matches Coq: Theorem OMEGA_003_02_syn_cookie_wrong_secret)
THEOREM OMEGA_003_02_syn_cookie_wrong_secret == Init => TypeOK

\* OMEGA_003_03_syn_cookie_deterministic (matches Coq: Theorem OMEGA_003_03_syn_cookie_deterministic)
THEOREM OMEGA_003_03_syn_cookie_deterministic == Init => TypeOK

\* OMEGA_003_04_syn_cookie_stateless (matches Coq: Theorem OMEGA_003_04_syn_cookie_stateless)
THEOREM OMEGA_003_04_syn_cookie_stateless == Init => TypeOK

\* OMEGA_003_05_syn_cookie_ip_sensitive (matches Coq: Theorem OMEGA_003_05_syn_cookie_ip_sensitive)
THEOREM OMEGA_003_05_syn_cookie_ip_sensitive == Init => TypeOK

\* OMEGA_003_06_wrong_mac_rejected (matches Coq: Theorem OMEGA_003_06_wrong_mac_rejected)
THEOREM OMEGA_003_06_wrong_mac_rejected == Init => TypeOK

\* OMEGA_004_01_empty_table_allows (matches Coq: Theorem OMEGA_004_01_empty_table_allows)
THEOREM OMEGA_004_01_empty_table_allows == Init => TypeOK

\* OMEGA_004_02_conn_count_nonneg (matches Coq: Theorem OMEGA_004_02_conn_count_nonneg)
THEOREM OMEGA_004_02_conn_count_nonneg == Init => TypeOK

\* OMEGA_004_03_conn_count_bound (matches Coq: Theorem OMEGA_004_03_conn_count_bound)
THEOREM OMEGA_004_03_conn_count_bound == Init => TypeOK

\* OMEGA_004_04_conn_lookup_deterministic (matches Coq: Theorem OMEGA_004_04_conn_lookup_deterministic)
THEOREM OMEGA_004_04_conn_lookup_deterministic == Init => TypeOK

\* OMEGA_004_05_pow_verify_sound (matches Coq: Theorem OMEGA_004_05_pow_verify_sound)
THEOREM OMEGA_004_05_pow_verify_sound == Init => TypeOK

\* OMEGA_005_01_pow_deterministic (matches Coq: Theorem OMEGA_005_01_pow_deterministic)
THEOREM OMEGA_005_01_pow_deterministic == Init => TypeOK

\* OMEGA_005_02_pow_zero_difficulty_impossible (matches Coq: Theorem OMEGA_005_02_pow_zero_difficulty_impossible)
THEOREM OMEGA_005_02_pow_zero_difficulty_impossible == Init => TypeOK

\* OMEGA_005_03_pow_verify_complete (matches Coq: Theorem OMEGA_005_03_pow_verify_complete)
THEOREM OMEGA_005_03_pow_verify_complete == Init => TypeOK

\* OMEGA_005_04_pow_hash_deterministic (matches Coq: Theorem OMEGA_005_04_pow_hash_deterministic)
THEOREM OMEGA_005_04_pow_hash_deterministic == Init => TypeOK

\* Next-state relation
Next == UNCHANGED <<tb_tokens, tb_capacity, tb_refill_rate, tb_last_refill, cap_id, cap_permissions, cap_expiry, cap_delegatable, cap_signature, sc_client_ip, sc_client_port, sc_server_port, sc_timestamp, sc_mss_index, conn_src, conn_dst, conn_state, conn_bytes_in, conn_bytes_out, conn_start_time>>

\* Specification
Spec == Init /\ [][Next]_<<tb_tokens, tb_capacity, tb_refill_rate, tb_last_refill, cap_id, cap_permissions, cap_expiry, cap_delegatable, cap_signature, sc_client_ip, sc_client_port, sc_server_port, sc_timestamp, sc_mss_index, conn_src, conn_dst, conn_state, conn_bytes_in, conn_bytes_out, conn_start_time>>

====
