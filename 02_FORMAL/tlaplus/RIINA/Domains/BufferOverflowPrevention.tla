---- MODULE BufferOverflowPrevention ----
\* SPDX-License-Identifier: MPL-2.0
\* Copyright (c) 2026 The RIINA Authors.
\* Auto-generated from 02_FORMAL/coq/domains/BufferOverflowPrevention.v (22 invariants)
\* Generated by scripts/generate-full-stack.py

EXTENDS Naturals, FiniteSets, Sequences

\* Buffer (matches Coq: Record Buffer)
VARIABLES buf_size, buf_used

\* OverflowPrevention (matches Coq: Record OverflowPrevention)
VARIABLES op_bounds_check_write, op_bounds_check_read, op_null_terminator_check, op_integer_overflow_check, op_stack_canaries

\* Type invariant
TypeOK ==
  /\ buf_size \in BOOLEAN
  /\ buf_used \in BOOLEAN
  /\ op_bounds_check_write \in BOOLEAN
  /\ op_bounds_check_read \in BOOLEAN
  /\ op_null_terminator_check \in BOOLEAN
  /\ op_integer_overflow_check \in BOOLEAN
  /\ op_stack_canaries \in BOOLEAN

\* Initial state
Init ==
  /\ buf_size = TRUE
  /\ buf_used = TRUE
  /\ op_bounds_check_write = TRUE
  /\ op_bounds_check_read = TRUE
  /\ op_null_terminator_check = TRUE
  /\ op_integer_overflow_check = TRUE
  /\ op_stack_canaries = TRUE

\* buffer_valid (matches Coq: Definition buffer_valid)
buffer_valid(b) == TRUE

\* buffer_can_write (matches Coq: Definition buffer_can_write)
buffer_can_write(b, n) == TRUE

\* buffer_can_read (matches Coq: Definition buffer_can_read)
buffer_can_read(b) == TRUE

\* overflow_protected (matches Coq: Definition overflow_protected)
overflow_protected(p) == TRUE

\* riina_overflow_config (matches Coq: Definition riina_overflow_config)
riina_overflow_config == TRUE

\* test_buffer (matches Coq: Definition test_buffer)
test_buffer == TRUE

\* andb_true_iff (matches Coq: Lemma andb_true_iff)
THEOREM andb_true_iff == Init => TypeOK

\* BOF_001_test_buffer_valid (matches Coq: Theorem BOF_001_test_buffer_valid)
THEOREM BOF_001_test_buffer_valid == Init => TypeOK

\* BOF_002_can_write_bounds (matches Coq: Theorem BOF_002_can_write_bounds)
THEOREM BOF_002_can_write_bounds == Init => TypeOK

\* BOF_003_cannot_write_beyond (matches Coq: Theorem BOF_003_cannot_write_beyond)
THEOREM BOF_003_cannot_write_beyond == Init => TypeOK

\* BOF_004_can_read_used (matches Coq: Theorem BOF_004_can_read_used)
THEOREM BOF_004_can_read_used == Init => TypeOK

\* BOF_005_cannot_read_beyond (matches Coq: Theorem BOF_005_cannot_read_beyond)
THEOREM BOF_005_cannot_read_beyond == Init => TypeOK

\* BOF_006_riina_protected (matches Coq: Theorem BOF_006_riina_protected)
THEOREM BOF_006_riina_protected == Init => TypeOK

\* BOF_007_bounds_check_write (matches Coq: Theorem BOF_007_bounds_check_write)
THEOREM BOF_007_bounds_check_write == Init => TypeOK

\* BOF_008_bounds_check_read (matches Coq: Theorem BOF_008_bounds_check_read)
THEOREM BOF_008_bounds_check_read == Init => TypeOK

\* BOF_009_integer_overflow (matches Coq: Theorem BOF_009_integer_overflow)
THEOREM BOF_009_integer_overflow == Init => TypeOK

\* BOF_010_stack_canaries (matches Coq: Theorem BOF_010_stack_canaries)
THEOREM BOF_010_stack_canaries == Init => TypeOK

\* BOF_011_valid_implies_bounds (matches Coq: Theorem BOF_011_valid_implies_bounds)
THEOREM BOF_011_valid_implies_bounds == Init => TypeOK

\* BOF_012_riina_bounds_write (matches Coq: Theorem BOF_012_riina_bounds_write)
THEOREM BOF_012_riina_bounds_write == Init => TypeOK

\* BOF_013_riina_canaries (matches Coq: Theorem BOF_013_riina_canaries)
THEOREM BOF_013_riina_canaries == Init => TypeOK

\* BOF_014_zero_write_safe (matches Coq: Theorem BOF_014_zero_write_safe)
THEOREM BOF_014_zero_write_safe == Init => TypeOK

\* BOF_015_complete_prevention (matches Coq: Theorem BOF_015_complete_prevention)
THEOREM BOF_015_complete_prevention == Init => TypeOK

\* BOF_016_write_bounded (matches Coq: Theorem BOF_016_write_bounded)
THEOREM BOF_016_write_bounded == Init => TypeOK

\* BOF_017_read_start_within (matches Coq: Theorem BOF_017_read_start_within)
THEOREM BOF_017_read_start_within == Init => TypeOK

\* BOF_018_zero_read_safe (matches Coq: Theorem BOF_018_zero_read_safe)
THEOREM BOF_018_zero_read_safe == Init => TypeOK

\* BOF_019_full_buffer_no_write (matches Coq: Theorem BOF_019_full_buffer_no_write)
THEOREM BOF_019_full_buffer_no_write == Init => TypeOK

\* BOF_020_null_terminator_check (matches Coq: Theorem BOF_020_null_terminator_check)
THEOREM BOF_020_null_terminator_check == Init => TypeOK

\* BOF_021_valid_after_write (matches Coq: Theorem BOF_021_valid_after_write)
THEOREM BOF_021_valid_after_write == Init => TypeOK

\* Next-state relation
Next == UNCHANGED <<buf_size, buf_used, op_bounds_check_write, op_bounds_check_read, op_null_terminator_check, op_integer_overflow_check, op_stack_canaries>>

\* Specification
Spec == Init /\ [][Next]_<<buf_size, buf_used, op_bounds_check_write, op_bounds_check_read, op_null_terminator_check, op_integer_overflow_check, op_stack_canaries>>

====
