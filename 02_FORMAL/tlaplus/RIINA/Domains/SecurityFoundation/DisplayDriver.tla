---- MODULE DisplayDriver ----
\* Copyright (c) 2026 The RIINA Authors. All rights reserved.
\* Auto-generated from 02_FORMAL/coq/domains/security_foundation/DisplayDriver.v (23 invariants)
\* Generated by scripts/generate-full-stack.py

EXTENDS Naturals, FiniteSets, Sequences

\* AppId (matches Coq: Inductive AppId)
CONSTANTS App

\* FrameBufferId (matches Coq: Inductive FrameBufferId)
CONSTANTS FBId

\* Application (matches Coq: Record Application)
VARIABLES app_id, app_screen_capture_perm, app_overlay_perm

\* FrameBuffer (matches Coq: Record FrameBuffer)
VARIABLES fb_id, fb_owner, fb_width, fb_height, fb_protected

\* Frame (matches Coq: Record Frame)
VARIABLES frame_id, frame_timestamp, frame_source

\* DisplayState (matches Coq: Record DisplayState)
VARIABLES frame_buffers, active_overlay

\* Type invariant
TypeOK ==
  /\ app_id \in BOOLEAN
  /\ app_screen_capture_perm \in BOOLEAN
  /\ app_overlay_perm \in BOOLEAN
  /\ fb_id \in BOOLEAN
  /\ fb_owner \in BOOLEAN
  /\ fb_width \in BOOLEAN
  /\ fb_height \in BOOLEAN
  /\ fb_protected \in BOOLEAN
  /\ frame_id \in BOOLEAN
  /\ frame_timestamp \in BOOLEAN
  /\ frame_source \in BOOLEAN
  /\ frame_buffers \in BOOLEAN
  /\ active_overlay \in BOOLEAN

\* Initial state
Init ==
  /\ app_id = TRUE
  /\ app_screen_capture_perm = TRUE
  /\ app_overlay_perm = TRUE
  /\ fb_id = TRUE
  /\ fb_owner = TRUE
  /\ fb_width = TRUE
  /\ fb_height = TRUE
  /\ fb_protected = TRUE
  /\ frame_id = TRUE
  /\ frame_timestamp = TRUE
  /\ frame_source = TRUE
  /\ frame_buffers = TRUE
  /\ active_overlay = TRUE

\* owns_buffer (matches Coq: Definition owns_buffer)
owns_buffer(app, fb) == TRUE

\* has_screen_capture_permission (matches Coq: Definition has_screen_capture_permission)
has_screen_capture_permission(app) == TRUE

\* has_overlay_permission (matches Coq: Definition has_overlay_permission)
has_overlay_permission(app) == TRUE

\* valid_framebuffer (matches Coq: Definition valid_framebuffer)
valid_framebuffer(fb) == TRUE

\* pixel_count (matches Coq: Definition pixel_count)
pixel_count(fb) == TRUE

\* display_buffer_isolated (matches Coq: Theorem display_buffer_isolated)
THEOREM display_buffer_isolated == Init => TypeOK

\* screen_capture_requires_permission (matches Coq: Theorem screen_capture_requires_permission)
THEOREM screen_capture_requires_permission == Init => TypeOK

\* protected_buffer_access (matches Coq: Theorem protected_buffer_access)
THEOREM protected_buffer_access == Init => TypeOK

\* no_permission_no_capture (matches Coq: Theorem no_permission_no_capture)
THEOREM no_permission_no_capture == Init => TypeOK

\* buffer_ownership_exclusive (matches Coq: Theorem buffer_ownership_exclusive)
THEOREM buffer_ownership_exclusive == Init => TypeOK

\* overlay_requires_permission (matches Coq: Theorem overlay_requires_permission)
THEOREM overlay_requires_permission == Init => TypeOK

\* no_overlay_without_permission (matches Coq: Theorem no_overlay_without_permission)
THEOREM no_overlay_without_permission == Init => TypeOK

\* display_output_integrity (matches Coq: Theorem display_output_integrity)
THEOREM display_output_integrity == Init => TypeOK

\* valid_fb_positive_pixels (matches Coq: Theorem valid_fb_positive_pixels)
THEOREM valid_fb_positive_pixels == Init => TypeOK

\* no_capture_perm_blocks_all_frames (matches Coq: Theorem no_capture_perm_blocks_all_frames)
THEOREM no_capture_perm_blocks_all_frames == Init => TypeOK

\* protected_buffer_blocks_non_owner (matches Coq: Theorem protected_buffer_blocks_non_owner)
THEOREM protected_buffer_blocks_non_owner == Init => TypeOK

\* read_requires_ownership_or_capture (matches Coq: Theorem read_requires_ownership_or_capture)
THEOREM read_requires_ownership_or_capture == Init => TypeOK

\* capture_perm_reads_all (matches Coq: Theorem capture_perm_reads_all)
THEOREM capture_perm_reads_all == Init => TypeOK

\* owner_reads_unprotected (matches Coq: Theorem owner_reads_unprotected)
THEOREM owner_reads_unprotected == Init => TypeOK

\* overlay_state_consistent (matches Coq: Theorem overlay_state_consistent)
THEOREM overlay_state_consistent == Init => TypeOK

\* no_overlay_no_app (matches Coq: Theorem no_overlay_no_app)
THEOREM no_overlay_no_app == Init => TypeOK

\* fb_id_determines_buffer (matches Coq: Theorem fb_id_determines_buffer)
THEOREM fb_id_determines_buffer == Init => TypeOK

\* display_isolation_symmetric (matches Coq: Theorem display_isolation_symmetric)
THEOREM display_isolation_symmetric == Init => TypeOK

\* capture_overlay_independent (matches Coq: Theorem capture_overlay_independent)
THEOREM capture_overlay_independent == Init => TypeOK

\* dual_perm_app (matches Coq: Theorem dual_perm_app)
THEOREM dual_perm_app == Init => TypeOK

\* no_perm_app (matches Coq: Theorem no_perm_app)
THEOREM no_perm_app == Init => TypeOK

\* empty_display_no_read (matches Coq: Theorem empty_display_no_read)
THEOREM empty_display_no_read == Init => TypeOK

\* frame_timestamp_order (matches Coq: Theorem frame_timestamp_order)
THEOREM frame_timestamp_order == Init => TypeOK

\* Next-state relation
Next == UNCHANGED <<app_id, app_screen_capture_perm, app_overlay_perm, fb_id, fb_owner, fb_width, fb_height, fb_protected, frame_id, frame_timestamp, frame_source, frame_buffers, active_overlay>>

\* Specification
Spec == Init /\ [][Next]_<<app_id, app_screen_capture_perm, app_overlay_perm, fb_id, fb_owner, fb_width, fb_height, fb_protected, frame_id, frame_timestamp, frame_source, frame_buffers, active_overlay>>

====
