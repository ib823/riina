---- MODULE HardwareRootOfTrust ----
\* Copyright (c) 2026 The RIINA Authors. All rights reserved.
\* Auto-generated from 02_FORMAL/coq/domains/security_foundation/HardwareRootOfTrust.v (21 invariants)
\* Generated by scripts/generate-full-stack.py

EXTENDS Naturals, FiniteSets, Sequences

\* HSMType (matches Coq: Inductive HSMType)
CONSTANTS TPM, SecureEnclave, TitanM, AppleSEP, RootKey, AttestationKey, SealingKey, SigningKey

\* BootComponentId (matches Coq: Inductive BootComponentId)
CONSTANTS BootComp

\* Measurement (matches Coq: Record Measurement)
VARIABLES measured_component, measurement_value, measurement_algorithm

\* TrustChainEntry (matches Coq: Record TrustChainEntry)
VARIABLES entry_component, entry_verified_by, entry_measurement, entry_trusted

\* HWRootState (matches Coq: Record HWRootState)
VARIABLES hsm_type, root_key_present, attestation_key_present, trust_chain, pcr_values, hardware_initialized

\* Type invariant
TypeOK ==
  /\ measured_component \in BOOLEAN
  /\ measurement_value \in BOOLEAN
  /\ measurement_algorithm \in BOOLEAN
  /\ entry_component \in BOOLEAN
  /\ entry_verified_by \in BOOLEAN
  /\ entry_measurement \in BOOLEAN
  /\ entry_trusted \in BOOLEAN
  /\ hsm_type \in BOOLEAN
  /\ root_key_present \in BOOLEAN
  /\ attestation_key_present \in BOOLEAN
  /\ trust_chain \in BOOLEAN
  /\ pcr_values \in BOOLEAN
  /\ hardware_initialized \in BOOLEAN

\* Initial state
Init ==
  /\ measured_component = TRUE
  /\ measurement_value = TRUE
  /\ measurement_algorithm = TRUE
  /\ entry_component = TRUE
  /\ entry_verified_by = TRUE
  /\ entry_measurement = TRUE
  /\ entry_trusted = TRUE
  /\ hsm_type = TRUE
  /\ root_key_present = TRUE
  /\ attestation_key_present = TRUE
  /\ trust_chain = TRUE
  /\ pcr_values = TRUE
  /\ hardware_initialized = TRUE

\* hw_root_component (matches Coq: Definition hw_root_component)
hw_root_component == TRUE

\* initial_hw_state (matches Coq: Definition initial_hw_state)
initial_hw_state(hsm) == TRUE

\* in_trust_chain (matches Coq: Definition in_trust_chain)
in_trust_chain(st, comp) == TRUE

\* verified_from_hw_root (matches Coq: Definition verified_from_hw_root)
verified_from_hw_root(st, comp) == TRUE

\* extend_trust_chain (matches Coq: Definition extend_trust_chain)
extend_trust_chain(st, measurement) == TRUE

\* record_pcr (matches Coq: Definition record_pcr)
record_pcr(st, comp, value, algo) == TRUE

\* component_trusted (matches Coq: Definition component_trusted)
component_trusted(st, comp) == TRUE

\* hw_root_verified (matches Coq: Definition hw_root_verified)
hw_root_verified(st, comp) == TRUE

\* root_key_protected (matches Coq: Definition root_key_protected)
root_key_protected(st) == TRUE

\* root_of_trust_hardware (matches Coq: Theorem root_of_trust_hardware)
THEOREM root_of_trust_hardware == Init => TypeOK

\* trust_extension_preserves_root (matches Coq: Theorem trust_extension_preserves_root)
THEOREM trust_extension_preserves_root == Init => TypeOK

\* extended_component_trusted (matches Coq: Theorem extended_component_trusted)
THEOREM extended_component_trusted == Init => TypeOK

\* untrusted_cannot_extend (matches Coq: Theorem untrusted_cannot_extend)
THEOREM untrusted_cannot_extend == Init => TypeOK

\* root_key_is_protected (matches Coq: Theorem root_key_is_protected)
THEOREM root_key_is_protected == Init => TypeOK

\* pcr_record_preserved (matches Coq: Theorem pcr_record_preserved)
THEOREM pcr_record_preserved == Init => TypeOK

\* hw_root_always_trusted (matches Coq: Theorem hw_root_always_trusted)
THEOREM hw_root_always_trusted == Init => TypeOK

\* attestation_key_present_initial (matches Coq: Theorem attestation_key_present_initial)
THEOREM attestation_key_present_initial == Init => TypeOK

\* hardware_initialized_initial (matches Coq: Theorem hardware_initialized_initial)
THEOREM hardware_initialized_initial == Init => TypeOK

\* trust_extension_preserves_attestation (matches Coq: Theorem trust_extension_preserves_attestation)
THEOREM trust_extension_preserves_attestation == Init => TypeOK

\* trust_extension_preserves_root_key (matches Coq: Theorem trust_extension_preserves_root_key)
THEOREM trust_extension_preserves_root_key == Init => TypeOK

\* trust_extension_preserves_init (matches Coq: Theorem trust_extension_preserves_init)
THEOREM trust_extension_preserves_init == Init => TypeOK

\* pcr_preserves_trust_chain (matches Coq: Theorem pcr_preserves_trust_chain)
THEOREM pcr_preserves_trust_chain == Init => TypeOK

\* pcr_preserves_root_key (matches Coq: Theorem pcr_preserves_root_key)
THEOREM pcr_preserves_root_key == Init => TypeOK

\* pcr_values_grow (matches Coq: Theorem pcr_values_grow)
THEOREM pcr_values_grow == Init => TypeOK

\* trust_chain_grows (matches Coq: Theorem trust_chain_grows)
THEOREM trust_chain_grows == Init => TypeOK

\* extended_chain_has_component (matches Coq: Theorem extended_chain_has_component)
THEOREM extended_chain_has_component == Init => TypeOK

\* hsm_type_invariant_extend (matches Coq: Theorem hsm_type_invariant_extend)
THEOREM hsm_type_invariant_extend == Init => TypeOK

\* hsm_type_invariant_pcr (matches Coq: Theorem hsm_type_invariant_pcr)
THEOREM hsm_type_invariant_pcr == Init => TypeOK

\* root_key_protection_preserved (matches Coq: Theorem root_key_protection_preserved)
THEOREM root_key_protection_preserved == Init => TypeOK

\* root_key_protection_preserved_pcr (matches Coq: Theorem root_key_protection_preserved_pcr)
THEOREM root_key_protection_preserved_pcr == Init => TypeOK

\* Next-state relation
Next == UNCHANGED <<measured_component, measurement_value, measurement_algorithm, entry_component, entry_verified_by, entry_measurement, entry_trusted, hsm_type, root_key_present, attestation_key_present, trust_chain, pcr_values, hardware_initialized>>

\* Specification
Spec == Init /\ [][Next]_<<measured_component, measurement_value, measurement_algorithm, entry_component, entry_verified_by, entry_measurement, entry_trusted, hsm_type, root_key_present, attestation_key_present, trust_chain, pcr_values, hardware_initialized>>

====
