---- MODULE SensorDrivers ----
\* SPDX-License-Identifier: MPL-2.0
\* Copyright (c) 2026 The RIINA Authors.
\* Auto-generated from 02_FORMAL/coq/domains/security_foundation/SensorDrivers.v (22 invariants)
\* Generated by scripts/generate-full-stack.py

EXTENDS Naturals, FiniteSets, Sequences

\* AppId (matches Coq: Inductive AppId)
CONSTANTS App

\* SensorType (matches Coq: Inductive SensorType)
CONSTANTS Camera, Microphone, GPS, Accelerometer, Gyroscope

\* Sensor (matches Coq: Record Sensor)
VARIABLES sensor_type, sensor_id

\* Application (matches Coq: Record Application)
VARIABLES app_id, app_camera_perm, app_microphone_perm, app_location_perm, app_motion_perm

\* SystemState (matches Coq: Record SystemState)
VARIABLES camera_indicator, mic_indicator, any_camera_active, any_mic_active

\* SensorRateLimit (matches Coq: Record SensorRateLimit)
VARIABLES rate_sensor_type, rate_max_reads_per_sec, rate_current_reads

\* BoundedSensor (matches Coq: Record BoundedSensor)
VARIABLES bs_sensor, bs_max_rate, bs_current_rate, bs_rate_ok

\* Type invariant
TypeOK ==
  /\ sensor_type \in BOOLEAN
  /\ sensor_id \in BOOLEAN
  /\ app_id \in BOOLEAN
  /\ app_camera_perm \in BOOLEAN
  /\ app_microphone_perm \in BOOLEAN
  /\ app_location_perm \in BOOLEAN
  /\ app_motion_perm \in BOOLEAN
  /\ camera_indicator \in BOOLEAN
  /\ mic_indicator \in BOOLEAN
  /\ any_camera_active \in BOOLEAN
  /\ any_mic_active \in BOOLEAN
  /\ rate_sensor_type \in BOOLEAN
  /\ rate_max_reads_per_sec \in BOOLEAN
  /\ rate_current_reads \in BOOLEAN
  /\ bs_sensor \in BOOLEAN
  /\ bs_max_rate \in BOOLEAN
  /\ bs_current_rate \in BOOLEAN
  /\ bs_rate_ok \in BOOLEAN

\* Initial state
Init ==
  /\ sensor_type = TRUE
  /\ sensor_id = TRUE
  /\ app_id = TRUE
  /\ app_camera_perm = TRUE
  /\ app_microphone_perm = TRUE
  /\ app_location_perm = TRUE
  /\ app_motion_perm = TRUE
  /\ camera_indicator = TRUE
  /\ mic_indicator = TRUE
  /\ any_camera_active = TRUE
  /\ any_mic_active = TRUE
  /\ rate_sensor_type = TRUE
  /\ rate_max_reads_per_sec = TRUE
  /\ rate_current_reads = TRUE
  /\ bs_sensor = TRUE
  /\ bs_max_rate = TRUE
  /\ bs_current_rate = TRUE
  /\ bs_rate_ok = TRUE

\* has_sensor_permission (matches Coq: Definition has_sensor_permission)
has_sensor_permission(app, sensor) == TRUE

\* uses_camera (matches Coq: Definition uses_camera)
uses_camera(app) == TRUE

\* uses_microphone (matches Coq: Definition uses_microphone)
uses_microphone(app) == TRUE

\* indicator_visible (matches Coq: Definition indicator_visible)
indicator_visible(st) == TRUE

\* rate_limit_ok (matches Coq: Definition rate_limit_ok)
rate_limit_ok(rl) == TRUE

\* rate_limit_exceeded (matches Coq: Definition rate_limit_exceeded)
rate_limit_exceeded(rl) == TRUE

\* sensor_access_controlled (matches Coq: Theorem sensor_access_controlled)
THEOREM sensor_access_controlled == Init => TypeOK

\* recording_indicator_mandatory (matches Coq: Theorem recording_indicator_mandatory)
THEOREM recording_indicator_mandatory == Init => TypeOK

\* no_permission_no_sensor (matches Coq: Theorem no_permission_no_sensor)
THEOREM no_permission_no_sensor == Init => TypeOK

\* camera_requires_camera_perm (matches Coq: Theorem camera_requires_camera_perm)
THEOREM camera_requires_camera_perm == Init => TypeOK

\* gps_requires_location_perm (matches Coq: Theorem gps_requires_location_perm)
THEOREM gps_requires_location_perm == Init => TypeOK

\* rate_limit_blocks_excess (matches Coq: Theorem rate_limit_blocks_excess)
THEOREM rate_limit_blocks_excess == Init => TypeOK

\* microphone_requires_mic_perm (matches Coq: Theorem microphone_requires_mic_perm)
THEOREM microphone_requires_mic_perm == Init => TypeOK

\* accelerometer_requires_motion_perm (matches Coq: Theorem accelerometer_requires_motion_perm)
THEOREM accelerometer_requires_motion_perm == Init => TypeOK

\* gyroscope_requires_motion_perm (matches Coq: Theorem gyroscope_requires_motion_perm)
THEOREM gyroscope_requires_motion_perm == Init => TypeOK

\* no_permissions_no_sensors (matches Coq: Theorem no_permissions_no_sensors)
THEOREM no_permissions_no_sensors == Init => TypeOK

\* indicators_independent (matches Coq: Theorem indicators_independent)
THEOREM indicators_independent == Init => TypeOK

\* mic_indicator_when_active (matches Coq: Theorem mic_indicator_when_active)
THEOREM mic_indicator_when_active == Init => TypeOK

\* cam_indicator_when_active (matches Coq: Theorem cam_indicator_when_active)
THEOREM cam_indicator_when_active == Init => TypeOK

\* both_sensors_both_indicators (matches Coq: Theorem both_sensors_both_indicators)
THEOREM both_sensors_both_indicators == Init => TypeOK

\* no_active_no_indicator_required (matches Coq: Theorem no_active_no_indicator_required)
THEOREM no_active_no_indicator_required == Init => TypeOK

\* sensor_perm_type_specific (matches Coq: Theorem sensor_perm_type_specific)
THEOREM sensor_perm_type_specific == Init => TypeOK

\* camera_perm_not_mic (matches Coq: Theorem camera_perm_not_mic)
THEOREM camera_perm_not_mic == Init => TypeOK

\* motion_perm_covers_both (matches Coq: Theorem motion_perm_covers_both)
THEOREM motion_perm_covers_both == Init => TypeOK

\* sensor_reading_valid (matches Coq: Theorem sensor_reading_valid)
THEOREM sensor_reading_valid == Init => TypeOK

\* bounded_sensor_rate_valid (matches Coq: Theorem bounded_sensor_rate_valid)
THEOREM bounded_sensor_rate_valid == Init => TypeOK

\* revoke_all_blocks_all_types (matches Coq: Theorem revoke_all_blocks_all_types)
THEOREM revoke_all_blocks_all_types == Init => TypeOK

\* gps_independent_of_camera (matches Coq: Theorem gps_independent_of_camera)
THEOREM gps_independent_of_camera == Init => TypeOK

\* Next-state relation
Next == UNCHANGED <<sensor_type, sensor_id, app_id, app_camera_perm, app_microphone_perm, app_location_perm, app_motion_perm, camera_indicator, mic_indicator, any_camera_active, any_mic_active, rate_sensor_type, rate_max_reads_per_sec, rate_current_reads, bs_sensor, bs_max_rate, bs_current_rate, bs_rate_ok>>

\* Specification
Spec == Init /\ [][Next]_<<sensor_type, sensor_id, app_id, app_camera_perm, app_microphone_perm, app_location_perm, app_motion_perm, camera_indicator, mic_indicator, any_camera_active, any_mic_active, rate_sensor_type, rate_max_reads_per_sec, rate_current_reads, bs_sensor, bs_max_rate, bs_current_rate, bs_rate_ok>>

====
