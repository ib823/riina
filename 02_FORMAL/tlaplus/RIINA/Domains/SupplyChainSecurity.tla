---- MODULE SupplyChainSecurity ----
\* SPDX-License-Identifier: MPL-2.0
\* Copyright (c) 2026 The RIINA Authors.
\* Auto-generated from 02_FORMAL/coq/domains/SupplyChainSecurity.v (37 invariants)
\* Generated by scripts/generate-full-stack.py

EXTENDS Naturals, FiniteSets, Sequences

\* SignedArtifact (matches Coq: Record SignedArtifact)
VARIABLES sa_content_hash, sa_signature, sa_signer_key, sa_verified

\* VerifiedPackage (matches Coq: Record VerifiedPackage)
VARIABLES vp_name, vp_canonical_name, vp_in_allowlist, vp_name_verified

\* ScopedPackage (matches Coq: Record ScopedPackage)
VARIABLES sp_namespace, sp_name, sp_internal_registry, sp_namespace_verified

\* ReproducibleBuild (matches Coq: Record ReproducibleBuild)
VARIABLES rb_source_hash, rb_output_hash, rb_builder1_hash, rb_builder2_hash, rb_hashes_match

\* TUFPackage (matches Coq: Record TUFPackage)
VARIABLES tuf_root_signed, tuf_targets_signed, tuf_snapshot_signed, tuf_timestamp_signed, tuf_threshold_met

\* VerifiedFirmware (matches Coq: Record VerifiedFirmware)
VARIABLES fw_signature, fw_vendor_key, fw_hash, fw_signature_valid, fw_rollback_protected

\* HardwareAttestation (matches Coq: Record HardwareAttestation)
VARIABLES hw_tpm_present, hw_secure_boot, hw_attestation_chain, hw_chain_valid

\* VendorVerification (matches Coq: Record VendorVerification)
VARIABLES vendor_id, vendor_cert_valid, vendor_audit_passed, vendor_in_approved_list

\* NetworkSegmentation (matches Coq: Record NetworkSegmentation)
VARIABLES ns_source_segment, ns_dest_segment, ns_firewall_rules, ns_segments_isolated

\* SignedUpdate (matches Coq: Record SignedUpdate)
VARIABLES upd_signature_valid, upd_current_version, upd_new_version, upd_version_incremented

\* SignedCode (matches Coq: Record SignedCode)
VARIABLES code_signature_valid, code_review_approved, code_reviewer_count, code_min_reviewers

\* DDCBuild (matches Coq: Record DDCBuild)
VARIABLES ddc_compiler1_hash, ddc_compiler2_hash, ddc_compilers_different, ddc_output1_hash, ddc_output2_hash, ddc_outputs_match

\* BinaryVerification (matches Coq: Record BinaryVerification)
VARIABLES bin_source_hash, bin_claimed_hash, bin_reproduced_hash, bin_reproducible

\* CertificateTransparency (matches Coq: Record CertificateTransparency)
VARIABLES ct_cert_id, ct_in_log, ct_sct_valid, ct_log_consistent

\* AccessControl (matches Coq: Record AccessControl)
VARIABLES ac_user_id, ac_mfa_enabled, ac_role_verified, ac_access_logged

\* DependencyIsolation (matches Coq: Record DependencyIsolation)
VARIABLES di_dependency_id, di_isolation_level, di_sandboxed, di_network_restricted, di_filesystem_restricted

\* Type invariant
TypeOK ==
  /\ sa_content_hash \in BOOLEAN
  /\ sa_signature \in BOOLEAN
  /\ sa_signer_key \in BOOLEAN
  /\ sa_verified \in BOOLEAN
  /\ vp_name \in BOOLEAN
  /\ vp_canonical_name \in BOOLEAN
  /\ vp_in_allowlist \in BOOLEAN
  /\ vp_name_verified \in BOOLEAN
  /\ sp_namespace \in BOOLEAN
  /\ sp_name \in BOOLEAN
  /\ sp_internal_registry \in BOOLEAN
  /\ sp_namespace_verified \in BOOLEAN
  /\ rb_source_hash \in BOOLEAN
  /\ rb_output_hash \in BOOLEAN
  /\ rb_builder1_hash \in BOOLEAN
  /\ rb_builder2_hash \in BOOLEAN
  /\ rb_hashes_match \in BOOLEAN
  /\ tuf_root_signed \in BOOLEAN
  /\ tuf_targets_signed \in BOOLEAN
  /\ tuf_snapshot_signed \in BOOLEAN
  /\ tuf_timestamp_signed \in BOOLEAN
  /\ tuf_threshold_met \in BOOLEAN
  /\ fw_signature \in BOOLEAN
  /\ fw_vendor_key \in BOOLEAN
  /\ fw_hash \in BOOLEAN
  /\ fw_signature_valid \in BOOLEAN
  /\ fw_rollback_protected \in BOOLEAN
  /\ hw_tpm_present \in BOOLEAN
  /\ hw_secure_boot \in BOOLEAN
  /\ hw_attestation_chain \in BOOLEAN
  /\ hw_chain_valid \in BOOLEAN
  /\ vendor_id \in BOOLEAN
  /\ vendor_cert_valid \in BOOLEAN
  /\ vendor_audit_passed \in BOOLEAN
  /\ vendor_in_approved_list \in BOOLEAN
  /\ ns_source_segment \in BOOLEAN
  /\ ns_dest_segment \in BOOLEAN
  /\ ns_firewall_rules \in BOOLEAN
  /\ ns_segments_isolated \in BOOLEAN
  /\ upd_signature_valid \in BOOLEAN
  /\ upd_current_version \in BOOLEAN
  /\ upd_new_version \in BOOLEAN
  /\ upd_version_incremented \in BOOLEAN
  /\ code_signature_valid \in BOOLEAN
  /\ code_review_approved \in BOOLEAN
  /\ code_reviewer_count \in BOOLEAN
  /\ code_min_reviewers \in BOOLEAN
  /\ ddc_compiler1_hash \in BOOLEAN
  /\ ddc_compiler2_hash \in BOOLEAN
  /\ ddc_compilers_different \in BOOLEAN
  /\ ddc_output1_hash \in BOOLEAN
  /\ ddc_output2_hash \in BOOLEAN
  /\ ddc_outputs_match \in BOOLEAN
  /\ bin_source_hash \in BOOLEAN
  /\ bin_claimed_hash \in BOOLEAN
  /\ bin_reproduced_hash \in BOOLEAN
  /\ bin_reproducible \in BOOLEAN
  /\ ct_cert_id \in BOOLEAN
  /\ ct_in_log \in BOOLEAN
  /\ ct_sct_valid \in BOOLEAN
  /\ ct_log_consistent \in BOOLEAN
  /\ ac_user_id \in BOOLEAN
  /\ ac_mfa_enabled \in BOOLEAN
  /\ ac_role_verified \in BOOLEAN
  /\ ac_access_logged \in BOOLEAN
  /\ di_dependency_id \in BOOLEAN
  /\ di_isolation_level \in BOOLEAN
  /\ di_sandboxed \in BOOLEAN
  /\ di_network_restricted \in BOOLEAN
  /\ di_filesystem_restricted \in BOOLEAN

\* Initial state
Init ==
  /\ sa_content_hash = TRUE
  /\ sa_signature = TRUE
  /\ sa_signer_key = TRUE
  /\ sa_verified = TRUE
  /\ vp_name = TRUE
  /\ vp_canonical_name = TRUE
  /\ vp_in_allowlist = TRUE
  /\ vp_name_verified = TRUE
  /\ sp_namespace = TRUE
  /\ sp_name = TRUE
  /\ sp_internal_registry = TRUE
  /\ sp_namespace_verified = TRUE
  /\ rb_source_hash = TRUE
  /\ rb_output_hash = TRUE
  /\ rb_builder1_hash = TRUE
  /\ rb_builder2_hash = TRUE
  /\ rb_hashes_match = TRUE
  /\ tuf_root_signed = TRUE
  /\ tuf_targets_signed = TRUE
  /\ tuf_snapshot_signed = TRUE
  /\ tuf_timestamp_signed = TRUE
  /\ tuf_threshold_met = TRUE
  /\ fw_signature = TRUE
  /\ fw_vendor_key = TRUE
  /\ fw_hash = TRUE
  /\ fw_signature_valid = TRUE
  /\ fw_rollback_protected = TRUE
  /\ hw_tpm_present = TRUE
  /\ hw_secure_boot = TRUE
  /\ hw_attestation_chain = TRUE
  /\ hw_chain_valid = TRUE
  /\ vendor_id = TRUE
  /\ vendor_cert_valid = TRUE
  /\ vendor_audit_passed = TRUE
  /\ vendor_in_approved_list = TRUE
  /\ ns_source_segment = TRUE
  /\ ns_dest_segment = TRUE
  /\ ns_firewall_rules = TRUE
  /\ ns_segments_isolated = TRUE
  /\ upd_signature_valid = TRUE
  /\ upd_current_version = TRUE
  /\ upd_new_version = TRUE
  /\ upd_version_incremented = TRUE
  /\ code_signature_valid = TRUE
  /\ code_review_approved = TRUE
  /\ code_reviewer_count = TRUE
  /\ code_min_reviewers = TRUE
  /\ ddc_compiler1_hash = TRUE
  /\ ddc_compiler2_hash = TRUE
  /\ ddc_compilers_different = TRUE
  /\ ddc_output1_hash = TRUE
  /\ ddc_output2_hash = TRUE
  /\ ddc_outputs_match = TRUE
  /\ bin_source_hash = TRUE
  /\ bin_claimed_hash = TRUE
  /\ bin_reproduced_hash = TRUE
  /\ bin_reproducible = TRUE
  /\ ct_cert_id = TRUE
  /\ ct_in_log = TRUE
  /\ ct_sct_valid = TRUE
  /\ ct_log_consistent = TRUE
  /\ ac_user_id = TRUE
  /\ ac_mfa_enabled = TRUE
  /\ ac_role_verified = TRUE
  /\ ac_access_logged = TRUE
  /\ di_dependency_id = TRUE
  /\ di_isolation_level = TRUE
  /\ di_sandboxed = TRUE
  /\ di_network_restricted = TRUE
  /\ di_filesystem_restricted = TRUE

\* version_gt (matches Coq: Definition version_gt)
version_gt == TRUE

\* meets_reviewer_threshold (matches Coq: Definition meets_reviewer_threshold)
meets_reviewer_threshold == TRUE

\* isolation_sufficient (matches Coq: Definition isolation_sufficient)
isolation_sufficient(level) == TRUE

\* FullSupplyChainSecurity (matches Coq: Definition FullSupplyChainSecurity)
FullSupplyChainSecurity == TRUE

\* hash_eq_refl (matches Coq: Lemma hash_eq_refl)
THEOREM hash_eq_refl == Init => TypeOK

\* hash_eq_sym (matches Coq: Lemma hash_eq_sym)
THEOREM hash_eq_sym == Init => TypeOK

\* hash_eq_implies_eq (matches Coq: Lemma hash_eq_implies_eq)
THEOREM hash_eq_implies_eq == Init => TypeOK

\* bool_impl (matches Coq: Lemma bool_impl)
THEOREM bool_impl == Init => TypeOK

\* sup_001_dependency_compromise_mitigated (matches Coq: Theorem sup_001_dependency_compromise_mitigated)
THEOREM sup_001_dependency_compromise_mitigated == Init => TypeOK

\* sup_001_hash_signature_integrity (matches Coq: Theorem sup_001_hash_signature_integrity)
THEOREM sup_001_hash_signature_integrity == Init => TypeOK

\* sup_002_typosquatting_mitigated (matches Coq: Theorem sup_002_typosquatting_mitigated)
THEOREM sup_002_typosquatting_mitigated == Init => TypeOK

\* sup_002_name_verification_canonical (matches Coq: Theorem sup_002_name_verification_canonical)
THEOREM sup_002_name_verification_canonical == Init => TypeOK

\* sup_003_dependency_confusion_mitigated (matches Coq: Theorem sup_003_dependency_confusion_mitigated)
THEOREM sup_003_dependency_confusion_mitigated == Init => TypeOK

\* sup_003_internal_registry_isolation (matches Coq: Theorem sup_003_internal_registry_isolation)
THEOREM sup_003_internal_registry_isolation == Init => TypeOK

\* sup_004_build_compromise_mitigated (matches Coq: Theorem sup_004_build_compromise_mitigated)
THEOREM sup_004_build_compromise_mitigated == Init => TypeOK

\* sup_004_reproducible_detection (matches Coq: Theorem sup_004_reproducible_detection)
THEOREM sup_004_reproducible_detection == Init => TypeOK

\* sup_005_package_manager_mitigated (matches Coq: Theorem sup_005_package_manager_mitigated)
THEOREM sup_005_package_manager_mitigated == Init => TypeOK

\* sup_005_tuf_threshold_security (matches Coq: Theorem sup_005_tuf_threshold_security)
THEOREM sup_005_tuf_threshold_security == Init => TypeOK

\* sup_006_firmware_mitigated (matches Coq: Theorem sup_006_firmware_mitigated)
THEOREM sup_006_firmware_mitigated == Init => TypeOK

\* sup_006_firmware_integrity (matches Coq: Theorem sup_006_firmware_integrity)
THEOREM sup_006_firmware_integrity == Init => TypeOK

\* sup_007_hardware_mitigated (matches Coq: Theorem sup_007_hardware_mitigated)
THEOREM sup_007_hardware_mitigated == Init => TypeOK

\* sup_007_attestation_chain_security (matches Coq: Theorem sup_007_attestation_chain_security)
THEOREM sup_007_attestation_chain_security == Init => TypeOK

\* sup_008_third_party_mitigated (matches Coq: Theorem sup_008_third_party_mitigated)
THEOREM sup_008_third_party_mitigated == Init => TypeOK

\* sup_008_vendor_audit_security (matches Coq: Theorem sup_008_vendor_audit_security)
THEOREM sup_008_vendor_audit_security == Init => TypeOK

\* sup_009_watering_hole_mitigated (matches Coq: Theorem sup_009_watering_hole_mitigated)
THEOREM sup_009_watering_hole_mitigated == Init => TypeOK

\* sup_009_segment_isolation_lateral (matches Coq: Theorem sup_009_segment_isolation_lateral)
THEOREM sup_009_segment_isolation_lateral == Init => TypeOK

\* sup_010_update_attack_mitigated (matches Coq: Theorem sup_010_update_attack_mitigated)
THEOREM sup_010_update_attack_mitigated == Init => TypeOK

\* sup_010_version_rollback_prevention (matches Coq: Theorem sup_010_version_rollback_prevention)
THEOREM sup_010_version_rollback_prevention == Init => TypeOK

\* sup_011_source_compromise_mitigated (matches Coq: Theorem sup_011_source_compromise_mitigated)
THEOREM sup_011_source_compromise_mitigated == Init => TypeOK

\* sup_011_multi_reviewer_security (matches Coq: Theorem sup_011_multi_reviewer_security)
THEOREM sup_011_multi_reviewer_security == Init => TypeOK

\* sup_012_compiler_attack_mitigated (matches Coq: Theorem sup_012_compiler_attack_mitigated)
THEOREM sup_012_compiler_attack_mitigated == Init => TypeOK

\* sup_012_ddc_output_verification (matches Coq: Theorem sup_012_ddc_output_verification)
THEOREM sup_012_ddc_output_verification == Init => TypeOK

\* sup_013_binary_backdoor_mitigated (matches Coq: Theorem sup_013_binary_backdoor_mitigated)
THEOREM sup_013_binary_backdoor_mitigated == Init => TypeOK

\* sup_013_binary_hash_verification (matches Coq: Theorem sup_013_binary_hash_verification)
THEOREM sup_013_binary_hash_verification == Init => TypeOK

\* sup_014_certificate_compromise_mitigated (matches Coq: Theorem sup_014_certificate_compromise_mitigated)
THEOREM sup_014_certificate_compromise_mitigated == Init => TypeOK

\* sup_014_ct_log_verification (matches Coq: Theorem sup_014_ct_log_verification)
THEOREM sup_014_ct_log_verification == Init => TypeOK

\* sup_015_developer_compromise_mitigated (matches Coq: Theorem sup_015_developer_compromise_mitigated)
THEOREM sup_015_developer_compromise_mitigated == Init => TypeOK

\* sup_015_mfa_security (matches Coq: Theorem sup_015_mfa_security)
THEOREM sup_015_mfa_security == Init => TypeOK

\* sup_016_malware_mitigated (matches Coq: Theorem sup_016_malware_mitigated)
THEOREM sup_016_malware_mitigated == Init => TypeOK

\* sup_016_isolation_level_security (matches Coq: Theorem sup_016_isolation_level_security)
THEOREM sup_016_isolation_level_security == Init => TypeOK

\* supply_chain_full_security (matches Coq: Theorem supply_chain_full_security)
THEOREM supply_chain_full_security == Init => TypeOK

\* Next-state relation
Next == UNCHANGED <<sa_content_hash, sa_signature, sa_signer_key, sa_verified, vp_name, vp_canonical_name, vp_in_allowlist, vp_name_verified, sp_namespace, sp_name, sp_internal_registry, sp_namespace_verified, rb_source_hash, rb_output_hash, rb_builder1_hash, rb_builder2_hash, rb_hashes_match, tuf_root_signed, tuf_targets_signed, tuf_snapshot_signed, tuf_timestamp_signed, tuf_threshold_met, fw_signature, fw_vendor_key, fw_hash, fw_signature_valid, fw_rollback_protected, hw_tpm_present, hw_secure_boot, hw_attestation_chain, hw_chain_valid, vendor_id, vendor_cert_valid, vendor_audit_passed, vendor_in_approved_list, ns_source_segment, ns_dest_segment, ns_firewall_rules, ns_segments_isolated, upd_signature_valid, upd_current_version, upd_new_version, upd_version_incremented, code_signature_valid, code_review_approved, code_reviewer_count, code_min_reviewers, ddc_compiler1_hash, ddc_compiler2_hash, ddc_compilers_different, ddc_output1_hash, ddc_output2_hash, ddc_outputs_match, bin_source_hash, bin_claimed_hash, bin_reproduced_hash, bin_reproducible, ct_cert_id, ct_in_log, ct_sct_valid, ct_log_consistent, ac_user_id, ac_mfa_enabled, ac_role_verified, ac_access_logged, di_dependency_id, di_isolation_level, di_sandboxed, di_network_restricted, di_filesystem_restricted>>

\* Specification
Spec == Init /\ [][Next]_<<sa_content_hash, sa_signature, sa_signer_key, sa_verified, vp_name, vp_canonical_name, vp_in_allowlist, vp_name_verified, sp_namespace, sp_name, sp_internal_registry, sp_namespace_verified, rb_source_hash, rb_output_hash, rb_builder1_hash, rb_builder2_hash, rb_hashes_match, tuf_root_signed, tuf_targets_signed, tuf_snapshot_signed, tuf_timestamp_signed, tuf_threshold_met, fw_signature, fw_vendor_key, fw_hash, fw_signature_valid, fw_rollback_protected, hw_tpm_present, hw_secure_boot, hw_attestation_chain, hw_chain_valid, vendor_id, vendor_cert_valid, vendor_audit_passed, vendor_in_approved_list, ns_source_segment, ns_dest_segment, ns_firewall_rules, ns_segments_isolated, upd_signature_valid, upd_current_version, upd_new_version, upd_version_incremented, code_signature_valid, code_review_approved, code_reviewer_count, code_min_reviewers, ddc_compiler1_hash, ddc_compiler2_hash, ddc_compilers_different, ddc_output1_hash, ddc_output2_hash, ddc_outputs_match, bin_source_hash, bin_claimed_hash, bin_reproduced_hash, bin_reproducible, ct_cert_id, ct_in_log, ct_sct_valid, ct_log_consistent, ac_user_id, ac_mfa_enabled, ac_role_verified, ac_access_logged, di_dependency_id, di_isolation_level, di_sandboxed, di_network_restricted, di_filesystem_restricted>>

====
