; Copyright (c) 2026 The RIINA Authors. All rights reserved.
; Auto-generated from 02_FORMAL/coq/domains/ControlFlowIntegrity.v (21 validations)
; Generated by scripts/generate-full-stack.py
;
; Translation Validation for ControlFlowIntegrity
; Layer 9: Verifies compiler backend preserves formal semantics.
; Each assertion checks source IR â‰¡ target code for a proven property.

(set-logic QF_LIA)
(set-option :produce-models true)

; IR node representation
(declare-sort IRNode 0)
(declare-sort TargetNode 0)

; edge_in_cfg: source semantics (matches Coq)
(declare-fun source_edge_in_cfg () Bool)
(declare-fun target_edge_in_cfg () Bool)
(assert (= source_edge_in_cfg target_edge_in_cfg))

; shadow_push: source semantics (matches Coq)
(declare-fun source_shadow_push () Bool)
(declare-fun target_shadow_push () Bool)
(assert (= source_shadow_push target_shadow_push))

; valid_return: source semantics (matches Coq)
(declare-fun source_valid_return () Bool)
(declare-fun target_valid_return () Bool)
(assert (= source_valid_return target_valid_return))

; valid_indirect_call: source semantics (matches Coq)
(declare-fun source_valid_indirect_call () Bool)
(declare-fun target_valid_indirect_call () Bool)
(assert (= source_valid_indirect_call target_valid_indirect_call))

; has_perm: source semantics (matches Coq)
(declare-fun source_has_perm () Bool)
(declare-fun target_has_perm () Bool)
(assert (= source_has_perm target_has_perm))

; w_xor_x: source semantics (matches Coq)
(declare-fun source_w_xor_x () Bool)
(declare-fun target_w_xor_x () Bool)
(assert (= source_w_xor_x target_w_xor_x))

; vtable_type_matches: source semantics (matches Coq)
(declare-fun source_vtable_type_matches () Bool)
(declare-fun target_vtable_type_matches () Bool)
(assert (= source_vtable_type_matches target_vtable_type_matches))

; handler_registered: source semantics (matches Coq)
(declare-fun source_handler_registered () Bool)
(declare-fun target_handler_registered () Bool)
(assert (= source_handler_registered target_handler_registered))

; longjmp_safe: source semantics (matches Coq)
(declare-fun source_longjmp_safe () Bool)
(declare-fun target_longjmp_safe () Bool)
(assert (= source_longjmp_safe target_longjmp_safe))

; got_writable: source semantics (matches Coq)
(declare-fun source_got_writable () Bool)
(declare-fun target_got_writable () Bool)
(assert (= source_got_writable target_got_writable))

; got_protected: source semantics (matches Coq)
(declare-fun source_got_protected () Bool)
(declare-fun target_got_protected () Bool)
(assert (= source_got_protected target_got_protected))

; thread_accessible: source semantics (matches Coq)
(declare-fun source_thread_accessible () Bool)
(declare-fun target_thread_accessible () Bool)
(assert (= source_thread_accessible target_thread_accessible))

; ctl_001_rop_impossible: translation preserves property (matches Coq: Theorem)
(declare-fun source_ctl_001_rop_impossible () Bool)
(declare-fun target_ctl_001_rop_impossible () Bool)
(assert (= source_ctl_001_rop_impossible target_ctl_001_rop_impossible))

; ctl_002_jop_impossible: translation preserves property (matches Coq: Theorem)
(declare-fun source_ctl_002_jop_impossible () Bool)
(declare-fun target_ctl_002_jop_impossible () Bool)
(assert (= source_ctl_002_jop_impossible target_ctl_002_jop_impossible))

; ctl_003_cop_impossible: translation preserves property (matches Coq: Theorem)
(declare-fun source_ctl_003_cop_impossible () Bool)
(declare-fun target_ctl_003_cop_impossible () Bool)
(assert (= source_ctl_003_cop_impossible target_ctl_003_cop_impossible))

; ctl_004_ret2libc_impossible: translation preserves property (matches Coq: Theorem)
(declare-fun source_ctl_004_ret2libc_impossible () Bool)
(declare-fun target_ctl_004_ret2libc_impossible () Bool)
(assert (= source_ctl_004_ret2libc_impossible target_ctl_004_ret2libc_impossible))

; ctl_005_srop_impossible: translation preserves property (matches Coq: Theorem)
(declare-fun source_ctl_005_srop_impossible () Bool)
(declare-fun target_ctl_005_srop_impossible () Bool)
(assert (= source_ctl_005_srop_impossible target_ctl_005_srop_impossible))

; ctl_006_code_injection_impossible: translation preserves property (matches Coq: Theorem)
(declare-fun source_ctl_006_code_injection_impossible () Bool)
(declare-fun target_ctl_006_code_injection_impossible () Bool)
(assert (= source_ctl_006_code_injection_impossible target_ctl_006_code_injection_impossible))

; ctl_007_code_reuse_controlled: translation preserves property (matches Coq: Theorem)
(declare-fun source_ctl_007_code_reuse_controlled () Bool)
(declare-fun target_ctl_007_code_reuse_controlled () Bool)
(assert (= source_ctl_007_code_reuse_controlled target_ctl_007_code_reuse_controlled))

; ctl_008_data_only_mitigated: translation preserves property (matches Coq: Theorem)
(declare-fun source_ctl_008_data_only_mitigated () Bool)
(declare-fun target_ctl_008_data_only_mitigated () Bool)
(assert (= source_ctl_008_data_only_mitigated target_ctl_008_data_only_mitigated))

; ctl_009_cf_bending_impossible: translation preserves property (matches Coq: Theorem)
(declare-fun source_ctl_009_cf_bending_impossible () Bool)
(declare-fun target_ctl_009_cf_bending_impossible () Bool)
(assert (= source_ctl_009_cf_bending_impossible target_ctl_009_cf_bending_impossible))

; ctl_010_indirect_call_safe: translation preserves property (matches Coq: Theorem)
(declare-fun source_ctl_010_indirect_call_safe () Bool)
(declare-fun target_ctl_010_indirect_call_safe () Bool)
(assert (= source_ctl_010_indirect_call_safe target_ctl_010_indirect_call_safe))

; ctl_011_vtable_hijack_impossible: translation preserves property (matches Coq: Theorem)
(declare-fun source_ctl_011_vtable_hijack_impossible () Bool)
(declare-fun target_ctl_011_vtable_hijack_impossible () Bool)
(assert (= source_ctl_011_vtable_hijack_impossible target_ctl_011_vtable_hijack_impossible))

; ctl_012_exception_safe: translation preserves property (matches Coq: Theorem)
(declare-fun source_ctl_012_exception_safe () Bool)
(declare-fun target_ctl_012_exception_safe () Bool)
(assert (= source_ctl_012_exception_safe target_ctl_012_exception_safe))

; ctl_013_longjmp_safe: translation preserves property (matches Coq: Theorem)
(declare-fun source_ctl_013_longjmp_safe () Bool)
(declare-fun target_ctl_013_longjmp_safe () Bool)
(assert (= source_ctl_013_longjmp_safe target_ctl_013_longjmp_safe))

; ctl_014_got_plt_protected: translation preserves property (matches Coq: Theorem)
(declare-fun source_ctl_014_got_plt_protected () Bool)
(declare-fun target_ctl_014_got_plt_protected () Bool)
(assert (= source_ctl_014_got_plt_protected target_ctl_014_got_plt_protected))

; ctl_015_thread_hijack_impossible: translation preserves property (matches Coq: Theorem)
(declare-fun source_ctl_015_thread_hijack_impossible () Bool)
(declare-fun target_ctl_015_thread_hijack_impossible () Bool)
(assert (= source_ctl_015_thread_hijack_impossible target_ctl_015_thread_hijack_impossible))

; ctl_016_shadow_push_pop_identity: translation preserves property (matches Coq: Theorem)
(declare-fun source_ctl_016_shadow_push_pop_identity () Bool)
(declare-fun target_ctl_016_shadow_push_pop_identity () Bool)
(assert (= source_ctl_016_shadow_push_pop_identity target_ctl_016_shadow_push_pop_identity))

; ctl_017_valid_return_after_push: translation preserves property (matches Coq: Theorem)
(declare-fun source_ctl_017_valid_return_after_push () Bool)
(declare-fun target_ctl_017_valid_return_after_push () Bool)
(assert (= source_ctl_017_valid_return_after_push target_ctl_017_valid_return_after_push))

; ctl_018_wxor_x_empty: translation preserves property (matches Coq: Theorem)
(declare-fun source_ctl_018_wxor_x_empty () Bool)
(declare-fun target_ctl_018_wxor_x_empty () Bool)
(assert (= source_ctl_018_wxor_x_empty target_ctl_018_wxor_x_empty))

; ctl_019_reloc_state_decidable: translation preserves property (matches Coq: Theorem)
(declare-fun source_ctl_019_reloc_state_decidable () Bool)
(declare-fun target_ctl_019_reloc_state_decidable () Bool)
(assert (= source_ctl_019_reloc_state_decidable target_ctl_019_reloc_state_decidable))

; ctl_020_shadow_push_length: translation preserves property (matches Coq: Theorem)
(declare-fun source_ctl_020_shadow_push_length () Bool)
(declare-fun target_ctl_020_shadow_push_length () Bool)
(assert (= source_ctl_020_shadow_push_length target_ctl_020_shadow_push_length))

; ctl_021_valid_trace_prefix: translation preserves property (matches Coq: Theorem)
(declare-fun source_ctl_021_valid_trace_prefix () Bool)
(declare-fun target_ctl_021_valid_trace_prefix () Bool)
(assert (= source_ctl_021_valid_trace_prefix target_ctl_021_valid_trace_prefix))

; Verify all translation validations are satisfiable
(check-sat)
(exit)
