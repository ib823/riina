(* SPDX-License-Identifier: MPL-2.0 *)
(* Copyright (c) 2026 The RIINA Authors. See AUTHORS file. *)

(*
 * RIINA PostQuantumSignatures - Isabelle/HOL Port
 *
 * Auto-generated port of 02_FORMAL/coq/domains/PostQuantumSignatures.v (26 theorems).
 *
 * Generated by scripts/generate-multiprover.py
 *
 * Correspondence Table:
 *
 * | Coq Definition     | Isabelle Definition    | Status |
 * |--------------------|------------------------|--------|
 * | SecurityLevel      | security_level         | OK     |
 * | SignatureScheme    | signature_scheme       | OK     |
 * | SigningKeyPair     | signing_key_pair       | OK     |
 * | SignatureResult    | signature_result       | OK     |
 * | SignatureInstance  | signature_instance     | OK     |
 * | EUFCMASecure       | eufcma_secure          | OK     |
 * | SigQuantumResistant | sig_quantum_resistant  | OK     |
 * | HashBasedProperties | hash_based_properties  | OK     |
 * | SignatureSecurity  | signature_security     | OK     |
 * | scheme_category    | scheme_category        | OK     |
 * | scheme_security_level | scheme_security_level  | OK     |
 * | level_leq          | level_leq              | OK     |
 * | eufcma_compliant   | eufcma_compliant       | OK     |
 * | sig_quantum_resistant | sig_quantum_resistant  | OK     |
 * | sig_secure         | sig_secure             | OK     |
 * | sig_correct        | sig_correct            | OK     |
 * | mk_valid_sig_keypair | mk_valid_sig_keypair   | OK     |
 * | mk_valid_signature | mk_valid_signature     | OK     |
 * | mk_compliant_eufcma | mk_compliant_eufcma    | OK     |
 * | mk_compliant_sig_qr | mk_compliant_sig_qr    | OK     |
 * | riina_sig_ml_dsa_87 | riina_sig_ml_dsa_87    | OK     |
 * | riina_sig_slh_dsa_256s | riina_sig_slh_dsa_256s | OK     |
 * | riina_sig_security | riina_sig_security     | OK     |
 * | andb_true_iff      | andb_true_iff          | OK     |
 * | PQ_SIG_001_mldsa_lattice | PQ_SIG_001_mldsa_lattice | OK     |
 * | PQ_SIG_002_slhdsa_hash | PQ_SIG_002_slhdsa_hash | OK     |
 * | PQ_SIG_003_mldsa87_level5 | PQ_SIG_003_mldsa87_level5 | OK     |
 * | PQ_SIG_004_slhdsa256_level5 | PQ_SIG_004_slhdsa256_level5 | OK     |
 * | PQ_SIG_005_level_reflexive | PQ_SIG_005_level_reflexive | OK     |
 * | PQ_SIG_006_level5_max | PQ_SIG_006_level5_max  | OK     |
 * | PQ_SIG_007_eufcma_valid | PQ_SIG_007_eufcma_valid | OK     |
 * | PQ_SIG_008_unforgeable | PQ_SIG_008_unforgeable | OK     |
 * | PQ_SIG_009_strong_unforgeable | PQ_SIG_009_strong_unforgeable | OK     |
 * | PQ_SIG_010_adaptive | PQ_SIG_010_adaptive    | OK     |
 * | PQ_SIG_011_qr_valid | PQ_SIG_011_qr_valid    | OK     |
 * | PQ_SIG_012_post_quantum | PQ_SIG_012_post_quantum | OK     |
 * | PQ_SIG_013_no_shor | PQ_SIG_013_no_shor     | OK     |
 * | PQ_SIG_014_conservative | PQ_SIG_014_conservative | OK     |
 * | PQ_SIG_015_riina_sig_secure | PQ_SIG_015_riina_sig_secure | OK     |
 * | PQ_SIG_016_riina_level5 | PQ_SIG_016_riina_level5 | OK     |
 * | PQ_SIG_017_riina_mldsa_correct | PQ_SIG_017_riina_mldsa_correct | OK     |
 * | PQ_SIG_018_riina_slhdsa_correct | PQ_SIG_018_riina_slhdsa_correct | OK     |
 * | PQ_SIG_019_riina_scheme_mldsa | PQ_SIG_019_riina_scheme_mldsa | OK     |
 * | PQ_SIG_020_riina_scheme_slhdsa | PQ_SIG_020_riina_scheme_slhdsa | OK     |
 * | PQ_SIG_021_security_implies_eufcma | PQ_SIG_021_security_implies_eufcma | OK     |
 * | PQ_SIG_022_security_implies_qr | PQ_SIG_022_security_implies_qr | OK     |
 * | PQ_SIG_023_correct_key | PQ_SIG_023_correct_key | OK     |
 * | PQ_SIG_024_correct_verify | PQ_SIG_024_correct_verify | OK     |
 * | PQ_SIG_025_complete_security | PQ_SIG_025_complete_security | OK     |
 *)

theory PostQuantumSignatures
  imports Main
begin

(* Boolean conjunction helper (matches Coq: andb_true_iff) *)
lemma andb_true_iff: "(a \<and> b) = True \<longleftrightarrow> a = True \<and> b = True"
  by auto

(* SecurityLevel (matches Coq: Inductive SecurityLevel) *)
datatype security_level =
    Level1
  |     Level3
  |     Level5

(* SignatureScheme (matches Coq: Inductive SignatureScheme) *)
datatype signature_scheme =
    ML_DSA_44  (* Dilithium2 - Level 1 *)
  |     ML_DSA_65  (* Dilithium3 - Level 3 *)
  |     ML_DSA_87  (* Dilithium5 - Level 5 *)
  |     SLH_DSA_128s  (* SPHINCS+-128s - Level 1 *)
  |     SLH_DSA_192s  (* SPHINCS+-192s - Level 3 *)
  |     Lattice_Based  (* ML-DSA / Dilithium *)
  |     ML_DSA_44
  |     ML_DSA_65
  |     SLH_DSA_128s
  |     SLH_DSA_192s

(* SigningKeyPair (matches Coq: Record SigningKeyPair) *)
record signing_key_pair =
  skp_public :: PublicKey
  skp_secret :: SecretKey
  skp_valid :: bool

(* SignatureResult (matches Coq: Record SignatureResult) *)
record signature_result =
  sig_value :: Signature
  sig_valid :: bool

(* SignatureInstance (matches Coq: Record SignatureInstance) *)
record signature_instance =
  sig_scheme :: SignatureScheme
  sig_keypair :: SigningKeyPair
  sig_message :: Message
  sig_signature :: SignatureResult
  sig_verification :: bool  (* Result of Verify(pk, msg, sig) *)

(* EUFCMASecure (matches Coq: Record EUFCMASecure) *)
record eufcma_secure =
  eufcma_unforgeable :: bool
  eufcma_strong_unforgeability :: bool
  eufcma_adaptive_security :: bool

(* SigQuantumResistant (matches Coq: Record SigQuantumResistant) *)
record sig_quantum_resistant =
  sqr_post_quantum :: bool
  sqr_no_shor_attack :: bool
  sqr_conservative_params :: bool

(* HashBasedProperties (matches Coq: Record HashBasedProperties) *)
record hash_based_properties =
  hb_stateless :: bool
  hb_hash_function_secure :: bool
  hb_few_time_signature :: bool

(* SignatureSecurity (matches Coq: Record SignatureSecurity) *)
record signature_security =
  sig_sec_eufcma :: EUFCMASecure
  sig_sec_quantum :: SigQuantumResistant
  sig_sec_level :: SecurityLevel

(* scheme_category (matches Coq: Definition scheme_category) *)
fun scheme_category :: "SignatureScheme \<Rightarrow> SchemeCategory" where
  "scheme_category ML_DSA_87 = Lattice_Based"
|   "scheme_category SLH_DSA_256s = Hash_Based"

(* scheme_security_level (matches Coq: Definition scheme_security_level) *)
fun scheme_security_level :: "SignatureScheme \<Rightarrow> SecurityLevel" where
  "scheme_security_level SLH_DSA_128s = Level1"
|   "scheme_security_level SLH_DSA_192s = Level3"
|   "scheme_security_level SLH_DSA_256s = Level5"

(* level_leq - complex match, manual review needed *)

(* eufcma_compliant (matches Coq: Definition eufcma_compliant) *)
definition eufcma_compliant :: "EUFCMASecure \<Rightarrow> bool" where
  "eufcma_compliant e \<equiv> eufcma_unforgeable e \<and>
  eufcma_strong_unforgeability e \<and>
  eufcma_adaptive_security e"

(* sig_quantum_resistant (matches Coq: Definition sig_quantum_resistant) *)
definition sig_quantum_resistant :: "SigQuantumResistant \<Rightarrow> bool" where
  "sig_quantum_resistant q \<equiv> sqr_post_quantum q \<and>
  sqr_no_shor_attack q \<and>
  sqr_conservative_params q"

(* sig_secure (matches Coq: Definition sig_secure) *)
definition sig_secure :: "SignatureSecurity \<Rightarrow> bool" where
  "sig_secure s \<equiv> eufcma_compliant (sig_sec_eufcma s) \<and>
  sig_quantum_resistant (sig_sec_quantum s)"

(* sig_correct (matches Coq: Definition sig_correct) *)
definition sig_correct :: "SignatureInstance \<Rightarrow> bool" where
  "sig_correct si \<equiv> skp_valid (sig_keypair si) \<and>
  sig_valid (sig_signature si) \<and>
  sig_verification si"

(* mk_valid_sig_keypair (matches Coq: Definition mk_valid_sig_keypair) *)
definition mk_valid_sig_keypair :: "SigningKeyPair" where
  "mk_valid_sig_keypair \<equiv> mkSigningKeyPair 1 2 true"

(* mk_valid_signature (matches Coq: Definition mk_valid_signature) *)
definition mk_valid_signature :: "SignatureResult" where
  "mk_valid_signature \<equiv> mkSignatureResult 12345 true"

(* mk_compliant_eufcma (matches Coq: Definition mk_compliant_eufcma) *)
definition mk_compliant_eufcma :: "EUFCMASecure" where
  "mk_compliant_eufcma \<equiv> mkEUFCMA true true true"

(* mk_compliant_sig_qr (matches Coq: Definition mk_compliant_sig_qr) *)
definition mk_compliant_sig_qr :: "SigQuantumResistant" where
  "mk_compliant_sig_qr \<equiv> mkSigQR true true true"

(* riina_sig_ml_dsa_87 (matches Coq: Definition riina_sig_ml_dsa_87) *)
definition riina_sig_ml_dsa_87 :: "SignatureInstance" where
  "riina_sig_ml_dsa_87 \<equiv> mkSigInstance
  ML_DSA_87
  mk_valid_sig_keypair
  42  (* message *)
  mk_valid_signature
  true"

(* riina_sig_slh_dsa_256s (matches Coq: Definition riina_sig_slh_dsa_256s) *)
definition riina_sig_slh_dsa_256s :: "SignatureInstance" where
  "riina_sig_slh_dsa_256s \<equiv> mkSigInstance
  SLH_DSA_256s
  mk_valid_sig_keypair
  42
  mk_valid_signature
  true"

(* riina_sig_security (matches Coq: Definition riina_sig_security) *)
definition riina_sig_security :: "SignatureSecurity" where
  "riina_sig_security \<equiv> mkSigSecurity
  mk_compliant_eufcma
  mk_compliant_sig_qr
  Level5"

(* ============================================================================
    SECTION 4: COMPLIANCE PREDICATES
    ============================================================================ *)
(* andb_true_iff (matches Coq) *)
lemma andb_true_iff: "\<forall> a b : bool, a && b = True <-> a = True \<and> b = True"
  by (cases rule: ‹_›.cases; simp)

(* PQ_SIG_001: ML-DSA is Lattice-Based *)
(* PQ_SIG_001_mldsa_lattice (matches Coq) *)
lemma PQ_SIG_001_mldsa_lattice: "scheme_category ML_DSA_87 = Lattice_Based"
  by simp

(* PQ_SIG_002: SLH-DSA is Hash-Based *)
(* PQ_SIG_002_slhdsa_hash (matches Coq) *)
lemma PQ_SIG_002_slhdsa_hash: "scheme_category SLH_DSA_256s = Hash_Based"
  by simp

(* PQ_SIG_003: ML-DSA-87 is Level 5 *)
(* PQ_SIG_003_mldsa87_level5 (matches Coq) *)
lemma PQ_SIG_003_mldsa87_level5: "scheme_security_level ML_DSA_87 = Level5"
  by simp

(* PQ_SIG_004: SLH-DSA-256s is Level 5 *)
(* PQ_SIG_004_slhdsa256_level5 (matches Coq) *)
lemma PQ_SIG_004_slhdsa256_level5: "scheme_security_level SLH_DSA_256s = Level5"
  by simp

(* PQ_SIG_005: Level Reflexivity *)
(* PQ_SIG_005_level_reflexive (matches Coq) *)
lemma PQ_SIG_005_level_reflexive: "\<forall> l : SecurityLevel, level_leq l l = True"
  by simp

(* PQ_SIG_006: Level 5 is Maximum *)
(* PQ_SIG_006_level5_max (matches Coq) *)
lemma PQ_SIG_006_level5_max: "\<forall> l : SecurityLevel, level_leq l Level5 = True"
  by simp

(* PQ_SIG_007: Compliant EUF-CMA Valid *)
(* PQ_SIG_007_eufcma_valid (matches Coq) *)
lemma PQ_SIG_007_eufcma_valid: "eufcma_compliant mk_compliant_eufcma = True"
  by simp

(* PQ_SIG_008: Unforgeability Required *)
(* PQ_SIG_008_unforgeable (matches Coq) *)
lemma PQ_SIG_008_unforgeable: "\<forall> e : EUFCMASecure, eufcma_compliant e = True \<longrightarrow> eufcma_unforgeable e = True"
  by (cases rule: ‹_›.cases; simp)

(* PQ_SIG_009: Strong Unforgeability Required *)
(* PQ_SIG_009_strong_unforgeable (matches Coq) *)
lemma PQ_SIG_009_strong_unforgeable: "\<forall> e : EUFCMASecure, eufcma_compliant e = True \<longrightarrow> eufcma_strong_unforgeability e = True"
  by (cases rule: ‹_›.cases; simp)

(* PQ_SIG_010: Adaptive Security Required *)
(* PQ_SIG_010_adaptive (matches Coq) *)
lemma PQ_SIG_010_adaptive: "\<forall> e : EUFCMASecure, eufcma_compliant e = True \<longrightarrow> eufcma_adaptive_security e = True"
  by (cases rule: ‹_›.cases; simp)

(* PQ_SIG_011: Compliant QR Valid *)
(* PQ_SIG_011_qr_valid (matches Coq) *)
lemma PQ_SIG_011_qr_valid: "sig_quantum_resistant mk_compliant_sig_qr = True"
  by simp

(* PQ_SIG_012: Post-Quantum Security *)
(* PQ_SIG_012_post_quantum (matches Coq) *)
lemma PQ_SIG_012_post_quantum: "\<forall> q : SigQuantumResistant, sig_quantum_resistant q = True \<longrightarrow> sqr_post_quantum q = True"
  by auto

(* PQ_SIG_013: No Shor Attack *)
(* PQ_SIG_013_no_shor (matches Coq) *)
lemma PQ_SIG_013_no_shor: "\<forall> q : SigQuantumResistant, sig_quantum_resistant q = True \<longrightarrow> sqr_no_shor_attack q = True"
  by auto

(* PQ_SIG_014: Conservative Parameters *)
(* PQ_SIG_014_conservative (matches Coq) *)
lemma PQ_SIG_014_conservative: "\<forall> q : SigQuantumResistant, sig_quantum_resistant q = True \<longrightarrow> sqr_conservative_params q = True"
  by auto

(* PQ_SIG_015: RIINA Sig Security Valid *)
(* PQ_SIG_015_riina_sig_secure (matches Coq) *)
lemma PQ_SIG_015_riina_sig_secure: "sig_secure riina_sig_security = True"
  by simp

(* PQ_SIG_016: RIINA Uses Level 5 *)
(* PQ_SIG_016_riina_level5 (matches Coq) *)
lemma PQ_SIG_016_riina_level5: "sig_sec_level riina_sig_security = Level5"
  by simp

(* PQ_SIG_017: RIINA ML-DSA Correct *)
(* PQ_SIG_017_riina_mldsa_correct (matches Coq) *)
lemma PQ_SIG_017_riina_mldsa_correct: "sig_correct riina_sig_ml_dsa_87 = True"
  by simp

(* PQ_SIG_018: RIINA SLH-DSA Correct *)
(* PQ_SIG_018_riina_slhdsa_correct (matches Coq) *)
lemma PQ_SIG_018_riina_slhdsa_correct: "sig_correct riina_sig_slh_dsa_256s = True"
  by simp

(* PQ_SIG_019: RIINA Uses ML-DSA-87 *)
(* PQ_SIG_019_riina_scheme_mldsa (matches Coq) *)
lemma PQ_SIG_019_riina_scheme_mldsa: "sig_scheme riina_sig_ml_dsa_87 = ML_DSA_87"
  by simp

(* PQ_SIG_020: RIINA Uses SLH-DSA-256s *)
(* PQ_SIG_020_riina_scheme_slhdsa (matches Coq) *)
lemma PQ_SIG_020_riina_scheme_slhdsa: "sig_scheme riina_sig_slh_dsa_256s = SLH_DSA_256s"
  by simp

(* PQ_SIG_021: Security Implies EUF-CMA *)
(* PQ_SIG_021_security_implies_eufcma (matches Coq) *)
lemma PQ_SIG_021_security_implies_eufcma: "\<forall> s : SignatureSecurity, sig_secure s = True \<longrightarrow> eufcma_compliant (sig_sec_eufcma s) = True"
  by auto

(* PQ_SIG_022: Security Implies QR *)
(* PQ_SIG_022_security_implies_qr (matches Coq) *)
lemma PQ_SIG_022_security_implies_qr: "\<forall> s : SignatureSecurity, sig_secure s = True \<longrightarrow> sig_quantum_resistant (sig_sec_quantum s) = True"
  by auto

(* PQ_SIG_023: Correctness Requires Valid Key *)
(* PQ_SIG_023_correct_key (matches Coq) *)
lemma PQ_SIG_023_correct_key: "\<forall> si : SignatureInstance, sig_correct si = True \<longrightarrow> skp_valid (sig_keypair si) = True"
  by auto

(* PQ_SIG_024: Correctness Requires Verification *)
(* PQ_SIG_024_correct_verify (matches Coq) *)
lemma PQ_SIG_024_correct_verify: "\<forall> si : SignatureInstance, sig_correct si = True \<longrightarrow> sig_verification si = True"
  by auto

(* PQ_SIG_025: Complete PQ-Signature Security *)
(* PQ_SIG_025_complete_security (matches Coq) *)
lemma PQ_SIG_025_complete_security: "\<forall> s : SignatureSecurity, sig_secure s = True \<longrightarrow> (* All security properties satisfied *) eufcma_unforgeable (sig_sec_eufcma s) = True \<and> eufcma_strong_unforgeability (sig_sec_eufcma s) = True \<and> sqr_post_quantum (sig_sec_quantum s) = True \<and> sqr_no_shor_attack (sig_sec_quantum s) = True"
  by simp

end
