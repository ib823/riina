(* SPDX-License-Identifier: MPL-2.0 *)
(* Copyright (c) 2026 The RIINA Authors. See AUTHORS file. *)

(*
 * RIINA SingaporeCybersecurityAct - Isabelle/HOL Port
 *
 * Auto-generated port of 02_FORMAL/coq/domains/SingaporeCybersecurityAct.v (26 theorems).
 *
 * Generated by scripts/generate-multiprover.py
 *
 * Correspondence Table:
 *
 * | Coq Definition     | Isabelle Definition    | Status |
 * |--------------------|------------------------|--------|
 * | CIISector          | cii_sector             | OK     |
 * | EntityClassification | entity_classification  | OK     |
 * | cii_risk_current   | cii_risk_current       | OK     |
 * | cii_audit_current  | cii_audit_current      | OK     |
 * | sg_incident_reported_in_time | sg_incident_reported_in_time | OK     |
 * | cii_controls_adequate | cii_controls_adequate  | OK     |
 * | esci_obligations_met | esci_obligations_met   | OK     |
 * | cssp_licensed_sg   | cssp_licensed_sg       | OK     |
 * | sg_cybersecurity_act_compliant | sg_cybersecurity_act_compliant | OK     |
 * | stcc_obligations_met | stcc_obligations_met   | OK     |
 * | cii_owner_obligations | cii_owner_obligations  | OK     |
 * | incident_needs_notification | incident_needs_notification | OK     |
 * | audit_schedule_consistent | audit_schedule_consistent | OK     |
 * | regular_entity_exempt | regular_entity_exempt  | OK     |
 * | penalty_exposure_exists | penalty_exposure_exists | OK     |
 * | cii_obligation_1   | cii_obligation_1       | OK     |
 * | cii_obligation_2   | cii_obligation_2       | OK     |
 * | cii_obligation_3   | cii_obligation_3       | OK     |
 * | sg_stricter_than_my | sg_stricter_than_my    | OK     |
 * | cii_obligation_4   | cii_obligation_4       | OK     |
 * | esci_compliance    | esci_compliance        | OK     |
 * | cssp_obligation    | cssp_obligation        | OK     |
 * | sg_cybersecurity_composition | sg_cybersecurity_composition | OK     |
 * | cii_sector_coverage | cii_sector_coverage    | OK     |
 * | entity_classification_coverage | entity_classification_coverage | OK     |
 * | stcc_compliance    | stcc_compliance        | OK     |
 * | cii_owner_strictest | cii_owner_strictest    | OK     |
 * | cii_owner_implies_esci_risk | cii_owner_implies_esci_risk | OK     |
 * | significant_incident_must_notify | significant_incident_must_notify | OK     |
 * | two_hour_deadline_tight | two_hour_deadline_tight | OK     |
 * | sg_2h_stricter_than_my_6h | sg_2h_stricter_than_my_6h | OK     |
 * | sg_2h_stricter_than_72h | sg_2h_stricter_than_72h | OK     |
 * | audit_schedule_valid | audit_schedule_valid   | OK     |
 * | more_controls_still_adequate | more_controls_still_adequate | OK     |
 * | sg_cyber_full_implies_risk | sg_cyber_full_implies_risk | OK     |
 * | sg_cyber_full_implies_audit | sg_cyber_full_implies_audit | OK     |
 * | sg_cyber_full_implies_controls | sg_cyber_full_implies_controls | OK     |
 * | sg_cyber_full_implies_irp | sg_cyber_full_implies_irp | OK     |
 * | cssp_expired_non_compliant | cssp_expired_non_compliant | OK     |
 * | regular_entity_no_cii_obligation | regular_entity_no_cii_obligation | OK     |
 * | compliance_eliminates_penalty | compliance_eliminates_penalty | OK     |
 *)

theory SingaporeCybersecurityAct
  imports Main
begin

(* CIISector (matches Coq: Inductive CIISector) *)
datatype cii_sector =
    SGEnergy
  |     SGWater
  |     SGBankingFinance
  |     SGHealthcare
  |     SGTransportLand
  |     SGTransportMaritime
  |     SGTransportAviation
  |     SGInfocomm
  |     SGMedia
  |     SGSecurityEmergency
  |     SGGovernment

(* EntityClassification (matches Coq: Inductive EntityClassification) *)
datatype entity_classification =
    CIIOwner  (* Critical Information Infrastructure *)
  |     ESCI  (* Entity of Special Cybersecurity Interest *)
  |     STCC  (* System of Temporary Cybersecurity Concern *)
  |     RegularEntity

(* cii_risk_current (matches Coq: Definition cii_risk_current) *)
definition cii_risk_current :: "CIIOwnerEntity \<Rightarrow> bool" where
  "cii_risk_current e \<equiv> cii_risk_assessed e = true"

(* cii_audit_current (matches Coq: Definition cii_audit_current) *)
definition cii_audit_current :: "CIIOwnerEntity \<Rightarrow> nat \<Rightarrow> bool" where
  "cii_audit_current e t \<equiv> cii_audit_completed e = true /\ t <= cii_last_audit e + 365"

(* sg_incident_reported_in_time (matches Coq: Definition sg_incident_reported_in_time) *)
definition sg_incident_reported_in_time :: "SGCyberIncident \<Rightarrow> bool" where
  "sg_incident_reported_in_time i \<equiv> sg_incident_reported_at i <= sg_incident_detected_at i + 2"

(* cii_controls_adequate (matches Coq: Definition cii_controls_adequate) *)
definition cii_controls_adequate :: "CIIOwnerEntity \<Rightarrow> bool" where
  "cii_controls_adequate e \<equiv> cii_min_controls e <= cii_security_controls e"

(* esci_obligations_met (matches Coq: Definition esci_obligations_met) *)
definition esci_obligations_met :: "CIIOwnerEntity \<Rightarrow> bool" where
  "esci_obligations_met e \<equiv> cii_classification e = ESCI ->
  cii_risk_assessed e = true /\ cii_incident_response_plan e = true"

(* cssp_licensed_sg (matches Coq: Definition cssp_licensed_sg) *)
definition cssp_licensed_sg :: "CIIOwnerEntity \<Rightarrow> bool" where
  "cssp_licensed_sg e \<equiv> cii_cssp_licensed e = true"

(* sg_cybersecurity_act_compliant (matches Coq: Definition sg_cybersecurity_act_compliant) *)
definition sg_cybersecurity_act_compliant :: "CIIOwnerEntity \<Rightarrow> nat \<Rightarrow> bool" where
  "sg_cybersecurity_act_compliant e t \<equiv> cii_risk_current e /\
  cii_audit_current e t /\
  cii_controls_adequate e /\
  cii_incident_response_plan e = true"

(* stcc_obligations_met (matches Coq: Definition stcc_obligations_met) *)
definition stcc_obligations_met :: "CIIOwnerEntity \<Rightarrow> bool" where
  "stcc_obligations_met e \<equiv> cii_classification e = STCC ->
  cii_risk_assessed e = true /\
  cii_security_controls e >= cii_min_controls e"

(* cii_owner_obligations (matches Coq: Definition cii_owner_obligations) *)
definition cii_owner_obligations :: "CIIOwnerEntity \<Rightarrow> nat \<Rightarrow> bool" where
  "cii_owner_obligations e t \<equiv> cii_risk_current e /\
  cii_audit_current e t /\
  cii_controls_adequate e /\
  cii_incident_response_plan e = true /\
  cssp_licensed_sg e"

(* incident_needs_notification (matches Coq: Definition incident_needs_notification) *)
definition incident_needs_notification :: "SGCyberIncident \<Rightarrow> bool" where
  "incident_needs_notification i \<equiv> sg_incident_significant i = true"

(* audit_schedule_consistent (matches Coq: Definition audit_schedule_consistent) *)
definition audit_schedule_consistent :: "AuditSchedule \<Rightarrow> bool" where
  "audit_schedule_consistent sched \<equiv> as_next_audit sched = as_last_audit sched + as_audit_interval sched"

(* regular_entity_exempt (matches Coq: Definition regular_entity_exempt) *)
definition regular_entity_exempt :: "CIIOwnerEntity \<Rightarrow> bool" where
  "regular_entity_exempt e \<equiv> cii_classification e = RegularEntity ->
  True"

(* penalty_exposure_exists (matches Coq: Definition penalty_exposure_exists) *)
definition penalty_exposure_exists :: "CIIOwnerEntity \<Rightarrow> nat \<Rightarrow> bool" where
  "penalty_exposure_exists e t \<equiv> ~ sg_cybersecurity_act_compliant e t"

(* cii_obligation_1 (matches Coq) *)
lemma cii_obligation_1: "\<forall> (e : CIIOwnerEntity), cii_risk_assessed e = True \<longrightarrow> cii_risk_current e"
  by auto

(* cii_obligation_2 (matches Coq) *)
lemma cii_obligation_2: "\<forall> (e : CIIOwnerEntity) (t : nat), cii_audit_completed e = True \<longrightarrow> t \<le> cii_last_audit e + 365 \<longrightarrow> cii_audit_current e t"
  by auto

(* cii_obligation_3 (matches Coq) *)
lemma cii_obligation_3: "\<forall> (i : SGCyberIncident), sg_incident_reported_at i \<le> sg_incident_detected_at i + 2 \<longrightarrow> sg_incident_reported_in_time i"
  by auto

(* sg_stricter_than_my (matches Coq) *)
lemma sg_stricter_than_my: "\<forall> (detected_at reported_at : nat), reported_at \<le> detected_at + 2 \<longrightarrow> reported_at \<le> detected_at + 6"
  by auto

(* cii_obligation_4 (matches Coq) *)
lemma cii_obligation_4: "\<forall> (e : CIIOwnerEntity), cii_min_controls e \<le> cii_security_controls e \<longrightarrow> cii_controls_adequate e"
  by auto

(* esci_compliance (matches Coq) *)
lemma esci_compliance: "\<forall> (e : CIIOwnerEntity), cii_classification e = ESCI \<longrightarrow> cii_risk_assessed e = True \<longrightarrow> cii_incident_response_plan e = True \<longrightarrow> esci_obligations_met e"
  by auto

(* cssp_obligation (matches Coq) *)
lemma cssp_obligation: "\<forall> (e : CIIOwnerEntity), cii_cssp_licensed e = True \<longrightarrow> cssp_licensed_sg e"
  by auto

(* sg_cybersecurity_composition (matches Coq) *)
lemma sg_cybersecurity_composition: "\<forall> (e : CIIOwnerEntity) (t : nat), cii_risk_current e \<longrightarrow> cii_audit_current e t \<longrightarrow> cii_controls_adequate e \<longrightarrow> cii_incident_response_plan e = True \<longrightarrow> sg_cybersecurity_act_compliant e t"
  by simp

(* cii_sector_coverage (matches Coq) *)
lemma cii_sector_coverage: "\<forall> (s : CIISector), In s all_cii_sectors"
  by auto

(* entity_classification_coverage (matches Coq) *)
lemma entity_classification_coverage: "\<forall> (c : EntityClassification), In c all_entity_classifications"
  by auto

(* stcc_compliance (matches Coq) *)
lemma stcc_compliance: "\<forall> (e : CIIOwnerEntity), cii_classification e = STCC \<longrightarrow> cii_risk_assessed e = True \<longrightarrow> cii_security_controls e \<ge> cii_min_controls e \<longrightarrow> stcc_obligations_met e"
  by auto

(* cii_owner_strictest (matches Coq) *)
lemma cii_owner_strictest: "\<forall> (e : CIIOwnerEntity) (t : nat), cii_owner_obligations e t \<longrightarrow> cii_risk_current e"
  by auto

(* cii_owner_implies_esci_risk (matches Coq) *)
lemma cii_owner_implies_esci_risk: "\<forall> (e : CIIOwnerEntity) (t : nat), cii_owner_obligations e t \<longrightarrow> cii_risk_assessed e = True \<and> cii_incident_response_plan e = True"
  by auto

(* significant_incident_must_notify (matches Coq) *)
lemma significant_incident_must_notify: "\<forall> (i : SGCyberIncident), sg_incident_significant i = True \<longrightarrow> incident_needs_notification i"
  by auto

(* two_hour_deadline_tight (matches Coq) *)
lemma two_hour_deadline_tight: "\<forall> (detected : nat), detected + 2 < detected + 6"
  by simp

(* sg_2h_stricter_than_my_6h (matches Coq) *)
lemma sg_2h_stricter_than_my_6h: "\<forall> (i : SGCyberIncident), sg_incident_reported_in_time i \<longrightarrow> sg_incident_reported_at i \<le> sg_incident_detected_at i + 6"
  by simp

(* sg_2h_stricter_than_72h (matches Coq) *)
lemma sg_2h_stricter_than_72h: "\<forall> (i : SGCyberIncident), sg_incident_reported_in_time i \<longrightarrow> sg_incident_reported_at i \<le> sg_incident_detected_at i + 72"
  by simp

(* audit_schedule_valid (matches Coq) *)
lemma audit_schedule_valid: "\<forall> (sched : AuditSchedule), as_next_audit sched = as_last_audit sched + as_audit_interval sched \<longrightarrow> audit_schedule_consistent sched"
  by auto

(* more_controls_still_adequate (matches Coq) *)
lemma more_controls_still_adequate: "\<forall> (e : CIIOwnerEntity) (extra : nat), cii_controls_adequate e \<longrightarrow> cii_min_controls e \<le> cii_security_controls e + extra"
  by auto

(* sg_cyber_full_implies_risk (matches Coq) *)
lemma sg_cyber_full_implies_risk: "\<forall> (e : CIIOwnerEntity) (t : nat), sg_cybersecurity_act_compliant e t \<longrightarrow> cii_risk_current e"
  by auto

(* sg_cyber_full_implies_audit (matches Coq) *)
lemma sg_cyber_full_implies_audit: "\<forall> (e : CIIOwnerEntity) (t : nat), sg_cybersecurity_act_compliant e t \<longrightarrow> cii_audit_current e t"
  by auto

(* sg_cyber_full_implies_controls (matches Coq) *)
lemma sg_cyber_full_implies_controls: "\<forall> (e : CIIOwnerEntity) (t : nat), sg_cybersecurity_act_compliant e t \<longrightarrow> cii_controls_adequate e"
  by auto

(* sg_cyber_full_implies_irp (matches Coq) *)
lemma sg_cyber_full_implies_irp: "\<forall> (e : CIIOwnerEntity) (t : nat), sg_cybersecurity_act_compliant e t \<longrightarrow> cii_incident_response_plan e = True"
  by auto

(* cssp_expired_non_compliant (matches Coq) *)
lemma cssp_expired_non_compliant: "\<forall> (e : CIIOwnerEntity), cii_cssp_licensed e = False \<longrightarrow> ~ cssp_licensed_sg e"
  by auto

(* regular_entity_no_cii_obligation (matches Coq) *)
lemma regular_entity_no_cii_obligation: "\<forall> (e : CIIOwnerEntity), cii_classification e = RegularEntity \<longrightarrow> regular_entity_exempt e"
  by auto

(* compliance_eliminates_penalty (matches Coq) *)
lemma compliance_eliminates_penalty: "\<forall> (e : CIIOwnerEntity) (t : nat), sg_cybersecurity_act_compliant e t \<longrightarrow> ~ penalty_exposure_\<exists> e t"
  by auto

end
