(* Copyright (c) 2026 The RIINA Authors. All rights reserved. *)

(*
 * RIINA MalaysiaCybersecurityAct - Isabelle/HOL Port
 *
 * Auto-generated port of 02_FORMAL/coq/domains/MalaysiaCybersecurityAct.v (28 theorems).
 *
 * Generated by scripts/generate-multiprover.py
 *
 * Correspondence Table:
 *
 * | Coq Definition     | Isabelle Definition    | Status |
 * |--------------------|------------------------|--------|
 * | NCIISector         | ncii_sector            | OK     |
 * | RiskLevel          | risk_level             | OK     |
 * | risk_level_nat     | risk_level_nat         | OK     |
 * | risk_assessment_current | risk_assessment_current | OK     |
 * | audit_current      | audit_current          | OK     |
 * | incident_reported_promptly | incident_reported_promptly | OK     |
 * | incident_report_complete | incident_report_complete | OK     |
 * | controls_sufficient | controls_sufficient    | OK     |
 * | cssp_valid         | cssp_valid             | OK     |
 * | act854_compliant   | act854_compliant       | OK     |
 * | ceo_liability_applies | ceo_liability_applies  | OK     |
 * | sector_critical    | sector_critical        | OK     |
 * | obligation_1_risk_assessment | obligation_1_risk_assessment | OK     |
 * | obligation_2_audit | obligation_2_audit     | OK     |
 * | audit_expiry       | audit_expiry           | OK     |
 * | obligation_3_reporting | obligation_3_reporting | OK     |
 * | severity_ordering  | severity_ordering      | OK     |
 * | obligation_4_controls | obligation_4_controls  | OK     |
 * | obligation_5_cssp  | obligation_5_cssp      | OK     |
 * | act854_composition | act854_composition     | OK     |
 * | ncii_sector_coverage | ncii_sector_coverage   | OK     |
 * | critical_is_highest_risk | critical_is_highest_risk | OK     |
 * | low_is_lowest_risk | low_is_lowest_risk     | OK     |
 * | risk_level_bounded | risk_level_bounded     | OK     |
 * | risk_level_coverage | risk_level_coverage    | OK     |
 * | audit_current_expiry_exclusive | audit_current_expiry_exclusive | OK     |
 * | more_controls_still_sufficient | more_controls_still_sufficient | OK     |
 * | act854_implies_risk_assessed | act854_implies_risk_assessed | OK     |
 * | act854_implies_audit_current | act854_implies_audit_current | OK     |
 * | act854_implies_controls | act854_implies_controls | OK     |
 * | act854_implies_cssp_valid | act854_implies_cssp_valid | OK     |
 * | cssp_expired       | cssp_expired           | OK     |
 * | cssp_unlicensed_invalid | cssp_unlicensed_invalid | OK     |
 * | ceo_liable_when_negligent | ceo_liable_when_negligent | OK     |
 * | ceo_due_diligence_defense | ceo_due_diligence_defense | OK     |
 * | incident_6h_stricter_than_24h | incident_6h_stricter_than_24h | OK     |
 * | immediate_report_always_timely | immediate_report_always_timely | OK     |
 * | banking_is_critical | banking_is_critical    | OK     |
 * | defense_is_critical | defense_is_critical    | OK     |
 * | telecom_not_critical | telecom_not_critical   | OK     |
 *)

theory MalaysiaCybersecurityAct
  imports Main
begin

(* NCIISector (matches Coq: Inductive NCIISector) *)
datatype ncii_sector =
    Government
  |     BankingFinance
  |     Transport
  |     Defense
  |     Healthcare
  |     Telecom
  |     Energy
  |     Water
  |     AgricultureFood
  |     ScienceTechInnovation
  |     InformationComm

(* RiskLevel (matches Coq: Inductive RiskLevel) *)
datatype risk_level =
    Low
  |     Medium
  |     High
  |     Critical

(* risk_level_nat (matches Coq: Definition risk_level_nat) *)
fun risk_level_nat :: "RiskLevel \<Rightarrow> nat" where
  "risk_level_nat Medium = 1"
|   "risk_level_nat High = 2"
|   "risk_level_nat Critical = 3"

(* risk_assessment_current (matches Coq: Definition risk_assessment_current) *)
definition risk_assessment_current :: "NCIIEntity \<Rightarrow> bool" where
  "risk_assessment_current e \<equiv> ncii_risk_assessed e = true"

(* audit_current (matches Coq: Definition audit_current) *)
definition audit_current :: "NCIIEntity \<Rightarrow> nat \<Rightarrow> bool" where
  "audit_current e current_time \<equiv> current_time <= ncii_last_audit e + ncii_audit_interval e"

(* incident_reported_promptly (matches Coq: Definition incident_reported_promptly) *)
definition incident_reported_promptly :: "CyberIncident \<Rightarrow> bool" where
  "incident_reported_promptly i \<equiv> incident_reported_at i <= incident_detected_at i + 6"

(* incident_report_complete (matches Coq: Definition incident_report_complete) *)
definition incident_report_complete :: "CyberIncident \<Rightarrow> bool" where
  "incident_report_complete i \<equiv> incident_reported_promptly i /\
  risk_level_nat (incident_severity i) >= 0"

(* controls_sufficient (matches Coq: Definition controls_sufficient) *)
definition controls_sufficient :: "NCIIEntity \<Rightarrow> bool" where
  "controls_sufficient e \<equiv> ncii_min_controls e <= ncii_security_controls e"

(* cssp_valid (matches Coq: Definition cssp_valid) *)
definition cssp_valid :: "CSSPLicense \<Rightarrow> nat \<Rightarrow> bool" where
  "cssp_valid l current_time \<equiv> cssp_licensed l = true /\ current_time <= cssp_license_expiry l"

(* act854_compliant (matches Coq: Definition act854_compliant) *)
definition act854_compliant :: "NCIIEntity \<Rightarrow> CSSPLicense \<Rightarrow> nat \<Rightarrow> bool" where
  "act854_compliant e l t \<equiv> risk_assessment_current e /\
  audit_current e t /\
  controls_sufficient e /\
  cssp_valid l t"

(* ceo_liability_applies (matches Coq: Definition ceo_liability_applies) *)
definition ceo_liability_applies :: "CEOLiability \<Rightarrow> bool" where
  "ceo_liability_applies cl \<equiv> ceo_compliant cl = false ->
  ceo_due_diligence cl = false ->
  ceo_personally_liable cl = true"

(* sector_critical (matches Coq: Definition sector_critical) *)
definition sector_critical :: "NCIISector \<Rightarrow> bool" where
  "sector_critical s \<equiv> s = BankingFinance \/ s = Defense \/ s = Healthcare \/
  s = Energy \/ s = Water \/ s = Government"

(* obligation_1_risk_assessment (matches Coq) *)
lemma obligation_1_risk_assessment: "\<forall> (e : NCIIEntity), ncii_risk_assessed e = True \<longrightarrow> risk_assessment_current e"
  by auto

(* obligation_2_audit (matches Coq) *)
lemma obligation_2_audit: "\<forall> (e : NCIIEntity) (t : nat), t \<le> ncii_last_audit e + ncii_audit_interval e \<longrightarrow> audit_current e t"
  by auto

(* audit_expiry (matches Coq) *)
lemma audit_expiry: "\<forall> (e : NCIIEntity) (t : nat), ~ audit_current e t \<longrightarrow> ncii_last_audit e + ncii_audit_interval e < t"
  by auto

(* obligation_3_reporting (matches Coq) *)
lemma obligation_3_reporting: "\<forall> (i : CyberIncident), incident_reported_at i \<le> incident_detected_at i + 6 \<longrightarrow> incident_reported_promptly i"
  by auto

(* severity_ordering (matches Coq) *)
lemma severity_ordering: "\<forall> (s1 s2 : RiskLevel), risk_level_nat Critical \<ge> risk_level_nat s1"
  by auto

(* obligation_4_controls (matches Coq) *)
lemma obligation_4_controls: "\<forall> (e : NCIIEntity), ncii_min_controls e \<le> ncii_security_controls e \<longrightarrow> controls_sufficient e"
  by auto

(* obligation_5_cssp (matches Coq) *)
lemma obligation_5_cssp: "\<forall> (l : CSSPLicense) (t : nat), cssp_licensed l = True \<longrightarrow> t \<le> cssp_license_expiry l \<longrightarrow> cssp_valid l t"
  by auto

(* act854_composition (matches Coq) *)
lemma act854_composition: "\<forall> (e : NCIIEntity) (l : CSSPLicense) (t : nat), risk_assessment_current e \<longrightarrow> audit_current e t \<longrightarrow> controls_sufficient e \<longrightarrow> cssp_valid l t \<longrightarrow> act854_compliant e l t"
  by (cases rule: ‹_›.cases; simp)

(* ncii_sector_coverage (matches Coq) *)
lemma ncii_sector_coverage: "\<forall> (s : NCIISector), In s all_ncii_sectors"
  by auto

(* critical_is_highest_risk (matches Coq) *)
lemma critical_is_highest_risk: "\<forall> (r : RiskLevel), risk_level_nat r \<le> risk_level_nat Critical"
  by (cases rule: ‹_›.cases; simp)

(* low_is_lowest_risk (matches Coq) *)
lemma low_is_lowest_risk: "\<forall> (r : RiskLevel), risk_level_nat Low \<le> risk_level_nat r"
  by (cases rule: ‹_›.cases; simp)

(* risk_level_bounded (matches Coq) *)
lemma risk_level_bounded: "\<forall> (r : RiskLevel), risk_level_nat r \<le> 3"
  by (cases rule: ‹_›.cases; simp)

(* risk_level_coverage (matches Coq) *)
lemma risk_level_coverage: "\<forall> (r : RiskLevel), In r all_risk_levels"
  by auto

(* audit_current_expiry_exclusive (matches Coq) *)
lemma audit_current_expiry_exclusive: "\<forall> (e : NCIIEntity) (t : nat), audit_current e t \<or> ~ audit_current e t"
  by (cases rule: ‹_›.cases; simp)

(* more_controls_still_sufficient (matches Coq) *)
lemma more_controls_still_sufficient: "\<forall> (e : NCIIEntity) (extra : nat), controls_sufficient e \<longrightarrow> ncii_min_controls e \<le> ncii_security_controls e + extra"
  by auto

(* act854_implies_risk_assessed (matches Coq) *)
lemma act854_implies_risk_assessed: "\<forall> (e : NCIIEntity) (l : CSSPLicense) (t : nat), act854_compliant e l t \<longrightarrow> risk_assessment_current e"
  by auto

(* act854_implies_audit_current (matches Coq) *)
lemma act854_implies_audit_current: "\<forall> (e : NCIIEntity) (l : CSSPLicense) (t : nat), act854_compliant e l t \<longrightarrow> audit_current e t"
  by auto

(* act854_implies_controls (matches Coq) *)
lemma act854_implies_controls: "\<forall> (e : NCIIEntity) (l : CSSPLicense) (t : nat), act854_compliant e l t \<longrightarrow> controls_sufficient e"
  by auto

(* act854_implies_cssp_valid (matches Coq) *)
lemma act854_implies_cssp_valid: "\<forall> (e : NCIIEntity) (l : CSSPLicense) (t : nat), act854_compliant e l t \<longrightarrow> cssp_valid l t"
  by auto

(* cssp_expired (matches Coq) *)
lemma cssp_expired: "\<forall> (l : CSSPLicense) (t : nat), cssp_license_expiry l < t \<longrightarrow> ~ cssp_valid l t"
  by simp

(* cssp_unlicensed_invalid (matches Coq) *)
lemma cssp_unlicensed_invalid: "\<forall> (l : CSSPLicense) (t : nat), cssp_licensed l = False \<longrightarrow> ~ cssp_valid l t"
  by auto

(* ceo_liable_when_negligent (matches Coq) *)
lemma ceo_liable_when_negligent: "\<forall> (cl : CEOLiability), ceo_compliant cl = False \<longrightarrow> ceo_due_diligence cl = False \<longrightarrow> ceo_personally_liable cl = True \<longrightarrow> ceo_liability_applies cl"
  by simp

(* ceo_due_diligence_defense (matches Coq) *)
lemma ceo_due_diligence_defense: "\<forall> (cl : CEOLiability), ceo_due_diligence cl = True \<longrightarrow> ~ (ceo_due_diligence cl = False)"
  by auto

(* incident_6h_stricter_than_24h (matches Coq) *)
lemma incident_6h_stricter_than_24h: "\<forall> (i : CyberIncident), incident_reported_promptly i \<longrightarrow> incident_reported_at i \<le> incident_detected_at i + 24"
  by simp

(* immediate_report_always_timely (matches Coq) *)
lemma immediate_report_always_timely: "\<forall> (i : CyberIncident), incident_reported_at i = incident_detected_at i \<longrightarrow> incident_reported_promptly i"
  by simp

(* banking_is_critical (matches Coq) *)
lemma banking_is_critical: "sector_critical BankingFinance"
  by simp

(* defense_is_critical (matches Coq) *)
lemma defense_is_critical: "sector_critical Defense"
  by simp

(* telecom_not_critical (matches Coq) *)
lemma telecom_not_critical: "~ sector_critical Telecom"
  by auto

end
