(* Copyright (c) 2026 The RIINA Authors. All rights reserved. *)

(*
 * RIINA MLTTFoundation - Isabelle/HOL Port
 *
 * Auto-generated port of 02_FORMAL/coq/domains/MLTTFoundation.v (25 theorems).
 *
 * Generated by scripts/generate-multiprover.py
 *
 * Correspondence Table:
 *
 * | Coq Definition     | Isabelle Definition    | Status |
 * |--------------------|------------------------|--------|
 * | Ty                 | ty                     | OK     |
 * | Term               | term                   | OK     |
 * | empty_ctx          | empty_ctx              | OK     |
 * | ctx_extend         | ctx_extend             | OK     |
 * | cumulativity_level | cumulativity_level     | OK     |
 * | TYPE_001_01        | TYPE_001_01            | OK     |
 * | TYPE_001_02        | TYPE_001_02            | OK     |
 * | TYPE_001_03        | TYPE_001_03            | OK     |
 * | TYPE_001_04        | TYPE_001_04            | OK     |
 * | TYPE_001_05        | TYPE_001_05            | OK     |
 * | TYPE_001_06        | TYPE_001_06            | OK     |
 * | TYPE_001_07        | TYPE_001_07            | OK     |
 * | TYPE_001_08        | TYPE_001_08            | OK     |
 * | TYPE_001_09        | TYPE_001_09            | OK     |
 * | TYPE_001_10        | TYPE_001_10            | OK     |
 * | type_uniqueness_eq | type_uniqueness_eq     | OK     |
 * | TYPE_001_11        | TYPE_001_11            | OK     |
 * | TYPE_001_12        | TYPE_001_12            | OK     |
 * | TYPE_001_13        | TYPE_001_13            | OK     |
 * | TYPE_001_14        | TYPE_001_14            | OK     |
 * | red_star_trans     | red_star_trans         | OK     |
 * | red_star_app       | red_star_app           | OK     |
 * | red_star_lam       | red_star_lam           | OK     |
 * | red_star_pair      | red_star_pair          | OK     |
 * | red_star_fst       | red_star_fst           | OK     |
 * | red_star_snd       | red_star_snd           | OK     |
 * | red_star_refl_tm   | red_star_refl_tm       | OK     |
 * | red_star_J         | red_star_J             | OK     |
 * | TYPE_001_15        | TYPE_001_15            | OK     |
 *)

theory MLTTFoundation
  imports Main
begin

(* Ty (matches Coq: Inductive Ty) *)
datatype ty =
    TUnit
  |     TPi  (* Π-type: Π(x:A).B *)
  |     TSigma  (* Σ-type: Σ(x:A).B *)
  |     TId  (* Identity type *)
  |     TUniverse  (* Universe at level l *)

(* Term (matches Coq: Inductive Term) *)
datatype term =
    TmVar
  |     TmUnit  (* Unit value *)
  |     TmLam  (* λ-abstraction with type annotation *)
  |     TmApp  (* Application *)
  |     TmPair  (* Pair introduction *)
  |     TmFst  (* First projection *)
  |     TmSnd  (* Second projection *)
  |     TmRefl  (* Reflexivity proof: refl(a) *)
  |     TmJ  (* J-eliminator with type annotations *)

(* empty_ctx (matches Coq: Definition empty_ctx) *)
definition empty_ctx :: "Ctx" where
  "empty_ctx \<equiv> []"

(* ctx_extend (matches Coq: Definition ctx_extend) *)
definition ctx_extend :: "Ctx \<Rightarrow> Ty \<Rightarrow> Ctx" where
  "ctx_extend G A \<equiv> A :: G"

(* cumulativity_level (matches Coq) *)
lemma cumulativity_level: "\<forall> A l, has_level A l \<longrightarrow> has_level A (S l)"
  by simp

(* TYPE_001_01 (matches Coq) *)
lemma TYPE_001_01: "\<forall> (G : Ctx) (A B : Ty), wf_ctx G \<longrightarrow> wf_ty G A \<longrightarrow> wf_ty (ctx_extend G A) B \<longrightarrow> wf_ty G (TPi A B)"
  by auto

(* TYPE_001_02 (matches Coq) *)
lemma TYPE_001_02: "\<forall> (G : Ctx) (A B : Ty) (f a : Term), has_type G f (TPi A B) \<longrightarrow> has_type G a A \<longrightarrow> has_type G (TmApp f a) B"
  by auto

(* TYPE_001_03 (matches Coq) *)
lemma TYPE_001_03: "\<forall> (G : Ctx) (A B : Ty) (a b : Term), wf_ty G (TSigma A B) \<longrightarrow> has_type G a A \<longrightarrow> has_type G b B \<longrightarrow> has_type G (TmPair a b) (TSigma A B)"
  by auto

(* TYPE_001_04 (matches Coq) *)
lemma TYPE_001_04: "\<forall> (G : Ctx) (A B : Ty) (p : Term), has_type G p (TSigma A B) \<longrightarrow> has_type G (TmFst p) A \<and> has_type G (TmSnd p) B"
  by auto

(* TYPE_001_05 (matches Coq) *)
lemma TYPE_001_05: "\<forall> (G : Ctx) (A : Ty) (a : Term), wf_ty G A \<longrightarrow> has_type G a A \<longrightarrow> has_type G (TmRefl a) (TId A)"
  by auto

(* TYPE_001_06 (matches Coq) *)
lemma TYPE_001_06: "\<forall> (G : Ctx) (A : Ty) (C : Ty) (d p : Term), wf_ty G A \<longrightarrow> has_type G d C \<longrightarrow> has_type G p (TId A) \<longrightarrow> has_type G (TmJ A C d p) C"
  by auto

(* TYPE_001_07 (matches Coq) *)
lemma TYPE_001_07: "\<forall> l, has_level (TUniverse l) (S l)"
  by simp

(* TYPE_001_08 (matches Coq) *)
lemma TYPE_001_08: "\<forall> (A : Ty) (l : Level), has_level A l \<longrightarrow> has_level A (S l)"
  by auto

(* TYPE_001_09 (matches Coq) *)
lemma TYPE_001_09: "\<forall> (G : Ctx) (A : Ty), wf_ctx G \<longrightarrow> wf_ctx (ctx_extend G A)"
  by auto

(* TYPE_001_10 (matches Coq) *)
lemma TYPE_001_10: "\<forall> t1 t2 n s, term_eq t1 t2 \<longrightarrow> term_eq (subst n s t1) (subst n s t2)"
  by auto

(* type_uniqueness_eq (matches Coq) *)
lemma type_uniqueness_eq: "\<forall> (G : Ctx) t A B, has_type G t A \<longrightarrow> has_type G t B \<longrightarrow> A = B"
  by simp

(* TYPE_001_11 (matches Coq) *)
lemma TYPE_001_11: "\<forall> (G : Ctx) t A B, has_type G t A \<longrightarrow> has_type G t B \<longrightarrow> ty_eq A B"
  by auto

(* TYPE_001_12 (matches Coq) *)
lemma TYPE_001_12: "\<forall> A t a, comp_eq (TmApp (TmLam A t) a) (subst 0 a t)"
  by auto

(* TYPE_001_13 (matches Coq) *)
lemma TYPE_001_13: "\<forall> A f, comp_eq (TmLam A (TmApp (shift 0 1 f) (TmVar 0))) f"
  by auto

(* TYPE_001_14 (matches Coq) *)
lemma TYPE_001_14: "\<forall> p, comp_eq (TmPair (TmFst p) (TmSnd p)) p"
  by auto

(* red_star_trans (matches Coq) *)
lemma red_star_trans: "\<forall> t u v, reduces_star t u \<longrightarrow> reduces_star u v \<longrightarrow> reduces_star t v"
  by auto

(* red_star_app (matches Coq) *)
lemma red_star_app: "\<forall> f f' a a', reduces_star f f' \<longrightarrow> reduces_star a a' \<longrightarrow> reduces_star (TmApp f a) (TmApp f' a')"
  by auto

(* red_star_lam (matches Coq) *)
lemma red_star_lam: "\<forall> A body body', reduces_star body body' \<longrightarrow> reduces_star (TmLam A body) (TmLam A body')"
  by auto

(* red_star_pair (matches Coq) *)
lemma red_star_pair: "\<forall> a a' b b', reduces_star a a' \<longrightarrow> reduces_star b b' \<longrightarrow> reduces_star (TmPair a b) (TmPair a' b')"
  by auto

(* red_star_fst (matches Coq) *)
lemma red_star_fst: "\<forall> p p', reduces_star p p' \<longrightarrow> reduces_star (TmFst p) (TmFst p')"
  by auto

(* red_star_snd (matches Coq) *)
lemma red_star_snd: "\<forall> p p', reduces_star p p' \<longrightarrow> reduces_star (TmSnd p) (TmSnd p')"
  by auto

(* red_star_refl_tm (matches Coq) *)
lemma red_star_refl_tm: "\<forall> a a', reduces_star a a' \<longrightarrow> reduces_star (TmRefl a) (TmRefl a')"
  by auto

(* red_star_J (matches Coq) *)
lemma red_star_J: "\<forall> A C d d' p p', reduces_star d d' \<longrightarrow> reduces_star p p' \<longrightarrow> reduces_star (TmJ A C d p) (TmJ A C d' p')"
  by auto

(* TYPE_001_15 (matches Coq) *)
lemma TYPE_001_15: "\<forall> t, (\<exists> nf, reduces_star t nf \<and> (normal nf \<or> neutral nf))"
  by auto

end
