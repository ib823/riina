(* Copyright (c) 2026 The RIINA Authors. All rights reserved. *)

(*
 * RIINA SingaporeMAS_TRM - Isabelle/HOL Port
 *
 * Auto-generated port of 02_FORMAL/coq/domains/SingaporeMAS_TRM.v (21 theorems).
 *
 * Generated by scripts/generate-multiprover.py
 *
 * Correspondence Table:
 *
 * | Coq Definition     | Isabelle Definition    | Status |
 * |--------------------|------------------------|--------|
 * | MASLicenseType     | mas_license_type       | OK     |
 * | PatchCriticality   | patch_criticality      | OK     |
 * | patch_deadline     | patch_deadline         | OK     |
 * | cyber_hygiene_mfa  | cyber_hygiene_mfa      | OK     |
 * | cyber_hygiene_patching | cyber_hygiene_patching | OK     |
 * | cyber_hygiene_network | cyber_hygiene_network  | OK     |
 * | cyber_hygiene_antimalware | cyber_hygiene_antimalware | OK     |
 * | cyber_hygiene_pam  | cyber_hygiene_pam      | OK     |
 * | cyber_hygiene_compliant | cyber_hygiene_compliant | OK     |
 * | patch_applied_in_time | patch_applied_in_time  | OK     |
 * | trm_governance     | trm_governance         | OK     |
 * | trm_security_testing | trm_security_testing   | OK     |
 * | trm_resilience     | trm_resilience         | OK     |
 * | mas_fully_compliant | mas_fully_compliant    | OK     |
 * | count_mas_controls | count_mas_controls     | OK     |
 * | mas_cyber_hygiene  | mas_cyber_hygiene      | OK     |
 * | critical_patch_14_days | critical_patch_14_days | OK     |
 * | critical_strictest | critical_strictest     | OK     |
 * | trm_governance_proof | trm_governance_proof   | OK     |
 * | mas_composition    | mas_composition        | OK     |
 * | mas_license_coverage | mas_license_coverage   | OK     |
 * | ch_requires_mfa    | ch_requires_mfa        | OK     |
 * | ch_requires_patching | ch_requires_patching   | OK     |
 * | ch_requires_network | ch_requires_network    | OK     |
 * | ch_requires_antimalware | ch_requires_antimalware | OK     |
 * | ch_requires_pam    | ch_requires_pam        | OK     |
 * | patch_critical_strictest | patch_critical_strictest | OK     |
 * | patch_low_most_lenient | patch_low_most_lenient | OK     |
 * | patch_deadline_positive | patch_deadline_positive | OK     |
 * | patch_critical_subsumes_all | patch_critical_subsumes_all | OK     |
 * | mas_full_requires_hygiene | mas_full_requires_hygiene | OK     |
 * | mas_full_requires_governance | mas_full_requires_governance | OK     |
 * | mas_full_requires_testing | mas_full_requires_testing | OK     |
 * | mas_full_requires_resilience | mas_full_requires_resilience | OK     |
 * | count_mas_bounded  | count_mas_bounded      | OK     |
 * | mas_seven_licenses | mas_seven_licenses     | OK     |
 *)

theory SingaporeMAS_TRM
  imports Main
begin

(* MASLicenseType (matches Coq: Inductive MASLicenseType) *)
datatype mas_license_type =
    FullBank
  |     WholesaleBank
  |     MerchantBank
  |     InsuranceCo
  |     CapitalMarketsServices
  |     PaymentInstitution
  |     MajorPaymentInstitution

(* PatchCriticality (matches Coq: Inductive PatchCriticality) *)
datatype patch_criticality =
    PatchCritical  (* ≤14 days *)
  |     PatchHigh  (* ≤30 days *)
  |     PatchMedium  (* ≤60 days *)
  |     PatchLow

(* patch_deadline (matches Coq: Definition patch_deadline) *)
fun patch_deadline :: "PatchCriticality \<Rightarrow> nat" where
  "patch_deadline PatchCritical = 14"
|   "patch_deadline PatchHigh = 30"
|   "patch_deadline PatchMedium = 60"
|   "patch_deadline PatchLow = 90"

(* cyber_hygiene_mfa (matches Coq: Definition cyber_hygiene_mfa) *)
definition cyber_hygiene_mfa :: "MASRegulatedEntity \<Rightarrow> bool" where
  "cyber_hygiene_mfa e \<equiv> mas_mfa_enabled e = true"

(* cyber_hygiene_patching (matches Coq: Definition cyber_hygiene_patching) *)
definition cyber_hygiene_patching :: "MASRegulatedEntity \<Rightarrow> bool" where
  "cyber_hygiene_patching e \<equiv> mas_patching_current e = true"

(* cyber_hygiene_network (matches Coq: Definition cyber_hygiene_network) *)
definition cyber_hygiene_network :: "MASRegulatedEntity \<Rightarrow> bool" where
  "cyber_hygiene_network e \<equiv> mas_network_secured e = true"

(* cyber_hygiene_antimalware (matches Coq: Definition cyber_hygiene_antimalware) *)
definition cyber_hygiene_antimalware :: "MASRegulatedEntity \<Rightarrow> bool" where
  "cyber_hygiene_antimalware e \<equiv> mas_antimalware e = true"

(* cyber_hygiene_pam (matches Coq: Definition cyber_hygiene_pam) *)
definition cyber_hygiene_pam :: "MASRegulatedEntity \<Rightarrow> bool" where
  "cyber_hygiene_pam e \<equiv> mas_privileged_access_managed e = true"

(* cyber_hygiene_compliant (matches Coq: Definition cyber_hygiene_compliant) *)
definition cyber_hygiene_compliant :: "MASRegulatedEntity \<Rightarrow> bool" where
  "cyber_hygiene_compliant e \<equiv> cyber_hygiene_mfa e /\
  cyber_hygiene_patching e /\
  cyber_hygiene_network e /\
  cyber_hygiene_antimalware e /\
  cyber_hygiene_pam e"

(* patch_applied_in_time (matches Coq: Definition patch_applied_in_time) *)
definition patch_applied_in_time :: "PatchCriticality \<Rightarrow> bool" where
  "patch_applied_in_time criticality \<equiv> applied_at <= discovered_at + patch_deadline criticality"

(* trm_governance (matches Coq: Definition trm_governance) *)
definition trm_governance :: "MASRegulatedEntity \<Rightarrow> bool" where
  "trm_governance e \<equiv> mas_board_oversight e = true /\
  mas_risk_assessment_done e = true"

(* trm_security_testing (matches Coq: Definition trm_security_testing) *)
definition trm_security_testing :: "MASRegulatedEntity \<Rightarrow> bool" where
  "trm_security_testing e \<equiv> mas_pen_test_done e = true"

(* trm_resilience (matches Coq: Definition trm_resilience) *)
definition trm_resilience :: "MASRegulatedEntity \<Rightarrow> bool" where
  "trm_resilience e \<equiv> mas_incident_response_plan e = true /\
  mas_bcp_tested e = true"

(* mas_fully_compliant (matches Coq: Definition mas_fully_compliant) *)
definition mas_fully_compliant :: "MASRegulatedEntity \<Rightarrow> bool" where
  "mas_fully_compliant e \<equiv> cyber_hygiene_compliant e /\
  trm_governance e /\
  trm_security_testing e /\
  trm_resilience e"

(* count_mas_controls (matches Coq: Definition count_mas_controls) *)
definition count_mas_controls :: "MASRegulatedEntity \<Rightarrow> nat" where
  "count_mas_controls e \<equiv> (if mas_mfa_enabled e then 1 else 0) +
  (if mas_patching_current e then 1 else 0) +
  (if mas_network_secured e then 1 else 0) +
  (if mas_antimalware e then 1 else 0) +
  (if mas_privileged_access_managed e then 1 else 0) +
  (if mas_board_oversight e then 1 else 0) +
  (if mas_risk_assessment_done e then 1 else 0) +
  (if mas_pen_test_done e then 1 else 0) +
  (if mas_incident_response_plan e then 1 else 0) +
  (if mas_bcp_tested e then 1 else 0)"

(* mas_cyber_hygiene (matches Coq) *)
lemma mas_cyber_hygiene: "\<forall> (e : MASRegulatedEntity), mas_mfa_enabled e = True \<longrightarrow> mas_patching_current e = True \<longrightarrow> mas_network_secured e = True \<longrightarrow> mas_antimalware e = True \<longrightarrow> mas_privileged_access_managed e = True \<longrightarrow> cyber_hygiene_compliant e"
  by simp

(* critical_patch_14_days (matches Coq) *)
lemma critical_patch_14_days: "\<forall> (d a : nat), a \<le> d + 14 \<longrightarrow> patch_applied_in_time PatchCritical d a"
  by auto

(* critical_strictest (matches Coq) *)
lemma critical_strictest: "\<forall> (d a : nat), patch_applied_in_time PatchCritical d a \<longrightarrow> patch_applied_in_time PatchHigh d a"
  by simp

(* trm_governance_proof (matches Coq) *)
lemma trm_governance_proof: "\<forall> (e : MASRegulatedEntity), mas_board_oversight e = True \<longrightarrow> mas_risk_assessment_done e = True \<longrightarrow> trm_governance e"
  by auto

(* mas_composition (matches Coq) *)
lemma mas_composition: "\<forall> (e : MASRegulatedEntity), cyber_hygiene_compliant e \<longrightarrow> trm_governance e \<longrightarrow> trm_security_testing e \<longrightarrow> trm_resilience e \<longrightarrow> mas_fully_compliant e"
  by simp

(* mas_license_coverage (matches Coq) *)
lemma mas_license_coverage: "\<forall> (l : MASLicenseType), In l all_mas_license_types"
  by auto

(* Cyber hygiene field decomposition *)
(* ch_requires_mfa (matches Coq) *)
lemma ch_requires_mfa: "\<forall> e, cyber_hygiene_compliant e \<longrightarrow> mas_mfa_enabled e = True"
  by auto

(* ch_requires_patching (matches Coq) *)
lemma ch_requires_patching: "\<forall> e, cyber_hygiene_compliant e \<longrightarrow> mas_patching_current e = True"
  by auto

(* ch_requires_network (matches Coq) *)
lemma ch_requires_network: "\<forall> e, cyber_hygiene_compliant e \<longrightarrow> mas_network_secured e = True"
  by auto

(* ch_requires_antimalware (matches Coq) *)
lemma ch_requires_antimalware: "\<forall> e, cyber_hygiene_compliant e \<longrightarrow> mas_antimalware e = True"
  by auto

(* ch_requires_pam (matches Coq) *)
lemma ch_requires_pam: "\<forall> e, cyber_hygiene_compliant e \<longrightarrow> mas_privileged_access_managed e = True"
  by auto

(* Patch deadline ordering *)
(* patch_critical_strictest (matches Coq) *)
lemma patch_critical_strictest: "\<forall> p, patch_deadline PatchCritical \<le> patch_deadline p"
  by (cases rule: ‹_›.cases; simp)

(* patch_low_most_lenient (matches Coq) *)
lemma patch_low_most_lenient: "\<forall> p, patch_deadline p \<le> patch_deadline PatchLow"
  by (cases rule: ‹_›.cases; simp)

(* patch_deadline_positive (matches Coq) *)
lemma patch_deadline_positive: "\<forall> p, patch_deadline p \<ge> 14"
  by (cases rule: ‹_›.cases; simp)

(* Patch subsumption: if applied in time for critical, then in time for any *)
(* patch_critical_subsumes_all (matches Coq) *)
lemma patch_critical_subsumes_all: "\<forall> d a p, patch_applied_in_time PatchCritical d a \<longrightarrow> patch_applied_in_time p d a"
  by (cases rule: ‹_›.cases; simp)

(* Full compliance decomposition *)
(* mas_full_requires_hygiene (matches Coq) *)
lemma mas_full_requires_hygiene: "\<forall> e, mas_fully_compliant e \<longrightarrow> cyber_hygiene_compliant e"
  by auto

(* mas_full_requires_governance (matches Coq) *)
lemma mas_full_requires_governance: "\<forall> e, mas_fully_compliant e \<longrightarrow> trm_governance e"
  by auto

(* mas_full_requires_testing (matches Coq) *)
lemma mas_full_requires_testing: "\<forall> e, mas_fully_compliant e \<longrightarrow> trm_security_testing e"
  by auto

(* mas_full_requires_resilience (matches Coq) *)
lemma mas_full_requires_resilience: "\<forall> e, mas_fully_compliant e \<longrightarrow> trm_resilience e"
  by auto

(* count_mas_bounded (matches Coq) *)
lemma count_mas_bounded: "\<forall> e, count_mas_controls e \<le> 10"
  by (cases rule: ‹_›.cases; simp)

(* License type count *)
(* mas_seven_licenses (matches Coq) *)
lemma mas_seven_licenses: "length all_mas_license_types = 7"
  by simp

end
