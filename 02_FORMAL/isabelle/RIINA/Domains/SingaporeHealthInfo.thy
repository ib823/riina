(* SPDX-License-Identifier: MPL-2.0 *)
(* Copyright (c) 2026 The RIINA Authors. See AUTHORS file. *)

(*
 * RIINA SingaporeHealthInfo - Isabelle/HOL Port
 *
 * Auto-generated port of 02_FORMAL/coq/domains/SingaporeHealthInfo.v (28 theorems).
 *
 * Generated by scripts/generate-multiprover.py
 *
 * Correspondence Table:
 *
 * | Coq Definition     | Isabelle Definition    | Status |
 * |--------------------|------------------------|--------|
 * | SGHealthcareProvider | sg_healthcare_provider | OK     |
 * | HealthInfoCategory | health_info_category   | OK     |
 * | UseType            | use_type               | OK     |
 * | hib_cybersecurity  | hib_cybersecurity      | OK     |
 * | nehr_sharing_compliant | nehr_sharing_compliant | OK     |
 * | hib_audit_compliant | hib_audit_compliant    | OK     |
 * | sg_health_sensitive | sg_health_sensitive    | OK     |
 * | sensitive_health_protected | sensitive_health_protected | OK     |
 * | use_permitted      | use_permitted          | OK     |
 * | hib_fully_compliant | hib_fully_compliant    | OK     |
 * | hib_access_deadline | hib_access_deadline    | OK     |
 * | patient_access_fulfilled | patient_access_fulfilled | OK     |
 * | correction_properly_logged | correction_properly_logged | OK     |
 * | exchange_authorized | exchange_authorized    | OK     |
 * | hib_penalty_exposure | hib_penalty_exposure   | OK     |
 * | public_hospital_nehr_mandatory | public_hospital_nehr_mandatory | OK     |
 * | hib_req_1          | hib_req_1              | OK     |
 * | hib_req_2          | hib_req_2              | OK     |
 * | hib_req_3          | hib_req_3              | OK     |
 * | hib_req_4          | hib_req_4              | OK     |
 * | hib_prohibited_insurance | hib_prohibited_insurance | OK     |
 * | hib_prohibited_employment | hib_prohibited_employment | OK     |
 * | hib_treatment_allowed | hib_treatment_allowed  | OK     |
 * | hib_composition    | hib_composition        | OK     |
 * | sg_provider_coverage | sg_provider_coverage   | OK     |
 * | health_category_coverage | health_category_coverage | OK     |
 * | patient_access_right | patient_access_right   | OK     |
 * | patient_access_late_violation | patient_access_late_violation | OK     |
 * | data_correction_logged | data_correction_logged | OK     |
 * | cross_institutional_exchange | cross_institutional_exchange | OK     |
 * | general_health_not_sensitive | general_health_not_sensitive | OK     |
 * | mental_health_is_sensitive | mental_health_is_sensitive | OK     |
 * | hiv_sti_is_sensitive | hiv_sti_is_sensitive   | OK     |
 * | genetic_info_is_sensitive | genetic_info_is_sensitive | OK     |
 * | nehr_requires_encryption | nehr_requires_encryption | OK     |
 * | nehr_requires_sharing | nehr_requires_sharing  | OK     |
 * | use_type_coverage  | use_type_coverage      | OK     |
 * | research_allowed   | research_allowed       | OK     |
 * | public_health_allowed | public_health_allowed  | OK     |
 * | hib_full_implies_cybersecurity | hib_full_implies_cybersecurity | OK     |
 * | hib_full_implies_audit | hib_full_implies_audit | OK     |
 * | hib_full_implies_nehr | hib_full_implies_nehr  | OK     |
 * | cybersecurity_eliminates_penalty | cybersecurity_eliminates_penalty | OK     |
 * | public_hospital_must_share | public_hospital_must_share | OK     |
 *)

theory SingaporeHealthInfo
  imports Main
begin

(* SGHealthcareProvider (matches Coq: Inductive SGHealthcareProvider) *)
datatype sg_healthcare_provider =
    PublicHospital
  |     PrivateHospital
  |     GPClinic
  |     SpecialistClinic
  |     Polyclinic
  |     Pharmacy_SG

(* HealthInfoCategory (matches Coq: Inductive HealthInfoCategory) *)
datatype health_info_category =
    GeneralHealth
  |     MentalHealthSG
  |     HIV_STI_SG
  |     GeneticInfo
  |     SubstanceAbuse

(* UseType (matches Coq: Inductive UseType) *)
datatype use_type =
    Treatment
  |     Research
  |     PublicHealth
  |     InsuranceUnderwriting  (* PROHIBITED *)
  |     Employment

(* hib_cybersecurity (matches Coq: Definition hib_cybersecurity) *)
definition hib_cybersecurity :: "SGHealthRecord \<Rightarrow> bool" where
  "hib_cybersecurity r \<equiv> sgh_encrypted r = true /\
  sgh_access_controlled r = true /\
  sgh_cybersecurity_adequate r = true"

(* nehr_sharing_compliant (matches Coq: Definition nehr_sharing_compliant) *)
definition nehr_sharing_compliant :: "SGHealthRecord \<Rightarrow> bool" where
  "nehr_sharing_compliant r \<equiv> sgh_nehr_shared r = true /\ sgh_encrypted r = true"

(* hib_audit_compliant (matches Coq: Definition hib_audit_compliant) *)
definition hib_audit_compliant :: "SGHealthRecord \<Rightarrow> bool" where
  "hib_audit_compliant r \<equiv> sgh_audit_logged r = true"

(* sg_health_sensitive (matches Coq: Definition sg_health_sensitive) *)
definition sg_health_sensitive :: "HealthInfoCategory \<Rightarrow> bool" where
  "sg_health_sensitive c \<equiv> c = MentalHealthSG \/ c = HIV_STI_SG \/ c = GeneticInfo \/ c = SubstanceAbuse"

(* sensitive_health_protected (matches Coq: Definition sensitive_health_protected) *)
definition sensitive_health_protected :: "SGHealthRecord \<Rightarrow> bool" where
  "sensitive_health_protected r \<equiv> sg_health_sensitive (sgh_category r) ->
  hib_cybersecurity r /\ hib_audit_compliant r"

(* use_permitted (matches Coq: Definition use_permitted) *)
fun use_permitted :: "UseType \<Rightarrow> bool" where
  "use_permitted Treatment = True"
|   "use_permitted Research = True"
|   "use_permitted PublicHealth = True"
|   "use_permitted InsuranceUnderwriting = False"
|   "use_permitted Employment = False"

(* hib_fully_compliant (matches Coq: Definition hib_fully_compliant) *)
definition hib_fully_compliant :: "SGHealthRecord \<Rightarrow> bool" where
  "hib_fully_compliant r \<equiv> hib_cybersecurity r /\
  hib_audit_compliant r /\
  nehr_sharing_compliant r"

(* hib_access_deadline (matches Coq: Definition hib_access_deadline) *)
definition hib_access_deadline :: "nat" where
  "hib_access_deadline \<equiv> 504"

(* patient_access_fulfilled (matches Coq: Definition patient_access_fulfilled) *)
definition patient_access_fulfilled :: "PatientAccessRequest \<Rightarrow> bool" where
  "patient_access_fulfilled req \<equiv> par_responded_at req <= par_requested_at req + hib_access_deadline /\
  par_data_provided req = true"

(* correction_properly_logged (matches Coq: Definition correction_properly_logged) *)
definition correction_properly_logged :: "HealthDataCorrection \<Rightarrow> bool" where
  "correction_properly_logged c \<equiv> hdc_audit_logged c = true /\
  hdc_old_value_hash c <> hdc_new_value_hash c"

(* exchange_authorized (matches Coq: Definition exchange_authorized) *)
definition exchange_authorized :: "HealthDataExchange \<Rightarrow> bool" where
  "exchange_authorized ex \<equiv> hde_patient_consent ex = true /\
  hde_encrypted ex = true /\
  hde_purpose_treatment ex = true /\
  hde_audit_logged_exchange ex = true"

(* hib_penalty_exposure (matches Coq: Definition hib_penalty_exposure) *)
definition hib_penalty_exposure :: "SGHealthRecord \<Rightarrow> bool" where
  "hib_penalty_exposure r \<equiv> ~ hib_cybersecurity r"

(* public_hospital_nehr_mandatory (matches Coq: Definition public_hospital_nehr_mandatory) *)
definition public_hospital_nehr_mandatory :: "SGHealthRecord \<Rightarrow> bool" where
  "public_hospital_nehr_mandatory r \<equiv> sgh_provider_type r = PublicHospital ->
  sgh_nehr_shared r = true"

(* hib_req_1 (matches Coq) *)
lemma hib_req_1: "\<forall> (r : SGHealthRecord), sgh_encrypted r = True \<longrightarrow> sgh_access_controlled r = True \<longrightarrow> sgh_cybersecurity_adequate r = True \<longrightarrow> hib_cybersecurity r"
  by auto

(* hib_req_2 (matches Coq) *)
lemma hib_req_2: "\<forall> (r : SGHealthRecord), sgh_nehr_shared r = True \<longrightarrow> sgh_encrypted r = True \<longrightarrow> nehr_sharing_compliant r"
  by simp

(* hib_req_3 (matches Coq) *)
lemma hib_req_3: "\<forall> (r : SGHealthRecord), sgh_audit_logged r = True \<longrightarrow> hib_audit_compliant r"
  by simp

(* hib_req_4 (matches Coq) *)
lemma hib_req_4: "\<forall> (r : SGHealthRecord), hib_cybersecurity r \<longrightarrow> hib_audit_compliant r \<longrightarrow> sensitive_health_protected r"
  by auto

(* hib_prohibited_insurance (matches Coq) *)
lemma hib_prohibited_insurance: "~ use_permitted InsuranceUnderwriting"
  by auto

(* hib_prohibited_employment (matches Coq) *)
lemma hib_prohibited_employment: "~ use_permitted Employment"
  by auto

(* hib_treatment_allowed (matches Coq) *)
lemma hib_treatment_allowed: "use_permitted Treatment"
  by auto

(* hib_composition (matches Coq) *)
lemma hib_composition: "\<forall> (r : SGHealthRecord), hib_cybersecurity r \<longrightarrow> hib_audit_compliant r \<longrightarrow> nehr_sharing_compliant r \<longrightarrow> hib_fully_compliant r"
  by simp

(* sg_provider_coverage (matches Coq) *)
lemma sg_provider_coverage: "\<forall> (p : SGHealthcareProvider), In p all_sg_providers"
  by auto

(* health_category_coverage (matches Coq) *)
lemma health_category_coverage: "\<forall> (c : HealthInfoCategory), In c all_health_categories"
  by auto

(* patient_access_right (matches Coq) *)
lemma patient_access_right: "\<forall> (req : PatientAccessRequest), par_responded_at req \<le> par_requested_at req + hib_access_deadline \<longrightarrow> par_data_provided req = True \<longrightarrow> patient_access_fulfilled req"
  by auto

(* patient_access_late_violation (matches Coq) *)
lemma patient_access_late_violation: "\<forall> (req : PatientAccessRequest), par_requested_at req + hib_access_deadline < par_responded_at req \<longrightarrow> ~ (par_responded_at req \<le> par_requested_at req + hib_access_deadline)"
  by auto

(* data_correction_logged (matches Coq) *)
lemma data_correction_logged: "\<forall> (c : HealthDataCorrection), hdc_audit_logged c = True \<longrightarrow> hdc_old_value_hash c \<noteq> hdc_new_value_hash c \<longrightarrow> correction_properly_logged c"
  by auto

(* cross_institutional_exchange (matches Coq) *)
lemma cross_institutional_exchange: "\<forall> (ex : HealthDataExchange), hde_patient_consent ex = True \<longrightarrow> hde_encrypted ex = True \<longrightarrow> hde_purpose_treatment ex = True \<longrightarrow> hde_audit_logged_exchange ex = True \<longrightarrow> exchange_authorized ex"
  by auto

(* general_health_not_sensitive (matches Coq) *)
lemma general_health_not_sensitive: "~ sg_health_sensitive GeneralHealth"
  by auto

(* mental_health_is_sensitive (matches Coq) *)
lemma mental_health_is_sensitive: "sg_health_sensitive MentalHealthSG"
  by simp

(* hiv_sti_is_sensitive (matches Coq) *)
lemma hiv_sti_is_sensitive: "sg_health_sensitive HIV_STI_SG"
  by simp

(* genetic_info_is_sensitive (matches Coq) *)
lemma genetic_info_is_sensitive: "sg_health_sensitive GeneticInfo"
  by simp

(* nehr_requires_encryption (matches Coq) *)
lemma nehr_requires_encryption: "\<forall> (r : SGHealthRecord), nehr_sharing_compliant r \<longrightarrow> sgh_encrypted r = True"
  by auto

(* nehr_requires_sharing (matches Coq) *)
lemma nehr_requires_sharing: "\<forall> (r : SGHealthRecord), nehr_sharing_compliant r \<longrightarrow> sgh_nehr_shared r = True"
  by auto

(* use_type_coverage (matches Coq) *)
lemma use_type_coverage: "\<forall> (u : UseType), In u all_use_types"
  by auto

(* research_allowed (matches Coq) *)
lemma research_allowed: "use_permitted Research"
  by auto

(* public_health_allowed (matches Coq) *)
lemma public_health_allowed: "use_permitted PublicHealth"
  by auto

(* hib_full_implies_cybersecurity (matches Coq) *)
lemma hib_full_implies_cybersecurity: "\<forall> (r : SGHealthRecord), hib_fully_compliant r \<longrightarrow> hib_cybersecurity r"
  by auto

(* hib_full_implies_audit (matches Coq) *)
lemma hib_full_implies_audit: "\<forall> (r : SGHealthRecord), hib_fully_compliant r \<longrightarrow> hib_audit_compliant r"
  by auto

(* hib_full_implies_nehr (matches Coq) *)
lemma hib_full_implies_nehr: "\<forall> (r : SGHealthRecord), hib_fully_compliant r \<longrightarrow> nehr_sharing_compliant r"
  by auto

(* cybersecurity_eliminates_penalty (matches Coq) *)
lemma cybersecurity_eliminates_penalty: "\<forall> (r : SGHealthRecord), hib_cybersecurity r \<longrightarrow> ~ hib_penalty_exposure r"
  by auto

(* public_hospital_must_share (matches Coq) *)
lemma public_hospital_must_share: "\<forall> (r : SGHealthRecord), sgh_provider_type r = PublicHospital \<longrightarrow> sgh_nehr_shared r = True \<longrightarrow> public_hospital_nehr_mandatory r"
  by auto

end
