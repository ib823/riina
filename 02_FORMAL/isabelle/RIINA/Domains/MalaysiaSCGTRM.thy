(* SPDX-License-Identifier: MPL-2.0 *)
(* Copyright (c) 2026 The RIINA Authors. See AUTHORS file. *)

(*
 * RIINA MalaysiaSCGTRM - Isabelle/HOL Port
 *
 * Auto-generated port of 02_FORMAL/coq/domains/MalaysiaSCGTRM.v (24 theorems).
 *
 * Generated by scripts/generate-multiprover.py
 *
 * Correspondence Table:
 *
 * | Coq Definition     | Isabelle Definition    | Status |
 * |--------------------|------------------------|--------|
 * | CMEntityType       | cm_entity_type         | OK     |
 * | gtrm_board_accountable | gtrm_board_accountable | OK     |
 * | gtrm_risk_framework | gtrm_risk_framework    | OK     |
 * | gtrm_pentest_current | gtrm_pentest_current   | OK     |
 * | gtrm_ai_assessed   | gtrm_ai_assessed       | OK     |
 * | gtrm_vendor_compliant | gtrm_vendor_compliant  | OK     |
 * | gtrm_incident_ready | gtrm_incident_ready    | OK     |
 * | gtrm_data_protected | gtrm_data_protected    | OK     |
 * | gtrm_fully_compliant | gtrm_fully_compliant   | OK     |
 * | sc_incident_deadline | sc_incident_deadline   | OK     |
 * | sc_incident_timely | sc_incident_timely     | OK     |
 * | ai_risk_managed    | ai_risk_managed        | OK     |
 * | cm_cloud_risk_assessed | cm_cloud_risk_assessed | OK     |
 * | gtrm_req_1         | gtrm_req_1             | OK     |
 * | gtrm_req_2         | gtrm_req_2             | OK     |
 * | gtrm_req_3         | gtrm_req_3             | OK     |
 * | gtrm_req_4         | gtrm_req_4             | OK     |
 * | gtrm_req_5         | gtrm_req_5             | OK     |
 * | gtrm_req_6         | gtrm_req_6             | OK     |
 * | gtrm_req_7         | gtrm_req_7             | OK     |
 * | gtrm_composition   | gtrm_composition       | OK     |
 * | cm_entity_coverage | cm_entity_coverage     | OK     |
 * | pentest_expired    | pentest_expired        | OK     |
 * | pentest_recently_done | pentest_recently_done  | OK     |
 * | gtrm_full_implies_board | gtrm_full_implies_board | OK     |
 * | gtrm_full_implies_risk | gtrm_full_implies_risk | OK     |
 * | gtrm_full_implies_pentest | gtrm_full_implies_pentest | OK     |
 * | gtrm_full_implies_ai | gtrm_full_implies_ai   | OK     |
 * | gtrm_full_implies_vendor | gtrm_full_implies_vendor | OK     |
 * | gtrm_full_implies_incident | gtrm_full_implies_incident | OK     |
 * | gtrm_full_implies_data | gtrm_full_implies_data | OK     |
 * | sc_incident_reporting | sc_incident_reporting  | OK     |
 * | sc_incident_late   | sc_incident_late       | OK     |
 * | ai_model_risk_complete | ai_model_risk_complete | OK     |
 * | ai_not_validated_not_managed | ai_not_validated_not_managed | OK     |
 * | cm_cloud_fully_assessed | cm_cloud_fully_assessed | OK     |
 * | cm_cloud_missing_exit_strategy | cm_cloud_missing_exit_strategy | OK     |
 *)

theory MalaysiaSCGTRM
  imports Main
begin

(* CMEntityType (matches Coq: Inductive CMEntityType) *)
datatype cm_entity_type =
    BrokerDealer
  |     FundManager
  |     Exchange
  |     ClearingHouse
  |     Depository
  |     CreditRatingAgency

(* gtrm_board_accountable (matches Coq: Definition gtrm_board_accountable) *)
definition gtrm_board_accountable :: "CMEntity \<Rightarrow> bool" where
  "gtrm_board_accountable e \<equiv> cm_board_accountability e = true"

(* gtrm_risk_framework (matches Coq: Definition gtrm_risk_framework) *)
definition gtrm_risk_framework :: "CMEntity \<Rightarrow> bool" where
  "gtrm_risk_framework e \<equiv> cm_risk_framework e = true"

(* gtrm_pentest_current (matches Coq: Definition gtrm_pentest_current) *)
definition gtrm_pentest_current :: "CMEntity \<Rightarrow> nat \<Rightarrow> bool" where
  "gtrm_pentest_current e current_time \<equiv> cm_pentest_done e = true /\
  current_time <= cm_last_pentest e + cm_pentest_interval e"

(* gtrm_ai_assessed (matches Coq: Definition gtrm_ai_assessed) *)
definition gtrm_ai_assessed :: "CMEntity \<Rightarrow> bool" where
  "gtrm_ai_assessed e \<equiv> cm_ai_risk_assessed e = true"

(* gtrm_vendor_compliant (matches Coq: Definition gtrm_vendor_compliant) *)
definition gtrm_vendor_compliant :: "CMEntity \<Rightarrow> bool" where
  "gtrm_vendor_compliant e \<equiv> cm_third_party_assessed e = true /\ cm_cloud_risk_assessed e = true"

(* gtrm_incident_ready (matches Coq: Definition gtrm_incident_ready) *)
definition gtrm_incident_ready :: "CMEntity \<Rightarrow> bool" where
  "gtrm_incident_ready e \<equiv> cm_incident_response_plan e = true"

(* gtrm_data_protected (matches Coq: Definition gtrm_data_protected) *)
definition gtrm_data_protected :: "CMEntity \<Rightarrow> bool" where
  "gtrm_data_protected e \<equiv> cm_data_protection e = true"

(* gtrm_fully_compliant (matches Coq: Definition gtrm_fully_compliant) *)
definition gtrm_fully_compliant :: "CMEntity \<Rightarrow> nat \<Rightarrow> bool" where
  "gtrm_fully_compliant e t \<equiv> gtrm_board_accountable e /\
  gtrm_risk_framework e /\
  gtrm_pentest_current e t /\
  gtrm_ai_assessed e /\
  gtrm_vendor_compliant e /\
  gtrm_incident_ready e /\
  gtrm_data_protected e"

(* sc_incident_deadline (matches Coq: Definition sc_incident_deadline) *)
definition sc_incident_deadline :: "nat" where
  "sc_incident_deadline \<equiv> 24"

(* sc_incident_timely (matches Coq: Definition sc_incident_timely) *)
definition sc_incident_timely :: "SCIncident \<Rightarrow> bool" where
  "sc_incident_timely inc \<equiv> sci_reported_at inc <= sci_detected_at inc + sc_incident_deadline"

(* ai_risk_managed (matches Coq: Definition ai_risk_managed) *)
definition ai_risk_managed :: "AIModelRisk \<Rightarrow> bool" where
  "ai_risk_managed ar \<equiv> ai_bias_assessed ar = true /\
  ai_explainability_documented ar = true /\
  ai_data_quality_verified ar = true /\
  ai_model_validated ar = true /\
  ai_monitoring_active ar = true"

(* cm_cloud_risk_assessed (matches Coq: Definition cm_cloud_risk_assessed) *)
definition cm_cloud_risk_assessed :: "CMCloudRisk \<Rightarrow> bool" where
  "cm_cloud_risk_assessed cr \<equiv> cmc_data_residency_compliant cr = true /\
  cmc_encryption_at_rest cr = true /\
  cmc_encryption_in_transit cr = true /\
  cmc_access_controls cr = true /\
  cmc_exit_strategy cr = true"

(* gtrm_req_1 (matches Coq) *)
lemma gtrm_req_1: "\<forall> (e : CMEntity), cm_board_accountability e = True \<longrightarrow> gtrm_board_accountable e"
  by auto

(* gtrm_req_2 (matches Coq) *)
lemma gtrm_req_2: "\<forall> (e : CMEntity), cm_risk_framework e = True \<longrightarrow> gtrm_risk_framework e"
  by auto

(* gtrm_req_3 (matches Coq) *)
lemma gtrm_req_3: "\<forall> (e : CMEntity) (t : nat), cm_pentest_done e = True \<longrightarrow> t \<le> cm_last_pentest e + cm_pentest_interval e \<longrightarrow> gtrm_pentest_current e t"
  by auto

(* gtrm_req_4 (matches Coq) *)
lemma gtrm_req_4: "\<forall> (e : CMEntity), cm_ai_risk_assessed e = True \<longrightarrow> gtrm_ai_assessed e"
  by auto

(* gtrm_req_5 (matches Coq) *)
lemma gtrm_req_5: "\<forall> (e : CMEntity), cm_third_party_assessed e = True \<longrightarrow> cm_cloud_risk_assessed e = True \<longrightarrow> gtrm_vendor_compliant e"
  by simp

(* gtrm_req_6 (matches Coq) *)
lemma gtrm_req_6: "\<forall> (e : CMEntity), cm_incident_response_plan e = True \<longrightarrow> gtrm_incident_ready e"
  by auto

(* gtrm_req_7 (matches Coq) *)
lemma gtrm_req_7: "\<forall> (e : CMEntity), cm_data_protection e = True \<longrightarrow> gtrm_data_protected e"
  by auto

(* gtrm_composition (matches Coq) *)
lemma gtrm_composition: "\<forall> (e : CMEntity) (t : nat), gtrm_board_accountable e \<longrightarrow> gtrm_risk_framework e \<longrightarrow> gtrm_pentest_current e t \<longrightarrow> gtrm_ai_assessed e \<longrightarrow> gtrm_vendor_compliant e \<longrightarrow> gtrm_incident_ready e \<longrightarrow> gtrm_data_protected e \<longrightarrow> gtrm_fully_compliant e t"
  by simp

(* cm_entity_coverage (matches Coq) *)
lemma cm_entity_coverage: "\<forall> (t : CMEntityType), In t all_cm_entity_types"
  by auto

(* pentest_expired (matches Coq) *)
lemma pentest_expired: "\<forall> (e : CMEntity) (t : nat), cm_last_pentest e + cm_pentest_interval e < t \<longrightarrow> ~ gtrm_pentest_current e t"
  by simp

(* pentest_recently_done (matches Coq) *)
lemma pentest_recently_done: "\<forall> (e : CMEntity), cm_pentest_done e = True \<longrightarrow> gtrm_pentest_current e (cm_last_pentest e)"
  by simp

(* gtrm_full_implies_board (matches Coq) *)
lemma gtrm_full_implies_board: "\<forall> (e : CMEntity) (t : nat), gtrm_fully_compliant e t \<longrightarrow> gtrm_board_accountable e"
  by auto

(* gtrm_full_implies_risk (matches Coq) *)
lemma gtrm_full_implies_risk: "\<forall> (e : CMEntity) (t : nat), gtrm_fully_compliant e t \<longrightarrow> gtrm_risk_framework e"
  by auto

(* gtrm_full_implies_pentest (matches Coq) *)
lemma gtrm_full_implies_pentest: "\<forall> (e : CMEntity) (t : nat), gtrm_fully_compliant e t \<longrightarrow> gtrm_pentest_current e t"
  by auto

(* gtrm_full_implies_ai (matches Coq) *)
lemma gtrm_full_implies_ai: "\<forall> (e : CMEntity) (t : nat), gtrm_fully_compliant e t \<longrightarrow> gtrm_ai_assessed e"
  by auto

(* gtrm_full_implies_vendor (matches Coq) *)
lemma gtrm_full_implies_vendor: "\<forall> (e : CMEntity) (t : nat), gtrm_fully_compliant e t \<longrightarrow> gtrm_vendor_compliant e"
  by auto

(* gtrm_full_implies_incident (matches Coq) *)
lemma gtrm_full_implies_incident: "\<forall> (e : CMEntity) (t : nat), gtrm_fully_compliant e t \<longrightarrow> gtrm_incident_ready e"
  by auto

(* gtrm_full_implies_data (matches Coq) *)
lemma gtrm_full_implies_data: "\<forall> (e : CMEntity) (t : nat), gtrm_fully_compliant e t \<longrightarrow> gtrm_data_protected e"
  by auto

(* sc_incident_reporting (matches Coq) *)
lemma sc_incident_reporting: "\<forall> (inc : SCIncident), sci_reported_at inc \<le> sci_detected_at inc + 24 \<longrightarrow> sc_incident_timely inc"
  by auto

(* sc_incident_late (matches Coq) *)
lemma sc_incident_late: "\<forall> (inc : SCIncident), sci_detected_at inc + sc_incident_deadline < sci_reported_at inc \<longrightarrow> ~ sc_incident_timely inc"
  by simp

(* ai_model_risk_complete (matches Coq) *)
lemma ai_model_risk_complete: "\<forall> (ar : AIModelRisk), ai_bias_assessed ar = True \<longrightarrow> ai_explainability_documented ar = True \<longrightarrow> ai_data_quality_verified ar = True \<longrightarrow> ai_model_validated ar = True \<longrightarrow> ai_monitoring_active ar = True \<longrightarrow> ai_risk_managed ar"
  by auto

(* ai_not_validated_not_managed (matches Coq) *)
lemma ai_not_validated_not_managed: "\<forall> (ar : AIModelRisk), ai_model_validated ar = False \<longrightarrow> ~ ai_risk_managed ar"
  by auto

(* cm_cloud_fully_assessed (matches Coq) *)
lemma cm_cloud_fully_assessed: "\<forall> (cr : CMCloudRisk), cmc_data_residency_compliant cr = True \<longrightarrow> cmc_encryption_at_rest cr = True \<longrightarrow> cmc_encryption_in_transit cr = True \<longrightarrow> cmc_access_controls cr = True \<longrightarrow> cmc_exit_strategy cr = True \<longrightarrow> cm_cloud_risk_assessed cr"
  by auto

(* cm_cloud_missing_exit_strategy (matches Coq) *)
lemma cm_cloud_missing_exit_strategy: "\<forall> (cr : CMCloudRisk), cmc_exit_strategy cr = False \<longrightarrow> ~ cm_cloud_risk_assessed cr"
  by auto

end
