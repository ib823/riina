(* Copyright (c) 2026 The RIINA Authors. All rights reserved. *)

(*
 * RIINA MalaysiaMCMC - Isabelle/HOL Port
 *
 * Auto-generated port of 02_FORMAL/coq/domains/MalaysiaMCMC.v (20 theorems).
 *
 * Generated by scripts/generate-multiprover.py
 *
 * Correspondence Table:
 *
 * | Coq Definition     | Isabelle Definition    | Status |
 * |--------------------|------------------------|--------|
 * | MCMCLicense        | mcmc_license           | OK     |
 * | no_unauthorized_interception | no_unauthorized_interception | OK     |
 * | fraud_controls_active | fraud_controls_active  | OK     |
 * | mcmc_fully_compliant | mcmc_fully_compliant   | OK     |
 * | license_level      | license_level          | OK     |
 * | count_mcmc_controls | count_mcmc_controls    | OK     |
 * | license_eqb        | license_eqb            | OK     |
 * | s234_encrypted_compliant | s234_encrypted_compliant | OK     |
 * | s234_authorized_compliant | s234_authorized_compliant | OK     |
 * | s236_fraud_prevention | s236_fraud_prevention  | OK     |
 * | mcmc_composition   | mcmc_composition       | OK     |
 * | mcmc_license_coverage | mcmc_license_coverage  | OK     |
 * | nfp_highest_level  | nfp_highest_level      | OK     |
 * | csp_lowest_level   | csp_lowest_level       | OK     |
 * | license_level_positive | license_level_positive | OK     |
 * | mcmc_compliant_licensed | mcmc_compliant_licensed | OK     |
 * | mcmc_compliant_technical | mcmc_compliant_technical | OK     |
 * | mcmc_compliant_consumer | mcmc_compliant_consumer | OK     |
 * | mcmc_compliant_interception | mcmc_compliant_interception | OK     |
 * | mcmc_compliant_fraud | mcmc_compliant_fraud   | OK     |
 * | count_mcmc_bounded | count_mcmc_bounded     | OK     |
 * | mcmc_compliant_all_five | mcmc_compliant_all_five | OK     |
 * | license_eqb_refl   | license_eqb_refl       | OK     |
 * | fraud_requires_identity | fraud_requires_identity | OK     |
 * | fraud_requires_signing | fraud_requires_signing | OK     |
 * | fraud_requires_audit | fraud_requires_audit   | OK     |
 * | mcmc_license_count | mcmc_license_count     | OK     |
 *)

theory MalaysiaMCMC
  imports Main
begin

(* MCMCLicense (matches Coq: Inductive MCMCLicense) *)
datatype mcmc_license =
    NFP  (* Network Facilities Provider *)
  |     NSP  (* Network Service Provider *)
  |     ASP  (* Application Service Provider *)
  |     CSP

(* no_unauthorized_interception (matches Coq: Definition no_unauthorized_interception) *)
definition no_unauthorized_interception :: "bool \<Rightarrow> bool \<Rightarrow> bool" where
  "no_unauthorized_interception communications_encrypted access_authorized \<equiv> communications_encrypted = true \/
  access_authorized = true"

(* fraud_controls_active (matches Coq: Definition fraud_controls_active) *)
definition fraud_controls_active :: "bool \<Rightarrow> bool \<Rightarrow> bool \<Rightarrow> bool" where
  "fraud_controls_active identity_verified transaction_signed audit_logged \<equiv> identity_verified = true /\ transaction_signed = true /\ audit_logged = true"

(* mcmc_fully_compliant (matches Coq: Definition mcmc_fully_compliant) *)
definition mcmc_fully_compliant :: "MCMCCompliance \<Rightarrow> bool" where
  "mcmc_fully_compliant c \<equiv> mcmc_licensed c = true /\
  mcmc_technical_standards_met c = true /\
  mcmc_consumer_code_adopted c = true /\
  mcmc_interception_protected c = true /\
  mcmc_fraud_controls c = true"

(* license_level (matches Coq: Definition license_level) *)
fun license_level :: "MCMCLicense \<Rightarrow> nat" where
  "license_level NFP = 4"
|   "license_level NSP = 3"
|   "license_level ASP = 2"
|   "license_level CSP = 1"

(* count_mcmc_controls (matches Coq: Definition count_mcmc_controls) *)
definition count_mcmc_controls :: "MCMCCompliance \<Rightarrow> nat" where
  "count_mcmc_controls c \<equiv> (if mcmc_licensed c then 1 else 0) +
  (if mcmc_technical_standards_met c then 1 else 0) +
  (if mcmc_consumer_code_adopted c then 1 else 0) +
  (if mcmc_interception_protected c then 1 else 0) +
  (if mcmc_fraud_controls c then 1 else 0)"

(* license_eqb (matches Coq: Definition license_eqb) *)
definition license_eqb :: "bool" where
  "license_eqb \<equiv> Nat"

(* s234_encrypted_compliant (matches Coq) *)
lemma s234_encrypted_compliant: "\<forall> (enc auth : bool), enc = True \<longrightarrow> no_unauthorized_interception enc auth"
  by auto

(* s234_authorized_compliant (matches Coq) *)
lemma s234_authorized_compliant: "\<forall> (enc auth : bool), auth = True \<longrightarrow> no_unauthorized_interception enc auth"
  by auto

(* s236_fraud_prevention (matches Coq) *)
lemma s236_fraud_prevention: "\<forall> (id_v tx_s audit : bool), id_v = True \<longrightarrow> tx_s = True \<longrightarrow> audit = True \<longrightarrow> fraud_controls_active id_v tx_s audit"
  by auto

(* mcmc_composition (matches Coq) *)
lemma mcmc_composition: "\<forall> (c : MCMCCompliance), mcmc_licensed c = True \<longrightarrow> mcmc_technical_standards_met c = True \<longrightarrow> mcmc_consumer_code_adopted c = True \<longrightarrow> mcmc_interception_protected c = True \<longrightarrow> mcmc_fraud_controls c = True \<longrightarrow> mcmc_fully_compliant c"
  by simp

(* mcmc_license_coverage (matches Coq) *)
lemma mcmc_license_coverage: "\<forall> (l : MCMCLicense), In l all_mcmc_licenses"
  by auto

(* nfp_highest_level (matches Coq) *)
lemma nfp_highest_level: "\<forall> l, license_level l \<le> license_level NFP"
  by (cases rule: ‹_›.cases; simp)

(* csp_lowest_level (matches Coq) *)
lemma csp_lowest_level: "\<forall> l, license_level CSP \<le> license_level l"
  by (cases rule: ‹_›.cases; simp)

(* license_level_positive (matches Coq) *)
lemma license_level_positive: "\<forall> l, license_level l \<ge> 1"
  by (cases rule: ‹_›.cases; simp)

(* Compliance field decomposition *)
(* mcmc_compliant_licensed (matches Coq) *)
lemma mcmc_compliant_licensed: "\<forall> c, mcmc_fully_compliant c \<longrightarrow> mcmc_licensed c = True"
  by auto

(* mcmc_compliant_technical (matches Coq) *)
lemma mcmc_compliant_technical: "\<forall> c, mcmc_fully_compliant c \<longrightarrow> mcmc_technical_standards_met c = True"
  by auto

(* mcmc_compliant_consumer (matches Coq) *)
lemma mcmc_compliant_consumer: "\<forall> c, mcmc_fully_compliant c \<longrightarrow> mcmc_consumer_code_adopted c = True"
  by auto

(* mcmc_compliant_interception (matches Coq) *)
lemma mcmc_compliant_interception: "\<forall> c, mcmc_fully_compliant c \<longrightarrow> mcmc_interception_protected c = True"
  by auto

(* mcmc_compliant_fraud (matches Coq) *)
lemma mcmc_compliant_fraud: "\<forall> c, mcmc_fully_compliant c \<longrightarrow> mcmc_fraud_controls c = True"
  by auto

(* count_mcmc_bounded (matches Coq) *)
lemma count_mcmc_bounded: "\<forall> c, count_mcmc_controls c \<le> 5"
  by (cases rule: ‹_›.cases; simp)

(* mcmc_compliant_all_five (matches Coq) *)
lemma mcmc_compliant_all_five: "\<forall> c, mcmc_fully_compliant c \<longrightarrow> count_mcmc_controls c = 5"
  by simp

(* license_eqb_refl (matches Coq) *)
lemma license_eqb_refl: "\<forall> l, license_eqb l l = True"
  by auto

(* Fraud controls require identity *)
(* fraud_requires_identity (matches Coq) *)
lemma fraud_requires_identity: "\<forall> id_v tx_s audit, fraud_controls_active id_v tx_s audit \<longrightarrow> id_v = True"
  by auto

(* fraud_requires_signing (matches Coq) *)
lemma fraud_requires_signing: "\<forall> id_v tx_s audit, fraud_controls_active id_v tx_s audit \<longrightarrow> tx_s = True"
  by auto

(* fraud_requires_audit (matches Coq) *)
lemma fraud_requires_audit: "\<forall> id_v tx_s audit, fraud_controls_active id_v tx_s audit \<longrightarrow> audit = True"
  by auto

(* Four license types *)
(* mcmc_license_count (matches Coq) *)
lemma mcmc_license_count: "length all_mcmc_licenses = 4"
  by simp

end
