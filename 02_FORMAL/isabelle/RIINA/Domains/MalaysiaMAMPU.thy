(* Copyright (c) 2026 The RIINA Authors. All rights reserved. *)

(*
 * RIINA MalaysiaMAMPU - Isabelle/HOL Port
 *
 * Auto-generated port of 02_FORMAL/coq/domains/MalaysiaMAMPU.v (27 theorems).
 *
 * Generated by scripts/generate-multiprover.py
 *
 * Correspondence Table:
 *
 * | Coq Definition     | Isabelle Definition    | Status |
 * |--------------------|------------------------|--------|
 * | GovClassification  | gov_classification     | OK     |
 * | classification_level | classification_level   | OK     |
 * | data_sovereign     | data_sovereign         | OK     |
 * | controls_match_classification | controls_match_classification | OK     |
 * | security_assessed  | security_assessed      | OK     |
 * | isms_compliant     | isms_compliant         | OK     |
 * | mampu_fully_compliant | mampu_fully_compliant  | OK     |
 * | rakkssa_passed     | rakkssa_passed         | OK     |
 * | mygovcloud_eligible | mygovcloud_eligible    | OK     |
 * | dkict_compliant    | dkict_compliant        | OK     |
 * | mampu_sovereignty  | mampu_sovereignty      | OK     |
 * | mampu_terbuka      | mampu_terbuka          | OK     |
 * | mampu_rahsia       | mampu_rahsia           | OK     |
 * | mampu_rahsia_besar | mampu_rahsia_besar     | OK     |
 * | mampu_assessment   | mampu_assessment       | OK     |
 * | mampu_isms         | mampu_isms             | OK     |
 * | classification_ordering | classification_ordering | OK     |
 * | rahsia_besar_highest | rahsia_besar_highest   | OK     |
 * | mampu_composition  | mampu_composition      | OK     |
 * | gov_classification_coverage | gov_classification_coverage | OK     |
 * | terbuka_is_level_zero | terbuka_is_level_zero  | OK     |
 * | rahsia_besar_is_level_four | rahsia_besar_is_level_four | OK     |
 * | classification_level_positive_for_non_terbuka | classification_level_positive_for_non_terbuka | OK     |
 * | mampu_terhad       | mampu_terhad           | OK     |
 * | mampu_sulit        | mampu_sulit            | OK     |
 * | rahsia_besar_requires_encryption | rahsia_besar_requires_encryption | OK     |
 * | rahsia_besar_requires_access_control | rahsia_besar_requires_access_control | OK     |
 * | rahsia_besar_requires_audit | rahsia_besar_requires_audit | OK     |
 * | rahsia_besar_requires_isms | rahsia_besar_requires_isms | OK     |
 * | sovereignty_mandatory_for_all_levels | sovereignty_mandatory_for_all_levels | OK     |
 * | sovereignty_violation_blocks_compliance | sovereignty_violation_blocks_compliance | OK     |
 * | rakkssa_assessment_complete | rakkssa_assessment_complete | OK     |
 * | rakkssa_score_insufficient | rakkssa_score_insufficient | OK     |
 * | mygovcloud_check   | mygovcloud_check       | OK     |
 * | dkict_full_compliance | dkict_full_compliance  | OK     |
 * | mampu_full_implies_sovereign | mampu_full_implies_sovereign | OK     |
 * | mampu_full_implies_assessed | mampu_full_implies_assessed | OK     |
 *)

theory MalaysiaMAMPU
  imports Main
begin

(* GovClassification (matches Coq: Inductive GovClassification) *)
datatype gov_classification =
    Terbuka  (* Open / Public *)
  |     Terhad  (* Restricted *)
  |     Sulit  (* Confidential *)
  |     Rahsia  (* Secret *)
  |     RahsiaBesar

(* classification_level (matches Coq: Definition classification_level) *)
fun classification_level :: "GovClassification \<Rightarrow> nat" where
  "classification_level Terbuka = 0"
|   "classification_level Terhad = 1"
|   "classification_level Sulit = 2"
|   "classification_level Rahsia = 3"
|   "classification_level RahsiaBesar = 4"

(* data_sovereign (matches Coq: Definition data_sovereign) *)
definition data_sovereign :: "GovSystem \<Rightarrow> bool" where
  "data_sovereign s \<equiv> gov_data_in_malaysia s = true"

(* controls_match_classification - complex match, manual review needed *)

(* security_assessed (matches Coq: Definition security_assessed) *)
definition security_assessed :: "GovSystem \<Rightarrow> bool" where
  "security_assessed s \<equiv> gov_security_assessed s = true"

(* isms_compliant (matches Coq: Definition isms_compliant) *)
definition isms_compliant :: "GovSystem \<Rightarrow> bool" where
  "isms_compliant s \<equiv> gov_isms_certified s = true"

(* mampu_fully_compliant - complex match, manual review needed *)

(* rakkssa_passed (matches Coq: Definition rakkssa_passed) *)
definition rakkssa_passed :: "RAKKSSAAssessment \<Rightarrow> bool" where
  "rakkssa_passed ra \<equiv> rk_vulnerability_scan ra = true /\
  rk_penetration_test ra = true /\
  rk_risk_assessment ra = true /\
  rk_compliance_check ra = true /\
  rk_score ra >= rk_min_score ra"

(* mygovcloud_eligible (matches Coq: Definition mygovcloud_eligible) *)
definition mygovcloud_eligible :: "GovSystem \<Rightarrow> bool" where
  "mygovcloud_eligible s \<equiv> data_sovereign s /\
  security_assessed s /\
  (gov_classification s <> RahsiaBesar)"

(* dkict_compliant (matches Coq: Definition dkict_compliant) *)
definition dkict_compliant :: "DKICTCompliance \<Rightarrow> bool" where
  "dkict_compliant d \<equiv> dkict_password_policy d = true /\
  dkict_access_review d = true /\
  dkict_incident_response d = true /\
  dkict_backup_tested d = true"

(* mampu_sovereignty (matches Coq) *)
lemma mampu_sovereignty: "\<forall> (s : GovSystem), gov_data_in_malaysia s = True \<longrightarrow> data_sovereign s"
  by auto

(* mampu_terbuka (matches Coq) *)
lemma mampu_terbuka: "\<forall> (s : GovSystem), gov_classification s = Terbuka \<longrightarrow> controls_match_classification s"
  by auto

(* mampu_rahsia (matches Coq) *)
lemma mampu_rahsia: "\<forall> (s : GovSystem), gov_classification s = Rahsia \<longrightarrow> gov_encrypted s = True \<longrightarrow> gov_access_controlled s = True \<longrightarrow> gov_audit_logged s = True \<longrightarrow> controls_match_classification s"
  by auto

(* mampu_rahsia_besar (matches Coq) *)
lemma mampu_rahsia_besar: "\<forall> (s : GovSystem), gov_classification s = RahsiaBesar \<longrightarrow> gov_encrypted s = True \<longrightarrow> gov_access_controlled s = True \<longrightarrow> gov_audit_logged s = True \<longrightarrow> gov_isms_certified s = True \<longrightarrow> controls_match_classification s"
  by auto

(* mampu_assessment (matches Coq) *)
lemma mampu_assessment: "\<forall> (s : GovSystem), gov_security_assessed s = True \<longrightarrow> security_assessed s"
  by auto

(* mampu_isms (matches Coq) *)
lemma mampu_isms: "\<forall> (s : GovSystem), gov_isms_certified s = True \<longrightarrow> isms_compliant s"
  by simp

(* classification_ordering (matches Coq) *)
lemma classification_ordering: "\<forall> (c1 c2 : GovClassification), classification_level c1 \<le> classification_level c2 \<or> classification_level c2 \<le> classification_level c1"
  by auto

(* rahsia_besar_highest (matches Coq) *)
lemma rahsia_besar_highest: "\<forall> (c : GovClassification), classification_level c \<le> classification_level RahsiaBesar"
  by auto

(* mampu_composition (matches Coq) *)
lemma mampu_composition: "\<forall> (s : GovSystem), data_sovereign s \<longrightarrow> controls_match_classification s \<longrightarrow> security_assessed s \<longrightarrow> mampu_fully_compliant s"
  by simp

(* gov_classification_coverage (matches Coq) *)
lemma gov_classification_coverage: "\<forall> (c : GovClassification), In c all_gov_classifications"
  by auto

(* terbuka_is_level_zero (matches Coq) *)
lemma terbuka_is_level_zero: "classification_level Terbuka = 0"
  by simp

(* rahsia_besar_is_level_four (matches Coq) *)
lemma rahsia_besar_is_level_four: "classification_level RahsiaBesar = 4"
  by simp

(* classification_level_positive_for_non_terbuka (matches Coq) *)
lemma classification_level_positive_for_non_terbuka: "\<forall> (c : GovClassification), c \<noteq> Terbuka \<longrightarrow> classification_level c \<ge> 1"
  by (cases rule: ‹_›.cases; simp)

(* mampu_terhad (matches Coq) *)
lemma mampu_terhad: "\<forall> (s : GovSystem), gov_classification s = Terhad \<longrightarrow> gov_access_controlled s = True \<longrightarrow> controls_match_classification s"
  by auto

(* mampu_sulit (matches Coq) *)
lemma mampu_sulit: "\<forall> (s : GovSystem), gov_classification s = Sulit \<longrightarrow> gov_encrypted s = True \<longrightarrow> gov_access_controlled s = True \<longrightarrow> controls_match_classification s"
  by auto

(* rahsia_besar_requires_encryption (matches Coq) *)
lemma rahsia_besar_requires_encryption: "\<forall> (s : GovSystem), gov_classification s = RahsiaBesar \<longrightarrow> controls_match_classification s \<longrightarrow> gov_encrypted s = True"
  by auto

(* rahsia_besar_requires_access_control (matches Coq) *)
lemma rahsia_besar_requires_access_control: "\<forall> (s : GovSystem), gov_classification s = RahsiaBesar \<longrightarrow> controls_match_classification s \<longrightarrow> gov_access_controlled s = True"
  by auto

(* rahsia_besar_requires_audit (matches Coq) *)
lemma rahsia_besar_requires_audit: "\<forall> (s : GovSystem), gov_classification s = RahsiaBesar \<longrightarrow> controls_match_classification s \<longrightarrow> gov_audit_logged s = True"
  by auto

(* rahsia_besar_requires_isms (matches Coq) *)
lemma rahsia_besar_requires_isms: "\<forall> (s : GovSystem), gov_classification s = RahsiaBesar \<longrightarrow> controls_match_classification s \<longrightarrow> gov_isms_certified s = True"
  by auto

(* sovereignty_mandatory_for_all_levels (matches Coq) *)
lemma sovereignty_mandatory_for_all_levels: "\<forall> (s : GovSystem), mampu_fully_compliant s \<longrightarrow> data_sovereign s"
  by auto

(* sovereignty_violation_blocks_compliance (matches Coq) *)
lemma sovereignty_violation_blocks_compliance: "\<forall> (s : GovSystem), gov_data_in_malaysia s = False \<longrightarrow> ~ data_sovereign s"
  by auto

(* rakkssa_assessment_complete (matches Coq) *)
lemma rakkssa_assessment_complete: "\<forall> (ra : RAKKSSAAssessment), rk_vulnerability_scan ra = True \<longrightarrow> rk_penetration_test ra = True \<longrightarrow> rk_risk_assessment ra = True \<longrightarrow> rk_compliance_check ra = True \<longrightarrow> rk_score ra \<ge> rk_min_score ra \<longrightarrow> rakkssa_passed ra"
  by auto

(* rakkssa_score_insufficient (matches Coq) *)
lemma rakkssa_score_insufficient: "\<forall> (ra : RAKKSSAAssessment), rk_score ra < rk_min_score ra \<longrightarrow> ~ (rk_score ra \<ge> rk_min_score ra)"
  by simp

(* mygovcloud_check (matches Coq) *)
lemma mygovcloud_check: "\<forall> (s : GovSystem), gov_data_in_malaysia s = True \<longrightarrow> gov_security_assessed s = True \<longrightarrow> gov_classification s \<noteq> RahsiaBesar \<longrightarrow> mygovcloud_eligible s"
  by auto

(* dkict_full_compliance (matches Coq) *)
lemma dkict_full_compliance: "\<forall> (d : DKICTCompliance), dkict_password_policy d = True \<longrightarrow> dkict_access_review d = True \<longrightarrow> dkict_incident_response d = True \<longrightarrow> dkict_backup_tested d = True \<longrightarrow> dkict_compliant d"
  by simp

(* mampu_full_implies_sovereign (matches Coq) *)
lemma mampu_full_implies_sovereign: "\<forall> (s : GovSystem), mampu_fully_compliant s \<longrightarrow> gov_data_in_malaysia s = True"
  by auto

(* mampu_full_implies_assessed (matches Coq) *)
lemma mampu_full_implies_assessed: "\<forall> (s : GovSystem), mampu_fully_compliant s \<longrightarrow> gov_security_assessed s = True"
  by auto

end
