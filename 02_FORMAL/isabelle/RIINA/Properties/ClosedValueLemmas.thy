(* Copyright (c) 2026 The RIINA Authors. All rights reserved. *)

(*
 * RIINA ClosedValueLemmas - Isabelle/HOL Port
 *
 * Auto-generated port of 02_FORMAL/coq/properties/ClosedValueLemmas.v (11 theorems).
 *
 * Generated by scripts/generate-multiprover.py
 *
 * Correspondence Table:
 *
 * | Coq Definition     | Isabelle Definition    | Status |
 * |--------------------|------------------------|--------|
 * | closed_expr_cv     | closed_expr_cv         | OK     |
 * | value_typed_closed | value_typed_closed     | OK     |
 * | closed_pair_cv     | closed_pair_cv         | OK     |
 * | closed_inl_cv      | closed_inl_cv          | OK     |
 * | closed_inr_cv      | closed_inr_cv          | OK     |
 * | closed_app_cv      | closed_app_cv          | OK     |
 * | closed_unit_cv     | closed_unit_cv         | OK     |
 * | closed_bool_cv     | closed_bool_cv         | OK     |
 * | closed_int_cv      | closed_int_cv          | OK     |
 * | closed_string_cv   | closed_string_cv       | OK     |
 * | closed_loc_cv      | closed_loc_cv          | OK     |
 * | closed_lam_body_cv | closed_lam_body_cv     | OK     |
 *)

theory ClosedValueLemmas
  imports Main
begin

(* closed_expr_cv (matches Coq: Definition closed_expr_cv) *)
definition closed_expr_cv :: "expr \<Rightarrow> bool" where
  "closed_expr_cv e \<equiv> forall x, ~ free_in x e"

(* Values are closed under empty context typing *)
(* value_typed_closed (matches Coq) *)
lemma value_typed_closed: "\<forall> Σ Δ v T ε, value v \<longrightarrow> has_type nil Σ Δ v T ε \<longrightarrow> closed_expr_cv v"
  by auto

(* Closed expressions for compound types - decomposition *)
(* closed_pair_cv (matches Coq) *)
lemma closed_pair_cv: "\<forall> e1 e2, closed_expr_cv (EPair e1 e2) <-> closed_expr_cv e1 \<and> closed_expr_cv e2"
  by auto

(* closed_inl_cv (matches Coq) *)
lemma closed_inl_cv: "\<forall> e T, closed_expr_cv (EInl e T) <-> closed_expr_cv e"
  by auto

(* closed_inr_cv (matches Coq) *)
lemma closed_inr_cv: "\<forall> e T, closed_expr_cv (EInr e T) <-> closed_expr_cv e"
  by auto

(* closed_app_cv (matches Coq) *)
lemma closed_app_cv: "\<forall> e1 e2, closed_expr_cv (EApp e1 e2) <-> closed_expr_cv e1 \<and> closed_expr_cv e2"
  by auto

(* Values: specific closed lemmas *)
(* closed_unit_cv (matches Coq) *)
lemma closed_unit_cv: "closed_expr_cv EUnit"
  by auto

(* closed_bool_cv (matches Coq) *)
lemma closed_bool_cv: "\<forall> b, closed_expr_cv (EBool b)"
  by auto

(* closed_int_cv (matches Coq) *)
lemma closed_int_cv: "\<forall> n, closed_expr_cv (EInt n)"
  by auto

(* closed_string_cv (matches Coq) *)
lemma closed_string_cv: "\<forall> s, closed_expr_cv (EString s)"
  by auto

(* closed_loc_cv (matches Coq) *)
lemma closed_loc_cv: "\<forall> l, closed_expr_cv (ELoc l)"
  by auto

(* Lambda: bound variable can be free in body but not in lambda *)
(* closed_lam_body_cv (matches Coq) *)
lemma closed_lam_body_cv: "\<forall> x T body y, closed_expr_cv (ELam x T body) \<longrightarrow> free_in y body \<longrightarrow> y = x"
  by auto

end
