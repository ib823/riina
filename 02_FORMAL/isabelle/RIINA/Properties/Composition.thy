(* Copyright (c) 2026 The RIINA Authors. All rights reserved. *)

(*
 * RIINA Composition - Isabelle/HOL Port
 *
 * Auto-generated port of 02_FORMAL/coq/properties/Composition.v (6 theorems).
 *
 * Generated by scripts/generate-multiprover.py
 *
 * Correspondence Table:
 *
 * | Coq Definition     | Isabelle Definition    | Status |
 * |--------------------|------------------------|--------|
 * | val_rel_pair       | val_rel_pair           | OK     |
 * | val_rel_inl        | val_rel_inl            | OK     |
 * | val_rel_inr        | val_rel_inr            | OK     |
 * | exp_rel_pair_values | exp_rel_pair_values    | OK     |
 * | exp_rel_inl_values | exp_rel_inl_values     | OK     |
 * | exp_rel_inr_values | exp_rel_inr_values     | OK     |
 *)

theory Composition
  imports Main
begin

(* val_rel_pair (matches Coq) *)
lemma val_rel_pair: "\<forall> Σ T1 T2 v1 v1' v2 v2', val_rel Σ T1 v1 v1' \<longrightarrow> val_rel Σ T2 v2 v2' \<longrightarrow> has_type nil Σ Public v1 T1 EffectPure \<longrightarrow> has_type nil Σ Public v1' T1 EffectPure \<longrightarrow> has_type nil Σ Public v2 T2 EffectPure \<longrightarrow> has_type nil Σ Public v2' T2 EffectPure \<longrightarrow> val_rel Σ (TProd T1 T2) (EPair v1 v2) (EPair v1' v2')"
  by auto

(* val_rel_inl (matches Coq) *)
lemma val_rel_inl: "\<forall> Σ T1 T2 v1 v2, val_rel Σ T1 v1 v2 \<longrightarrow> has_type nil Σ Public v1 T1 EffectPure \<longrightarrow> has_type nil Σ Public v2 T1 EffectPure \<longrightarrow> val_rel Σ (TSum T1 T2) (EInl v1 T2) (EInl v2 T2)"
  by auto

(* val_rel_inr (matches Coq) *)
lemma val_rel_inr: "\<forall> Σ T1 T2 v1 v2, val_rel Σ T2 v1 v2 \<longrightarrow> has_type nil Σ Public v1 T2 EffectPure \<longrightarrow> has_type nil Σ Public v2 T2 EffectPure \<longrightarrow> val_rel Σ (TSum T1 T2) (EInr v1 T1) (EInr v2 T1)"
  by auto

(* These follow directly from val_rel lemmas + exp_rel_of_val_rel *)
(* exp_rel_pair_values (matches Coq) *)
lemma exp_rel_pair_values: "\<forall> Σ T1 T2 v1 v1' v2 v2', val_rel Σ T1 v1 v1' \<longrightarrow> val_rel Σ T2 v2 v2' \<longrightarrow> has_type nil Σ Public v1 T1 EffectPure \<longrightarrow> has_type nil Σ Public v1' T1 EffectPure \<longrightarrow> has_type nil Σ Public v2 T2 EffectPure \<longrightarrow> has_type nil Σ Public v2' T2 EffectPure \<longrightarrow> exp_rel Σ (TProd T1 T2) (EPair v1 v2) (EPair v1' v2')"
  by auto

(* exp_rel_inl_values (matches Coq) *)
lemma exp_rel_inl_values: "\<forall> Σ T1 T2 v1 v2, val_rel Σ T1 v1 v2 \<longrightarrow> has_type nil Σ Public v1 T1 EffectPure \<longrightarrow> has_type nil Σ Public v2 T1 EffectPure \<longrightarrow> exp_rel Σ (TSum T1 T2) (EInl v1 T2) (EInl v2 T2)"
  by auto

(* exp_rel_inr_values (matches Coq) *)
lemma exp_rel_inr_values: "\<forall> Σ T1 T2 v1 v2, val_rel Σ T2 v1 v2 \<longrightarrow> has_type nil Σ Public v1 T2 EffectPure \<longrightarrow> has_type nil Σ Public v2 T2 EffectPure \<longrightarrow> exp_rel Σ (TSum T1 T2) (EInr v1 T1) (EInr v2 T1)"
  by auto

end
