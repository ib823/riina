(* SPDX-License-Identifier: MPL-2.0 *)
(* Copyright (c) 2026 The RIINA Authors. See AUTHORS file. *)

(*
 * RIINA StoreWfLemmas - Isabelle/HOL Port
 *
 * Auto-generated port of 02_FORMAL/coq/properties/StoreWfLemmas.v (4 theorems).
 *
 * Generated by scripts/generate-multiprover.py
 *
 * Correspondence Table:
 *
 * | Coq Definition     | Isabelle Definition    | Status |
 * |--------------------|------------------------|--------|
 * | store_wf_lookup_value | store_wf_lookup_value  | OK     |
 * | store_wf_lookup_typed | store_wf_lookup_typed  | OK     |
 * | store_wf_typed_loc_has_value | store_wf_typed_loc_has_value | OK     |
 * | store_wf_typed_loc_gives_typed_value | store_wf_typed_loc_gives_typed_value | OK     |
 *)

theory StoreWfLemmas
  imports Main
begin

(* Store well-formedness implies stored expressions are values *)
(* store_wf_lookup_value (matches Coq) *)
lemma store_wf_lookup_value: "\<forall> Σ st l v, store_wf Σ st \<longrightarrow> store_lookup l st = Some v \<longrightarrow> value v"
  by auto

(* Store well-formedness implies stored expressions are well-typed *)
(* store_wf_lookup_typed (matches Coq) *)
lemma store_wf_lookup_typed: "\<forall> Σ st l v, store_wf Σ st \<longrightarrow> store_lookup l st = Some v \<longrightarrow> \<exists> T sl, store_ty_lookup l Σ = Some (T, sl) \<and> has_type nil Σ Public v T EffectPure"
  by auto

(* For typed locations, lookup succeeds with a value *)
(* store_wf_typed_loc_has_value (matches Coq) *)
lemma store_wf_typed_loc_has_value: "\<forall> Σ st l T sl, store_wf Σ st \<longrightarrow> store_ty_lookup l Σ = Some (T, sl) \<longrightarrow> \<exists> v, store_lookup l st = Some v \<and> value v"
  by auto

(* Combined: typed location lookup gives typed value *)
(* store_wf_typed_loc_gives_typed_value (matches Coq) *)
lemma store_wf_typed_loc_gives_typed_value: "\<forall> Σ st l T sl, store_wf Σ st \<longrightarrow> store_ty_lookup l Σ = Some (T, sl) \<longrightarrow> \<exists> v, store_lookup l st = Some v \<and> value v \<and> has_type nil Σ Public v T EffectPure"
  by auto

end
