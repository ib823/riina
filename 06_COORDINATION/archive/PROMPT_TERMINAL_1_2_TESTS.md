# RIINA Test Coverage Enhancement - Terminal 1 & 2 Task Assignment

## Context

Terminal 3 (riina-codegen worker) has successfully increased the test count from 123 to **225 tests** (172 tests in riina-codegen alone, up from 69). The immediate test crisis has been addressed.

**However, the lexer, parser, and typechecker crates still have minimal test coverage:**

| Crate | Current Tests | Potential |
|-------|---------------|-----------|
| `riina-lexer` | 12 | 40+ |
| `riina-parser` | 12 | 35+ |
| `riina-typechecker` | 5 | 30+ |

## Your Task (Option B)

**CRITICAL**: Before adding tests, you MUST assess your current work to determine if adding tests would:
1. Conflict with any in-progress implementation work
2. Require files that are actively being modified
3. Create merge conflicts with your current branch

## Assessment Protocol

### Step 1: Check Current Work Status

```bash
# Show your current git status
git status

# Show any uncommitted changes
git diff --stat

# Show what files you've modified in this session
git log --oneline -10
```

### Step 2: Identify Your Domain

Answer these questions:
1. Which Track B crate(s) are you currently working on?
2. Are you implementing new features or fixing bugs?
3. Are your changes ready to commit?

### Step 3: Risk Assessment

**LOW RISK** (Safe to add tests):
- Your work is committed and pushed
- You're doing research/exploration only
- Your changes are in different crates than lexer/parser/typechecker

**MEDIUM RISK** (Proceed with caution):
- You have uncommitted changes but in unrelated files
- Your work is in the same crate but different modules

**HIGH RISK** (Do NOT add tests yet):
- You have active modifications to lexer/parser/typechecker
- You're implementing features that will change the test expectations
- Your branch has diverged significantly from main

## If Safe to Proceed: Test Implementation Guide

### For riina-lexer (Target: +28 tests)

**Files to add tests:** `03_PROTO/crates/riina-lexer/src/lib.rs`

Test categories needed:
1. **Token recognition tests** - Each Bahasa Melayu keyword
2. **Whitespace handling** - Comments, newlines, indentation
3. **Number literals** - Integers, potential future floats
4. **String literals** - Escape sequences, unicode
5. **Operator recognition** - All operators
6. **Error recovery** - Invalid tokens, unterminated strings

Example test structure:
```rust
#[test]
fn test_lexer_keyword_fungsi() {
    let lexer = Lexer::new("fungsi");
    let tokens: Vec<_> = lexer.collect();
    assert!(matches!(tokens[0].kind, TokenKind::Fungsi));
}
```

### For riina-parser (Target: +23 tests)

**Files to add tests:** `03_PROTO/crates/riina-parser/src/lib.rs`

Test categories needed:
1. **Expression parsing** - All Expr variants
2. **Type parsing** - All Ty variants
3. **Statement parsing** - Let, If, etc.
4. **Error messages** - Syntax error quality
5. **Span tracking** - Source location accuracy

### For riina-typechecker (Target: +25 tests)

**Files to add tests:** `03_PROTO/crates/riina-typechecker/src/lib.rs`

Test categories needed:
1. **Type inference** - Basic and complex cases
2. **Effect checking** - Effect annotations
3. **Security level checking** - Public/Secret flow
4. **Error messages** - Type error quality

## Important Constraints

### NEVER:
- Add tests for code that doesn't exist yet
- Modify existing tests without understanding why they exist
- Add tests that conflict with Coq specification correspondence
- Use incorrect Bahasa Melayu keywords

### ALWAYS:
- Run `cargo test --all` before committing
- Use commit message format: `[TRACK_B] TEST: Description`
- Push frequently to avoid merge conflicts
- Coordinate via `06_COORDINATION/COORDINATION_LOG.md`

## Response Format

After assessing your situation, reply with:

```
TERMINAL [1/2] STATUS REPORT

Current Work: [Brief description]
Current Branch: [Branch name]
Uncommitted Changes: [Yes/No - list files]
Risk Level: [LOW/MEDIUM/HIGH]

Decision: [CAN_PROCEED / CANNOT_PROCEED / DEFER]

If CAN_PROCEED:
  Target Crate: [riina-lexer / riina-parser / riina-typechecker]
  Estimated Tests to Add: [Number]
  ETA: [Time estimate]

If CANNOT_PROCEED:
  Reason: [Explanation]
  Alternative: [What you'll do instead]
```

## Final Note

Test coverage is important, but not at the cost of:
1. Breaking other workers' progress
2. Creating merge conflicts
3. Rushing incomplete implementations

**If in doubt, wait and coordinate.**

---

*Generated by Terminal 3 (riina-codegen worker)*
*RIINA: Rigorous Immutable Invariant â€” Normalized Axiom*
*"QED Eternum."*
